function get(a){return document.getElementById(a)}var SI_SUFFIXES=["K","M","G","T","P","E","Z","Y","X","W","V","U","D","S","R","Q","KQ","MQ","GQ","TQ","PQ","EQ","ZQ","YQ","XQ","WQ","VQ","UQ","DQ","SQ","RQ","QQ","KQQ","MQQ"];var SS_SUFFIXES=["K","M","B","T","Qa","Qi","Sx","Sp","Oc","No","De","UnDe","DuDe","TrDe","QaDe","QiDe","SxDe","SpDe","OcDe","NoDe","Vi","UnVi","DuVi","TrVi","QaVi","QiVi","SxVi","SpVi","OcVi","NoVi","Tri","UnTri","DuTri","TrTri"];var SI_VALUES=[1000,1000000,1000000000,1000000000000,1000000000000000,1000000000000000000,1e+21,1e+24,1e+27,1e+30,1e+33,1e+36,1e+39,1e+42,1e+45,1e+48,1e+51,1e+54,1e+57,1e+60,1e+63,1e+66,1e+69,1e+72,1e+75,1e+78,1e+81,1e+84,1e+87,1e+90,1e+93,1e+96,1e+99,1e+102];function n(c){c=(typeof(c)=="number"?c.toString():c);var d=c[c.length-1];var f=0;for(f=0;f<c.length;f++){if(!$.isNumeric(c[f])&&c[f]!="."&&c[f]!="-"){break}}var b=c.substring(0,f);var a=c.substring(f);var e=SI_SUFFIXES.indexOf(a);if(e!=-1){return Number(b)*SI_VALUES[e]}else{return Number(b)}}function s(b,a,c){if(b===Infinity){return"&infin;"}if(b>=SI_VALUES[SI_VALUES.length-1]*1000){return String(b.toPrecision(3))}setDefault(c,false);if(MD.NUMBER_SYSTEM=="SI"){return s_siunits(b,c)}else{if(MD.NUMBER_SYSTEM=="SS"){return s_shortscale(b,c)}else{return s_scinotation(b,a,c)}}}function s_siunits(b,e){var a=(e?6:3);var c=0;for(;c<SI_VALUES.length;c++){if(Math.abs(b)<SI_VALUES[c]){break}}c--;var d;if(c==-1){d=Math.round(b*Math.pow(10,a))/Math.pow(10,a);if(d==1000){return"1"+SI_SUFFIXES[0]}return d.toString()}else{d=b/SI_VALUES[c];d=Math.round(d*Math.pow(10,a))/Math.pow(10,a);if(d==1000&&c+1<SI_VALUES.length){return"1"+SI_SUFFIXES[c+1]}return d.toString()+SI_SUFFIXES[c]}}function s_shortscale(b,e){var a=(e?6:3);var c=0;for(;c<SI_VALUES.length;c++){if(Math.abs(b)<SI_VALUES[c]){break}}c--;if(c==-1){d=Math.round(b*Math.pow(10,a))/Math.pow(10,a);if(d==1000){return"1"+SI_SUFFIXES[0]}return d.toString()}else{var d=b/SI_VALUES[c];d=Math.round(d*Math.pow(10,a))/Math.pow(10,a);if(d==1000&&c+1<SI_VALUES.length){return"1"+SS_SUFFIXES[c+1]}return d.toString()+SS_SUFFIXES[c]}}function s_scinotation(c,b,f){b=setDefault(b,false);var a=(f?6:3);var d=0;for(;d<SI_VALUES.length;d++){if(Math.abs(c)<SI_VALUES[d]){break}}d--;if(d==-1){e=Math.round(c*Math.pow(10,a))/Math.pow(10,a);if(e==1000){if(b){return"1e+3"}else{return"1 x 10<sup>3</sup>"}}return e.toString()}else{var e=c/SI_VALUES[d];e=Math.round(e*Math.pow(10,a))/Math.pow(10,a);if(e==1000&&d+1<SI_VALUES.length){if(b){return"1e+"+(d+2)*3}else{return"1 x 10<sup>"+(d+2)*3+"</sup>"}}if(b){return e.toString()+"e+"+(d+1)*3}else{return e.toString()+" x 10<sup>"+(d+1)*3+"</sup>"}}}function roundTenth(a){return Math.round(10*a)/10}function getRandom(b,a){return Math.floor(Math.random()*(a-b+1))+b}function tryPercentChance(a){return((a/100)>Math.random())}function sumArray(b,e){e=setDefault(e,0);var d=0;for(var c=b.length-1;c>=e;c--){d+=b[c]}return d}function swapArray(b,e,d){var c=b[e];b[e]=b[d];b[d]=c}function countElements(b,c){var e=0;for(var d=b.length;d--;){if(b[d]==c){e+=1}}return e}function getTotalCost(a,c,b){return a*((1-Math.pow(b,c))/(1-b))}function clearSelectBox(a){var b;for(b=a.options.length-1;b>=0;b--){a.remove(b)}}function snd(){return(Math.random()*2-1)+(Math.random()*2-1)+(Math.random()*2-1)}function gaussianRandom(a,b){return(snd()*b)+a}function testRandomDist(b,d){var a=[0,0,0,0,0,0,0,0,0,0];for(var c=0;c<10000;c++){var e=gaussianRandom(b,d);if(e>0){e=Math.round(e);e=Math.max(Math.min(9,e),0);a[e]++}}for(var c=0;c<a.length;c++){console.log(c+" "+a[c]/100+"%")}}function getComparisonSymbol(b,a){if(b>a){return">"}else{if(b<a){return"<"}else{return"="}}}function setDefault(a,b){return typeof a!=="undefined"?a:b}function lineIntersect(c,j,b,g,a,e,k,d){var h=((c*g-j*b)*(a-k)-(c-b)*(a*d-e*k))/((c-b)*(e-d)-(j-g)*(a-k));var f=((c*g-j*b)*(e-d)-(j-g)*(a*d-e*k))/((c-b)*(e-d)-(j-g)*(a-k));if(isNaN(h)||isNaN(f)){return false}else{if(c>=b){if(!(b<=h&&h<=c)){return false}}else{if(!(c<=h&&h<=b)){return false}}if(j>=g){if(!(g<=f&&f<=j)){return false}}else{if(!(j<=f&&f<=g)){return false}}if(a>=k){if(!(k<=h&&h<=a)){return false}}else{if(!(a<=h&&h<=k)){return false}}if(e>=d){if(!(d<=f&&f<=e)){return false}}else{if(!(e<=f&&f<=d)){return false}}}return true}function pointInQuad(d,b){var a=0;for(var c=0;c<b.length;c++){if(b[c][0]>a){a=b[c][0]}}a*=10;sum=0;for(c=0;c<b.length;c++){if(lineIntersect(d[0],d[1],a,0,b[c][0],b[c][1],b[(c+1)%4][0],b[(c+1)%4][1])){sum++}}return(sum%2!=0)}String.prototype.toTitleCase=function(){return this.replace(/\w\S*/g,function(a){return a.charAt(0).toUpperCase()+a.substr(1).toLowerCase()})};function roundRect(d,c,h,e,b,a,g,f){if(typeof f=="undefined"){f=true}if(typeof a==="undefined"){a=5}d.beginPath();d.moveTo(c+a,h);d.lineTo(c+e-a,h);d.quadraticCurveTo(c+e,h,c+e,h+a);d.lineTo(c+e,h+b-a);d.quadraticCurveTo(c+e,h+b,c+e-a,h+b);d.lineTo(c+a,h+b);d.quadraticCurveTo(c,h+b,c,h+b-a);d.lineTo(c,h+a);d.quadraticCurveTo(c,h,c+a,h);d.closePath();if(f){d.stroke()}if(g){d.fill()}}MD={};MD.VERSION="1.032";MD.HTML5_LOCAL_STORAGE_NAME="SCHOLTEK-MINEDEFENSE-SAVEOBJECT";MD.PRICE_MULTIPLIER=1.2;MD.ALCH_MULTIPLIER=1.15;MD.WYVERN_MULTIPLIER=1.18;MD.HIVE_QUEEN_MULTIPLIER=1.19;MD.IMBUE_MULTIPLIER=1.3;MD.GOBLIN_TIME=35;MD.GOBLIN_TIME_VARIATION=10;MD.GOBLIN_LEVEL_VARIATION=2;MD.GOBLIN_KILLS_PER_LEVEL=8;MD.GOBLIN_REWARD=4000;MD.GOBLIN_REWARD_VARIATION=50;MD.SPIDER_TIME=105;MD.SPIDER_TIME_VARIATION=30;MD.SPIDER_LEVEL_VARIATION=10;MD.SPIDER_KILLS_PER_LEVEL=15;MD.SPIDER_REWARD=n("8T");MD.SPIDER_REWARD_VARIATION=80;MD.MAX_GOBLIN_TIME=-1;MD.MAX_SPIDER_TIME=-1;MD.FAST_TICK_COUNT=0;MD.FORTIFICATION_VALUE=n("2.5G");MD.FORTIFICATION_COST=n("1P");MD.MASON_START_COST=n("1M");MD.MASON_REPAIR_RATE=5;MD.MAGE_START_COST=n("10M");MD.MAGE_DAMAGE=10;MD.QUEEN_BASE=50;MD.NEURO_BASE=n("30G");MD.ALCHEMIST_START_COST={gold:n("10E"),perfect:1};MD.GOBLIN_ROW_1_X=0;MD.GOBLIN_ROW_2_X=480;MD.GOBLIN_START_Y=50;MD.GOBLIN_INCREMENT_Y=100;MD.SPIDER_ROW_1_Y=0;MD.SPIDER_ROW_2_Y=435;MD.SPIDER_START_X=105;MD.SPIDER_INCREMENT_X=140;MD.MAGE_ROW_1_X=120;MD.MAGE_ROW_2_X=360;MD.MAGE_START_Y=80;MD.MAGE_INCREMENT_Y=110;MD.AVAILABLE_MAGE_UPGRADES=[];MD.CURRENT_SCREEN="canvas-container";MD.SPRITE_N=7;MD.SPRITE_POS=0;MD.ORACLE_CLICK_GUIDE=false;MD.MOVE_SPRITE=true;MD.CLICK_EFFECTS=new Array(10);MD.CLICK_EFFECT_POSITION=0;MD.CLICK_EFFECT_LIFE=18;MD.CLICK_EFFECT_Y=2;MD.MASON_UNLOCK_GOLD=MD.MASON_START_COST/2;MD.MAGE_UNLOCK_GOLD=MD.MAGE_START_COST/2;MD.MAX_MAGE_AURA=10;MD.MAX_AURA_MULT=50;MD.AURA_DURATION=360;MD.IMBUEMENT_BUY_MODE=0;MD.IMBUEMENT_BUY_MODES=[1,5,10,25,"Max"];MD.CTRL_DOWN=false;MD.FORCE_CONTROL=false;MD.INDUSTRY_WORKING=false;MD.COST_PER_PIXEL={dirt:n("100K")};MD.PIT_BASE=1;MD.MARKET_DIALOG_OPEN=false;MD.MOVE_DIALOG_OPEN=false;MD.MOVE_BUILDING_1=null;MD.MOVE_BUILDING_2=null;MD.UPGRADE_CACHE={};MD.UPGRADE_ID_LOOKUP={};MD.CONSTRUCT_UNLOCKED=new Array(25);MD.INITIALIZING_GAME=true;MD.NUMBER_SYSTEM="SS";MD.setVariablesToDefault=function(){MD.GOLD=0;MD.TOTAL_GOLD=0;MD.PICK_LEVEL=0;MD.PICK_SOCKETS=[];MD.WALL_LEVEL=0;MD.WALL_STRENGTH=0;MD.MAX_WALL_STRENGTH=0;MD.FORTIFICATION_LEVEL=0;MD.MASONS=0;MD.HIRELINGS_OWNED=[0,0,0,0,0,0,0,0,0,0,0,0,0,0];MD.IMBUEMENT_LEVEL=[0,0,0,0,0,0,0,0,0,0,0,0,0,0];MD.UNLOCKED_UPGRADES=[];MD.AVAILABLE_UPGRADES=[];MD.ACTIVE_UPGRADES=[];MD.DIRT=0;MD.TOTAL_DIRT=0;MD.STONE=0;MD.TOTAL_STONE=0;MD.COAL=0;MD.TOTAL_COAL=0;MD.IRON=0;MD.TOTAL_IRON=0;MD.STEEL=0;MD.TOTAL_STEEL=0;MD.ADAMANTIUM=0;MD.TOTAL_ADAMANTIUM=0;MD.DRAGONSCALE=0;MD.TOTAL_DRAGONSCALE=0;MD.FLAX=0;MD.TOTAL_FLAX=0;MD.FOOD=0;MD.TOTAL_FOOD=0;MD.POPULATION=0;MD.TOTAL_POPULATION=0;MD.GOBLIN_PRESENT=[false,false,false,false,false,false,false,false];MD.GOBLIN_OBJECT=[null,null,null,null,null,null,null,null];MD.GOBLIN_TIMER=-1;MD.GOBLIN_LURE_TIMER=-1;MD.GOBLIN_LEVEL=1;MD.SPIDER_PRESENT=[false,false,false,false,false,false];MD.SPIDER_OBJECT=[null,null,null,null,null,null];MD.SPIDER_TIMER=-1;MD.SPIDER_LEVEL=1;MD.TRAPS_BOUGHT=[0,0,0,0,0];MD.LURES_BOUGHT=[0];MD.GOLD_PER_SECOND=0;MD.UPGRADES_BOUGHT=0;MD.GOBLINS_KILLED=0;MD.GOBLINS_KILLED_BY_MAGES=0;MD.SPIDERS_KILLED=0;MD.SPIDERS_KILLED_BY_MAGES=0;MD.MANUAL_CLICKS=0;MD.AUTO_CLICKS=0;MD.TICKS=0;MD.TREASURES_FOUND=0;MD.TOTAL_GEMS=0;MD.CAMPAIGNS_WON=0;MD.SOLDIERS_LOST=0;MD.MAGES=0;MD.MAGES_FIGHTING=0;MD.MAGES_MEDITATING=0;MD.MAGES_DELVING=0;MD.MANA=0;MD.TOTAL_MANA=0;MD.MAGE_MAX_TIME=0;MD.ACTIVE_MAGE_UPGRADES=[];MD.BUILDINGS_ACTIVE=[];MD.GEMS=[0,0,0,0,0,0,0,0,0,0];MD.GEMS_SOLD=0;MD.ALCHEMISTS=0;MD.ALCH_ARRAY=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];MD.CONSTRUCT_LOCATIONS=new Array(25);MD.CONSTRUCTION_STATUS=new Array(25);MD.CONSTRUCT_LEVELS=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];MD.AUTO_SMITH_GEM=0;MD.AUTO_SMITH_LIMIT=null;MD.MAGE_TOWER_RESEARCH=0;MD.GEM_COMBINE_LIMIT=9;MD.SHOW_NOTIFICATIONS=true;MD.SHOW_CLICK_EFFECTS=true;MD.PIT_SMELTING=true;MD.BLIND_REVENGE=false;MD.AUTO_RIFT=false;MD.CURRENT_RATES=[];MD.QUARRY_TIMEOUT=null;MD.GOBLINS_SACRIFIED=0;MD.MACHINIST_AUTO=[false,false,false];MD.ADMIN_RANGE=10;MD.DISPLAYED_TIME=10;MD.ADMIN_TIME=0;MD.ANTS_EATEN=0;MD.TIMES_FORTIFIED=0;MD.GOBLIN_DAMAGE=0;MD.DIRT_TO_MANA=0;MD.MARKET_TRADES=0;MD.FIRE_ESSENCE=0;MD.TOTAL_FIRE_ESSENCE=0;MD.WATER_ESSENCE=0;MD.TOTAL_WATER_ESSENCE=0;MD.EARTH_ESSENCE=0;MD.TOTAL_EARTH_ESSENCE=0;MD.LIGHTNING_ESSENCE=0;MD.TOTAL_LIGHTNING_ESSENCE=0;MD.SPIRIT_ESSENCE=0;MD.TOTAL_SPIRIT_ESSENCE=0;MD.CURRENT_DRAGON=-1;MD.DRAGON_LEVEL=0;MD.MAX_DRAGON_LEVEL=0;MD.DRAGONS_OWNED=[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false];MD.MASTER_DRAGON_PRICE=null;MD.DRAGONS_SACRIFICED=0;MD.ARCH_ARRAY=[0,0,0,0,0,0];MD.WOOD=0;MD.BUILDINGS_UNLOCKED=[];MD.BUILDINGS_AVAILABLE=[];MD.MAGE_AURA_LEVEL=[0,0,0,0,0,0];MD.MARKET_TIMER=-1;MD.MARKET_RATE=1;MD.MARKET_HALVED=false;MD.CLICKS_THIS_TICK=0;MD.ADMIN_ARRAY=[];MD.RESOURCE_SECTION_NAMES=["basic","gem","raw","rare","hireling","essence","other"];MD.RESOURCE_SECTION_TITLES=["Basic Resources","Gems","Raw Materials","Rare Materials","Hirelings","Essence","Other"];MD.RESOURCE_MULT_LABELS=["Basic","Gems","Raw Materials","Rare Materials","Hirelings","Essence"]};MD.Pick=function(b,g,f,d,e,c,a){this.name=b;if(typeof(g)=="number"){g={gold:g}}this.cost=g;this.strength=f;this.description=d;this.unlock_function=e;this.gem_mean=typeof c!=="undefined"?c:-1;this.gem_std=typeof a!=="undefined"?a:0};MD.PICKS=[new MD.Pick("Stick",0,1,"You're like a kid playing in a sandbox. Have some pride.",function(){return true}),new MD.Pick("Tin",10,2,"Tin. Like what they cover food with. In large quantities it can also chip rock.",function(){return true}),new MD.Pick("Copper",100,3,"Used by some of the oldest civilizations known - and by you. Feeling old?",function(){return MD.TOTAL_GOLD>50}),new MD.Pick("Bronze",250,4,"Mixing copper with tin proves that mixing two sucky things can make a below-average thing.",function(){return MD.TOTAL_GOLD>125}),new MD.Pick("Iron",n("1K"),6,"From the Latin ferrum, meaning, corrodes easily but at least it isn't tin.",function(){return MD.TOTAL_GOLD>500}),new MD.Pick("Steel",n("2.5K"),10,"Now we're getting somewhere - heated iron is less wimpy.",function(){return MD.TOTAL_GOLD>n("1.2K")}),new MD.Pick("Mythril",n("5K"),15,"A most desirable and fictional metal - ideal for hitting goblins.",function(){return MD.TOTAL_GOLD>n("2.5K")}),new MD.Pick("Diamond",n("10K"),50,"What is it with computer games and diamond stuff? Diamond is not a building material.",function(){return MD.TOTAL_GOLD>n("5K")}),new MD.Pick("Uranium",n("100K"),800,"Heavy, expensive, poisononous, and not very good at chipping rocks. What a bargain!",function(){return MD.TOTAL_GOLD>n("50K")}),new MD.Pick("Obsidian",n("2.5M"),15000,"Never dig straight down, and this goes double when you're standing on Obsidian!",function(){return MD.TOTAL_GOLD>n("1.2M")}),new MD.Pick("Dragon",n("25M"),n("150K"),"Forged from the scales of a fallen dragon - we're not sure how useful this is, but it sure sounds cool.",function(){return MD.TOTAL_GOLD>n("12.5M")}),new MD.Pick("Scholtium",n("200M"),n("1M"),"Said to only exist in small pockets located directly beneath a particular web server hosting a particular website, who knows what this can do?",function(){return MD.TOTAL_GOLD>n("50M")}),new MD.Pick("Rhenium",n("1T"),n("10M"),"A rare element, typically used in jet engines. You are just that hardcore.",function(){return MD.TOTAL_GOLD>n("500G")}),new MD.Pick("Swarm",n("1P"),n("25M"),"You don't really want to know what this pick is made of...",function(){return MD.HIRELINGS_OWNED[0]>n("100K")}),new MD.Pick("Gleaming",{gold:n("100Z"),mana:n("100G")},n("15T"),"This pick is almost blinding to look at, but if you manage, it seems to dig up a lot of gems.",function(){return MD.TOTAL_MANA>n("1T")},-1,3),new MD.Pick("Radiant",{gold:n("5X"),majestic:25},n("10P"),"You look down. Nothing. You hit the ground... and suddenly gems everywhere. It doesn't make sense.",function(){return MD.TOTAL_GEMS>=n("750K")},2,3),new MD.Pick("Steel Tipped",{gold:n("5W"),majestic:n("250K"),steel:n("10K")},n("50P"),"It seems like capping a legendary holy metal in steel would be detrimental... but whatever.",function(){return MD.TOTAL_GEMS>=n("5M")&&MD.TOTAL_STEEL>=n("5K")},6,3),new MD.Pick("Adamantium",{gold:n("5U"),majestic:n("1M"),adamantium:n("1M"),earth:10},n("250P"),"Your new knowledge of earth essence has finally allowed you to forge a pick of mighty adamantium.",function(){return MD.hasConstruct("Earth Shrine")},8,3),new MD.Pick("Earthen",{gold:n("50U"),majestic:n("1G"),adamantium:n("10M"),earth:50},n("2.5E"),"The very energy of the earth flows through this pickaxe, and the ground gives way almost of it's own accord.",function(){return MD.hasConstruct("Earth Shrine")&&MD.TOTAL_EARTH_ESSENCE>=10&&MD.totalClicks()>=n("50K")},9,2),new MD.Pick("Seismic",{gold:n("500U"),majestic:n("1T"),adamantium:n("1G"),earth:100},n("25E"),"The power of earthquakes that shake the very mountains now waits at your fingertips.",function(){return MD.hasConstruct("Earth Shrine")&&MD.TOTAL_EARTH_ESSENCE>=50&&MD.totalClicks()>=n("100K")},9,0)];MD.Wall=function(c,d,a,b){this.name=c;this.cost=d;this.durability=a;this.color=b};MD.WALLS=[new MD.Wall("None",0,0,null),new MD.Wall("Stick",n("100K"),n("1K"),"sienna"),new MD.Wall("Tin",n("500K"),n("2.5K"),"lightgray"),new MD.Wall("Copper",n("1M"),n("5K"),"sandybrown"),new MD.Wall("Bronze",n("2.5M"),n("10K"),"chocolate"),new MD.Wall("Iron",n("5M"),n("20K"),"slategray"),new MD.Wall("Steel",n("10M"),n("40K"),"dimgray"),new MD.Wall("Mythril",n("50M"),n("150K"),"cornflowerblue"),new MD.Wall("Diamond",n("250M"),n("500K"),"mediumturquoise"),new MD.Wall("Uranium",n("1G"),n("1M"),"lime"),new MD.Wall("Scholtium",n("10G"),n("5M"),"mediumblue"),new MD.Wall("Rhenium",n("10T"),n("800M"),"white"),new MD.Wall("Bioalloy",n("10P"),n("10G"),"indigo")];MD.Gem=function(b,e,c,d,a){this.name=b;this.value=e;this.combine_requirement=c;this.pick_increase=d;this.gps_increase=a};MD.GEM_OBJECTS=[new MD.Gem("Dreary",n("10K"),-1,100,0),new MD.Gem("Murky",n("20K"),2,1000,0),new MD.Gem("Cracked",n("40K"),2,5000,0),new MD.Gem("Flawed",n("200K"),2,10000,0),new MD.Gem("Normal",n("500K"),2,n("20K"),1),new MD.Gem("Great",n("2M"),3,n("50K"),3),new MD.Gem("Flawless",n("25M"),3,n("100K"),5),new MD.Gem("Exceptional",n("200M"),3,n("250K"),10),new MD.Gem("Perfect",n("5G"),5,n("1M"),20),new MD.Gem("Majestic",n("100G"),8,n("5M"),30)];MD.Resource=function(e,d,a,b,c){this.print_name=e;this.change_function=d;this.check_function=a;this.amount_function=b;this.type=c};MD.createResourceObjects=function(){MD.RESOURCES=[];MD.RESOURCES.gold=new MD.Resource("Gold",MD.changeGold,MD.hasGold,MD.getGold,"basic");MD.RESOURCES.mana=new MD.Resource("Mana",MD.changeMana,MD.hasMana,MD.getMana,"basic");MD.RESOURCES.dirt=new MD.Resource("Dirt",MD.changeDirt,MD.hasDirt,MD.getDirt,"raw");MD.RESOURCES.stone=new MD.Resource("Stone",MD.changeStone,MD.hasStone,MD.getStone,"raw");MD.RESOURCES.coal=new MD.Resource("Coal",MD.changeCoal,MD.hasCoal,MD.getCoal,"raw");MD.RESOURCES.iron=new MD.Resource("Iron",MD.changeIron,MD.hasIron,MD.getIron,"raw");MD.RESOURCES.steel=new MD.Resource("Steel",MD.changeSteel,MD.hasSteel,MD.getSteel,"rare");MD.RESOURCES.food=new MD.Resource("Food",MD.changeFood,MD.hasFood,MD.getFood,"raw");MD.RESOURCES.adamantium=new MD.Resource("Adamantium",MD.changeAdamantium,MD.hasAdamantium,MD.getAdamantium,"rare");MD.RESOURCES.population=new MD.Resource("Population",MD.changePopulation,MD.hasPopulation,MD.getPopulation,"other");MD.RESOURCES.dragonscale=new MD.Resource("Dragonscale",MD.changeDragonscale,MD.hasDragonscale,MD.getDragonscale,"rare");MD.RESOURCES.flax=new MD.Resource("Flax",MD.changeFlax,MD.hasFlax,MD.getFlax,"rare");MD.RESOURCES.fire=new MD.Resource("Fire Essence",MD.changeFireEssence,MD.hasFireEssence,MD.getFireEssence,"essence");MD.RESOURCES.water=new MD.Resource("Water Essence",MD.changeWaterEssence,MD.hasWaterEssence,MD.getWaterEssence,"essence");MD.RESOURCES.earth=new MD.Resource("Earth Essence",MD.changeEarthEssence,MD.hasEarthEssence,MD.getEarthEssence,"essence");MD.RESOURCES.lightning=new MD.Resource("Lightning Essence",MD.changeLightningEssence,MD.hasLightningEssence,MD.getLightningEssence,"essence");MD.RESOURCES.spirit=new MD.Resource("Spirit Essence",MD.changeSpiritEssence,MD.hasSpiritEssence,MD.getSpiritEssence,"essence");for(var a=0;a<MD.GEM_OBJECTS.length;a++){MD.RESOURCES[MD.GEM_OBJECTS[a].name.toLowerCase()]=new MD.Resource(MD.GEM_OBJECTS[a].name+" Gems",(function(b){return function(d,c){return(MD.changeGems(b,d,c))}})(a),(function(b){return function(c){return(MD.hasGems(b,c))}})(a),(function(b){return function(){return(MD.getGems(b))}})(a),"gem")}for(var a=0;a<MD.HIRELINGS.length;a++){MD.RESOURCES[MD.HIRELINGS[a].name.toLowerCase()]=new MD.Resource(MD.HIRELINGS[a].plural,(function(b){return function(c){return(MD.changeHirelings(b,c))}})(a),(function(b){return function(c){return(MD.hasHirelings(b,c))}})(a),(function(b){return function(c){return(MD.getHirelings(b))}})(a),"hireling")}};MD.Trap=function(a,b,d,f,c,e){this.name=a;this.description=b;this.time=d;this.base_cost=f;this.exponent=c;this.unlock_function=e};MD.TRAPS=[new MD.Trap("Bear Trap","Goblins won't attack for 10 minutes - they'll be occupied with other things, like reattaching their legs.",600,n("10K"),1.2,function(){return MD.hasUpgrade("Delve Greedily")}),new MD.Trap("Death Ward","Goblins won't attack for 2 hours, on account of being dead.",7200,n("10G"),1.2,function(){return MD.hasUpgrade("Delve Greedily")&&MD.MAGES>=2}),new MD.Trap("Night Terrors","Goblins will huddle around their camp fires for the next 10 hours, twitching at shadows and sounds in the night.",36000,n("1T"),1.15,function(){return MD.hasUpgrade("Delve Greedily")&&MD.MAGES>=25}),new MD.Trap("Kill It With Fire","Setting the world on fire is a small price to pay to keep the spiders out for a few hours.",7200,n("100T"),1.15,function(){return MD.hasUpgrade("Embrace The Swarm")}),new MD.Trap("Anti-Nightmare Apparatus","Cannons blaze in the night to a steady beat, and in the distance, massive shapes scream and writhe. That should hold them for 10 hours or so.",36000,n("1X"),1.2,function(){return MD.hasUpgrade("Trap Master")})];MD.Lure=function(a,b,e,d,g,c,f){this.name=a;this.description=b;this.time=e;this.mult=d;this.base_cost=g;this.exponent=c;this.unlock_function=f};MD.LURES=[new MD.Lure("Raw Meat","Goblins like their steak VERY rare - this should keep them coming for a while.",1800,4,n("1T"),1.2,function(){return MD.hasUpgrade("Delve Greedily")})];MD.Hireling=function(c,b,g,a,e,f,d){this.name=c;this.plural=b;if(typeof(g)=="number"){g={gold:g}}this.base_cost=g;this.output=a;this.description=e;this.unlock_function=f;this.imbue_cost=d};MD.HIRELINGS=[new MD.Hireling("Large Ant","Large Ants",10,0.2,"An ant, to... pitifully pick at the ground for you.",function(){return true},10000),new MD.Hireling("Woodpecker","Woodpeckers",150,1,"A woodpecker to chip, chip, chip, with a beak that can somehow dent rock.",function(){return MD.TOTAL_GOLD>n("75")},3000),new MD.Hireling("Bloodhound","Bloodhounds",n("1K"),5,"A bloodhound to dig up the ground and sniff things.",function(){return MD.TOTAL_GOLD>n("500")},200),new MD.Hireling("Sandshrew","Sandshrew",n("7.5K"),50,"A sandshrew, because pokemon are adorable, and this one can dig!",function(){return MD.TOTAL_GOLD>n("5K")},500),new MD.Hireling("Goblin","Goblins",n("50K"),250,"A tame goblin who will help you, if only to briefly touch the gold it so loves.",function(){return MD.TOTAL_GOLD>n("25K")},1000),new MD.Hireling("Miner","Miners",n("200K"),1000,"A fellow miner, and harder worker than you I might add.",function(){return MD.TOTAL_GOLD>n("100K")},1500),new MD.Hireling("Rock Golem","Rock Golems",n("1M"),5000,"A mighty statue of twisted stone, to hit the ground and yell loudly.",function(){return MD.TOTAL_GOLD>n("500K")},2000),new MD.Hireling("Bagger 288","Baggers",n("15M"),50000,"An unnecessarily large piece of German mining equipment",function(){return MD.TOTAL_GOLD>n("7.5M")},2500),new MD.Hireling("Titan of Earth","Titans of Earth",n("1G"),n("2.5M"),"When it steps, deep chasms spread from the place where its feet touch down.",function(){return MD.TOTAL_GOLD>n("500M")},5000),new MD.Hireling("World Eater","World Eaters",n("750G"),n("1G"),"A massive serpent of earth and flesh - best to keep your distance.",function(){return MD.TOTAL_GOLD>n("300G")},10000),new MD.Hireling("Hive Queen","Hive Queens",n("100T"),0,"A terrifying insect lifted straight from a nightmare, constantly dropping sacs of vile eggs.",function(){return(MD.TOTAL_GOLD>n("50T")&&MD.HIRELINGS_OWNED[0]>=80)},20000),new MD.Hireling("Wyvern","Wyverns",{mana:n("2.5G")},n("10P"),"A legendary beast summoned from the darkest corners of the earth.",function(){return(MD.TOTAL_MANA>=n("1G"))},n("1G")),new MD.Hireling("Neurochrysalis","Neurochrysalises",{"large ant":n("500M")},0,"A terrifying species that lives and feeds deep within the brains of other organisms.",function(){return(MD.ALCHEMISTS>=30&&MD.TOTAL_MANA>=n("20T"))},n("10T")),new MD.Hireling("Dragon Hunter","Dragon Hunters",{flax:100,adamantium:n("1K"),gold:n("25V")},0,"The most elite soldiers in your kingdom can be trained to hunt the mighty dragons of Mineria.",function(){return MD.hasConstruct("Fletcher")},n("1Y"))];MD.Upgrade=function(g,a,c,d,f,e,b){this.id=g;this.name=a;this.effect=c;this.description=d;if(typeof(f)=="number"){f={gold:f}}this.cost=f;this.unlock_function=e;this.unlocked=false;this.type=typeof b!=="undefined"?b:"normal"};MD.uv={delvegreedilymult:1.5,embranceswarmmult:2,darkportentsmult:2,pioneerspiritmult:1.5,miningmasterymult:2,terrasmightmult:2,lootingproficiencymult:3,goblinsbanemult:3,goblinsscourgemult:3,goblinsterrormult:4,spidermult1:2,spidermult2:3,spidermult3:3,spidermult4:4,antpersandshrew:0.05,sandshrewperminer:4,woodpeckerpertitan:3500,antperrockgolem:3,antperbagger:5000,minerperbagger:1000,minerperwyvern:n("500G"),sandshrewpergolem:n("25G"),worldperant:n("25K"),houndpercraftexponent:4,goblinpertrap1:n("10K"),goblinpertrap2:n("1G"),level1mult:1.5,level2mult:2,level3mult:3,level4mult:2,level5mult:2,level6mult:2,level7mult:2,timeupgrade1:1.05,timeupgrade2:1.1,timeupgrade3:1.5,timeupgrade4:3,queenupgrade1:25,queenupgrade2:50,queenupgrade3:50,queenupgrade4:50,pickgainperant:250,pickgainperant2:750,upgradereduction:15,pickgainperhireling:n("1G"),manamult:2,manamult2:2,goldforevermult:5,masonPercent1:0.0005,masonPercent2:0.001,masonPercent3:0.002,neuropermage1:1,neuropermage2:2,neuropermage3:3,gpsperupgrade:0.5,overloadmult1:10,overloadmult2:20,sandperfort:n("1G"),titanperpop:n("1G"),dirtpereater:n("8K"),alchemistyieldmult:function(){return Math.log(MD.ANTS_EATEN)/20},quarryrewardmult:function(){return Math.log(MD.HIRELINGS_OWNED[5])/4},hivequeenantincrease:function(){return Math.pow(MD.HIRELINGS_OWNED[0],1/5)},marketscholarincrease:function(){return Math.min(200,Math.pow(MD.CONSTRUCT_LEVELS[10],1/7))},gemFindPerMage1:0.01,gemFindPerMage2:0.02,gemFindPerMage3:0.04,gemFindPerMage4:0.08,gemFindPerMage5:0.16,gemMult1:2,gemMult2:5,meditatelevel1:1.5,meditatelevel2:2,meditatelevel3:2,meditatelevel4:3,neuropercent1:3,neuropercent2:7,elementalpick:1100,numPerDouble:13};MD.convals={dragonmount_levels:[0,1,20,50],dragonmount_text:["A large mound of rock sits plainly in a fenced compound. Have you considered adding some gold?","The mound of rock begins to sparkle, and your wyverns seem to work a bit harder.","Your treasure heap rivals that of the kings of old, there are those who call you wyvern-tamer.","The gleaming of your golden mountain is visible for miles around, and legends are told across the earth of your wealth and power."],dragonmount_function:function(a){return 1+(a+1)+Math.pow((a+1)/3,2)},magetower_gain:0.001,quarryFindChance:0.15,pitPrice:{goblin:1,coal:2,iron:100},habLevels:[10,500,10000],farmtime1:60,farmrate1:120,farmrate2:360,farmrate3:1080,barracks_formula:function(b,a){return Math.max(25,(b+a)/n("10K"))},blacksmith_formula:function(b,a){return{mana:Math.max(n("10E"),(b+a)*n("100T"))/(MD.hasUpgrade("Overwhelming Might")?10:1)}},smeltAddyChance:0.75,smeltAddyCost:{goblin:100},goblinSacrificedFormula:function(a){return Math.pow((a/777),(MD.hasMageUpgrade("Diamond Affinity")?1.14:1.09))},mechmagecost:{adamantium:n("50K"),majestic:n("1G"),water:10,fire:10},mechmasoncost:{adamantium:n("50K"),majestic:n("500M"),water:5,fire:5,earth:5},mechalchcost:{adamantium:n("50K"),majestic:n("1G"),water:10,fire:10,earth:10,lightning:10},graveyardbonus:function(){return Math.pow(Math.log(Math.max(1,MD.SOLDIERS_LOST)),1.9)},archspiriteffect:function(){return 10+Math.sqrt(MD.CONSTRUCT_LEVELS[24])/1.5}};MD.UPGRADES=[new MD.Upgrade(0,"Delve Greedily","Multiplies your gold per second by "+MD.uv.delvegreedilymult+"... but be warned - the goblins may notice.","The dwarves of Moria delved too greedily and too deeply. Will you?",n("100K"),function(){return MD.TOTAL_GOLD>=n("75K")},"nightmare"),new MD.Upgrade(1,"Oracle","Allows you to see when the next goblin will arrive.","The goblins will come. The question left to answer is... when?",n("200K"),function(){return MD.hasUpgrade("Delve Greedily")}),new MD.Upgrade(62,"Embrace The Swarm","Multiplies your gold per second by "+MD.uv.embranceswarmmult+"... but it feels a little wrong.","What would you give for a bit more gold?",n("6P"),function(){return MD.HIRELINGS_OWNED[0]>=n("3M")&&MD.hasUpgrade("Delve Greedily")&&MD.hasUpgrade("Goblin's Bane")},"nightmare"),new MD.Upgrade(69,"Dark Portents","Multiplies mage aura power by "+MD.uv.darkportentsmult+"...","Great men are almost always bad men.",n("10P"),function(){return MD.MAGE_MAX_TIME>=1800&&MD.MAGES>=10&&MD.TOTAL_GOLD>=n("5P")},"nightmare"),new MD.Upgrade(262,"The Golden Well","Allows you to increase spirit essence efficiency by spending vast amounts of gold.","We're not sure where it goes, or how it never fills up, but it makes us feel GREAT!",n("5QQ"),function(){return MD.TOTAL_GOLD>=n("5SQ")},"progress"),new MD.Upgrade(150,"Precious Resources","Baggers now produce 1 dirt per second. This is good.","All men rejoice, when after a hard day of sifting through gold, they finally strike dirt. And having half a bagger's weight in baggers is a good way to get there.",n("1X"),function(){return MD.HIRELINGS_OWNED[7]>=n("6.75K")},"progress"),new MD.Upgrade(155,"The Wheel Turns","Unlocks the quarry, which allows rock golems to dig up more than just gold.","It's taken some time, but you are beginning to realize that you can't build everything out of gold.",{gold:n("100X"),dirt:n("50M")},function(){return MD.HIRELINGS_OWNED[6]>=n("12.34K")},"progress"),new MD.Upgrade(157,"Deep Mining","Rock golems now produce iron and coal, albeit at a much slower rate than stone.","Your rock golems have learned much, and can now find more valuable resources in the depths.",{gold:n("1W"),stone:n("100M")},function(){return MD.hasConstruct("Quarry")&&MD.TOTAL_STONE>=n("50M")},"progress"),new MD.Upgrade(164,"Secret of Barad-dur","Unlock the ability to forge steel from coal and iron.","Your mages have stumbled upon a great secret - which will further your empire in grand ways.",{gold:n("10W"),coal:n("10K"),iron:n("100K"),stone:n("100M")},function(){return MD.MAGE_TOWER_RESEARCH>=15000&&MD.CONSTRUCT_LEVELS[4]>=5},"progress"),new MD.Upgrade(2,"Pioneer Spirit","Multiplies your mining efficiency by "+MD.uv.pioneerspiritmult+".","The gold might just be sitting there, but that doesn't mean you don't have to work for it.",1000,function(){return MD.totalClicks()>=100}),new MD.Upgrade(3,"Mining Mastery","Multiplies your mining efficiency by "+MD.uv.miningmasterymult+".","A journey of a thousand miles begins with 1 step, and you've taken at least 4.",n("100K"),function(){return MD.totalClicks()>=1000}),new MD.Upgrade(4,"Terra's Might","Multiplies your mining efficiency by "+MD.uv.terrasmightmult+".","The earth trembles at the fall of your pick. Actually, I guess the earth trembles at the fall of any pick.",n("1M"),function(){return MD.totalClicks()>=10000}),new MD.Upgrade(5,"Looting Proficiency","Multiplies goblin reward and spawn rate by "+MD.uv.lootingproficiencymult+".","You're getting pretty good at this, aren't you?",n("750K"),function(){return MD.GOBLINS_KILLED>=100}),new MD.Upgrade(6,"Goblin's Bane","Multiplies goblin reward and spawn rate by "+MD.uv.goblinsbanemult+".","After awhile, you learn where they hide the good stuff.",n("7.5M"),function(){return MD.GOBLINS_KILLED>=n("1K")}),new MD.Upgrade(7,"Goblin's Scourge","Multiplies goblin reward and spawn rate by "+MD.uv.goblinsscourgemult+".","Goblins tremble at the sight of you, and flee for cover when you draw your... pick.",n("75M"),function(){return MD.GOBLINS_KILLED>=n("10K")}),new MD.Upgrade(8,"Goblin's Terror","Multiplies goblin reward and spawn rate by "+MD.uv.goblinsterrormult+".","Your name appears frequently in bedtime stories told to Goblin children.",n("750M"),function(){return MD.GOBLINS_KILLED>=n("100K")}),new MD.Upgrade(63,"Covered in Web","Multiplies spider reward and spawn rate by "+MD.uv.spidermult1+".","Why does it always have to be spiders?",n("5P"),function(){return MD.SPIDERS_KILLED>=50}),new MD.Upgrade(64,"Eww Eww Eww","Multiplies spider reward and spawn rate by "+MD.uv.spidermult2+".","Creatures like this just shouldn't exist :(.",n("50P"),function(){return MD.SPIDERS_KILLED>=n(200)}),new MD.Upgrade(65,"Arachnid Mangler","Multiplies spider reward and spawn rate by "+MD.uv.spidermult3+".","Fashion experts have described your style as spider entrail sheik.",n("100P"),function(){return MD.SPIDERS_KILLED>=n(1000)}),new MD.Upgrade(66,"Shelob Slasher","Multiplies spider reward and spawn rate by "+MD.uv.spidermult4+".","After hours and hours you have attained the status of... Samwise Gamgee.",n("200P"),function(){return MD.SPIDERS_KILLED>=n("10K")}),new MD.Upgrade(9,"Enlarged Pincers","Multiplies ant dig rate by "+MD.uv.level1mult+".","Makes ants a little less pathetic.",n("250"),function(){return MD.HIRELINGS_OWNED[0]>=10}),new MD.Upgrade(10,"Fire Ants","Multiplies ant dig rate by "+MD.uv.level2mult+".","Only pathetic until you see them sting.",n("100K"),function(){return MD.HIRELINGS_OWNED[0]>=50}),new MD.Upgrade(11,"For The Queen","Multiplies ant dig rate by "+MD.uv.level3mult+".","Strength in numbers.",n("500M"),function(){return MD.HIRELINGS_OWNED[0]>=100}),new MD.Upgrade(55,"Colonization","Multiplies ant dig rate by "+MD.uv.level4mult+".","A little bit ominous.",n("500T"),function(){return MD.HIRELINGS_OWNED[0]>=n("10K")}),new MD.Upgrade(56,"Who's Pathetic Now?","Multiplies ant dig rate by "+MD.uv.level5mult+".","The swarm is rising.",n("2P"),function(){return MD.HIRELINGS_OWNED[0]>=n("1M")}),new MD.Upgrade(12,"Feeding Frenzy","Multiplies woodpecker dig rate by "+MD.uv.level1mult+".","Fear is a great motivator - but birds are always scared, so let's try hunger.",n("2K"),function(){return MD.HIRELINGS_OWNED[1]>=10}),new MD.Upgrade(13,"Curved Beaks","Multiplies woodpecker dig rate by "+MD.uv.level2mult+".","They look a little bit less cute with sharp hooks on their faces.",n("1M"),function(){return MD.HIRELINGS_OWNED[1]>=50}),new MD.Upgrade(14,"Nature's Power Drill","Multiplies woodpecker dig rate by "+MD.uv.level3mult+".","Technology is overrated.",n("10G"),function(){return MD.HIRELINGS_OWNED[1]>=100}),new MD.Upgrade(96,"Ironbeaks","Multiplies woodpecker dig rate by "+MD.uv.level4mult+".","At this point they're hardly feathered, winged, two-legged, warm-blooded, egg-laying vertebrates.",n("50T"),function(){return MD.HIRELINGS_OWNED[1]>=150}),new MD.Upgrade(130,"Jeweled Beak","Allows alchemical transmutation of woodpeckers.","We haven't quite figured out the biology on this.",{normal:300},function(){return MD.HIRELINGS_OWNED[1]>=200}),new MD.Upgrade(195,"Woody See, Woody Do","For each billion woodpeckers, one will click the mine each second (up to 20 clicks).","You'd think they'd have tried this before now.",{normal:n("1M")},function(){return MD.HIRELINGS_OWNED[1]>=n("1G")}),new MD.Upgrade(196,"Putting in Work","Each woodpecker contributes 1 million times as much to the pick boost from Communal Effort.","Putting all the others to shame.",{normal:n("1G")},function(){return MD.HIRELINGS_OWNED[1]>=n("1T")&&MD.hasUpgrade("Communal Effort")}),new MD.Upgrade(15,"Sharpened Senses","Multiplies bloodhound dig rate by "+MD.uv.level1mult+".","These bloodhounds smell gold... or something.",n("7.5K"),function(){return MD.HIRELINGS_OWNED[2]>=10}),new MD.Upgrade(16,"Reduced Slobber","Multiplies bloodhound dig rate by "+MD.uv.level2mult+".","Why am I always sticky?.",n("8M"),function(){return MD.HIRELINGS_OWNED[2]>=50}),new MD.Upgrade(17,"Nightmare Hounds","Multiplies bloodhound dig rate by "+MD.uv.level3mult+".","The dig site just got haunteder.",n("50G"),function(){return MD.HIRELINGS_OWNED[2]>=100}),new MD.Upgrade(97,"Cerberus","Multiplies bloodhound dig rate by "+MD.uv.level4mult+".","I really think you should stop hiring these...",n("150T"),function(){return MD.HIRELINGS_OWNED[2]>=150}),new MD.Upgrade(131,"Jeweled Eyes","Allows alchemical transmutation of bloodhounds.","Now with 23% more natural bloodhound DNA.",{normal:1000},function(){return MD.HIRELINGS_OWNED[2]>=200}),new MD.Upgrade(198,"Getting Hungry","Each bloodhound eats an ant each tick, and the number of ants eaten increase alchemical yield.","We're not really sure how this works.",{normal:n("4M")},function(){return MD.HIRELINGS_OWNED[2]>=n("1G")}),new MD.Upgrade(199,"Hound's Best Friend","Ants eaten increases your alchemical yield by a greater amount.","Mmm... ants. Someone get the magnifying glass.",{normal:n("4G")},function(){return MD.HIRELINGS_OWNED[2]>=n("1T")}),new MD.Upgrade(18,"Cute Overload","Multiplies sandshrew dig rate by "+MD.uv.level1mult+".","Dawwwww.",n("25K"),function(){return MD.HIRELINGS_OWNED[3]>=10}),new MD.Upgrade(19,"Fury Swipes","Multiplies sandshrew dig rate by "+MD.uv.level2mult+".","Woah.... looks like the little guy is mad.",n("10M"),function(){return MD.HIRELINGS_OWNED[3]>=50}),new MD.Upgrade(20,"Sandslash","Multiplies sandshrew dig rate by "+MD.uv.level3mult+".","Level 22 baby!",n("50G"),function(){return MD.HIRELINGS_OWNED[3]>=100}),new MD.Upgrade(98,"Earthquake","Multiplies sandshrew dig rate by "+MD.uv.level4mult+".","I can't possibly make this as overpowered as the pokemon move.",n("3P"),function(){return MD.HIRELINGS_OWNED[3]>=150}),new MD.Upgrade(132,"Bedazzled Pokeballs","Allows alchemical transmutation of sandshrew.","Hanging out in the lap of luxury.",{great:500},function(){return MD.HIRELINGS_OWNED[3]>=200}),new MD.Upgrade(200,"Armor Sharing","Every wall fortification increases sandshrew earning by "+s(MD.uv.sandperfort)+".","About time this wall was good for something.",{great:n("1M")},function(){return MD.HIRELINGS_OWNED[3]>=n("1G")}),new MD.Upgrade(201,"Amplificatory Armor","Every wall fortification increases mage damage by 2%.","Let them kill us... to kill them? Someone get the magnifying glass.",{great:n("1G")},function(){return MD.HIRELINGS_OWNED[3]>=n("1T")}),new MD.Upgrade(21,"Midas Touch","Multiplies goblin dig rate by "+MD.uv.level1mult+".","For those who dream of gold.",n("200K"),function(){return MD.HIRELINGS_OWNED[4]>=10}),new MD.Upgrade(22,"Gringotts Employee","Multiplies goblin dig rate by "+MD.uv.level2mult+".","Not just selfish, but greedy too.",n("15M"),function(){return MD.HIRELINGS_OWNED[4]>=50}),new MD.Upgrade(23,"Azog","Multiplies goblin dig rate by "+MD.uv.level3mult+".","Curse his name.",n("500G"),function(){return MD.HIRELINGS_OWNED[4]>=100}),new MD.Upgrade(99,"Blinding Greed","Multiplies goblin dig rate by "+MD.uv.level4mult+".","Failing the pre-employment screening is actually a requirement.",n("10P"),function(){return MD.HIRELINGS_OWNED[4]>=150}),new MD.Upgrade(133,"Gleaming Eyes","Allows alchemical transmutation of goblins.","Oh... how they hunger.",{great:1500},function(){return MD.HIRELINGS_OWNED[4]>=200}),new MD.Upgrade(172,"Dirty Hands","Multiplies coal production by "+MD.uv.level1mult+".","Sometimes there's nothing for it but rolling up your sleeves and digging in.",{steel:n("10K"),iron:n("250K")},function(){return MD.HIRELINGS_OWNED[4]>=n("1M")&&MD.TOTAL_STEEL>0}),new MD.Upgrade(202,"Seed of Rebellion","Your goblins earn more gold per second for every point of damage done to the wall by attacking goblins.","Should we be concerned about this?",{great:n("3M")},function(){return MD.HIRELINGS_OWNED[4]>=n("1G")}),new MD.Upgrade(203,"Traitorous Goblins","Your goblins may not be as loyal as we'd hoped.","It was only a matter of time...",{great:n("3G")},function(){return MD.HIRELINGS_OWNED[4]>=n("1T")},"nightmare"),new MD.Upgrade(24,"Overtime","Multiplies miner dig rate by "+MD.uv.level1mult+".","I'm not sure what country we're in, but apparently there are no labor laws.",n("1M"),function(){return MD.HIRELINGS_OWNED[5]>=10}),new MD.Upgrade(25,"Dual Pickaxes","Multiplies miner dig rate by "+MD.uv.level2mult+".","This is probably less efficient, but it looks hardcore.",n("100M"),function(){return MD.HIRELINGS_OWNED[5]>=50}),new MD.Upgrade(26,"Herobrine","Multiplies miner dig rate by "+MD.uv.level3mult+".","White eyes in the darkness.",n("1T"),function(){return MD.HIRELINGS_OWNED[5]>=100}),new MD.Upgrade(100,"Blur of Picks","Multiplies miner dig rate by "+MD.uv.level4mult+".","The tazmanian devil of miners, they begin to look like blurred outlines flashing with steel.",n("30P"),function(){return MD.HIRELINGS_OWNED[5]>=150}),new MD.Upgrade(134,"Crystal Axes","Allows alchemical transmutation of miners.","Maximum power.",{flawless:100},function(){return MD.HIRELINGS_OWNED[5]>=200}),new MD.Upgrade(204,"Miner Blindness Reduction","Miners have a small chance of finding gems.","How did they miss them all this time?",{flawless:n("1M")},function(){return MD.HIRELINGS_OWNED[5]>=n("1G")}),new MD.Upgrade(205,"Expert Consulting","Quarry findings are improved for every miner you have.","Where is the quarry? Why is it different from the mine? I'm confused.",{flawless:n("1G")},function(){return MD.HIRELINGS_OWNED[5]>=n("1T")}),new MD.Upgrade(27,"Runite Ore Drop","Multiplies rock golem dig rate by "+MD.uv.level1mult+".","Which game is this again?.",n("2M"),function(){return MD.HIRELINGS_OWNED[6]>=10}),new MD.Upgrade(28,"Extra Pointy","Multiplies rock golem dig rate by "+MD.uv.level2mult+".","Don't work too close, you don't want to get crushed.",n("250M"),function(){return MD.HIRELINGS_OWNED[6]>=50}),new MD.Upgrade(29,"Mountain Men","Multiplies rock golem dig rate by "+MD.uv.level3mult+".","Note the emphasis - not mountain-like men, but men-like mountains.",n("3T"),function(){return MD.HIRELINGS_OWNED[6]>=100}),new MD.Upgrade(101,"Carbonado Cores","Multiplies rock golem dig rate by "+MD.uv.level4mult+".","Giant rocks filled with more better rocks.",n("100P"),function(){return MD.HIRELINGS_OWNED[6]>=150}),new MD.Upgrade(135,"Crystalline Hands","Allows alchemical transmutation of rock golems.","At least it will be bright when they crush you.",{flawless:400},function(){return MD.HIRELINGS_OWNED[6]>=200}),new MD.Upgrade(206,"Strange Transformation","There is a now a tiny chance of a rock golem being converted to a mage each tick.","To be fair... we don't really know anything about rock golems.",{flawless:n("1M")},function(){return MD.HIRELINGS_OWNED[6]>=n("1G")}),new MD.Upgrade(207,"Myth and Machine","Baggers now produce more dirt for every rock golem hired.","Teamwork is beautiful.",{flawless:n("1G")},function(){return MD.HIRELINGS_OWNED[6]>=n("1T")}),new MD.Upgrade(30,"13500","Multiplies bagger 288 dig rate by "+MD.uv.level1mult+".","Why does this exist?.",n("20M"),function(){return MD.HIRELINGS_OWNED[7]>=10}),new MD.Upgrade(31,"Sehr gut!","Multiplies bagger 288 dig rate by "+MD.uv.level2mult+".","Es ist wunderschoen!.",n("10G"),function(){return MD.HIRELINGS_OWNED[7]>=50}),new MD.Upgrade(32,"German Engineering","Multiplies bagger 288 dig rate by "+MD.uv.level3mult+".","Oh those Germans...",n("100T"),function(){return MD.HIRELINGS_OWNED[7]>=100}),new MD.Upgrade(102,"Unreasonable Force","Multiplies bagger 288 dig rate by "+MD.uv.level4mult+".","Sometimes you have to wonder why anyone would want to dig this much.",n("1E"),function(){return MD.HIRELINGS_OWNED[7]>=150}),new MD.Upgrade(136,"Diamond-Studded Treads","Allows alchemical transmutation of baggers.","The biggest thing in useless bling technology.",{exceptional:500},function(){return MD.HIRELINGS_OWNED[7]>=200}),new MD.Upgrade(169,"Diesel Engines","Baggers produce "+MD.uv.level1mult+" times as much dirt.","You can smell the fumes for miles.",{coal:n("10K")},function(){return MD.HIRELINGS_OWNED[7]>=n("1M")}),new MD.Upgrade(208,"Dig Smarter, Not Harder","Baggers now produce a small amount of coal each tick.","Yay! More coal!",{flawless:n("1M")},function(){return MD.HIRELINGS_OWNED[7]>=n("1G")}),new MD.Upgrade(209,"Machine and Myth","Rock golems now produce more stone for every bagger hired.","We shall strip the earth to the core!",{flawless:n("1G")},function(){return MD.HIRELINGS_OWNED[7]>=n("1T")}),new MD.Upgrade(33,"Gaia's Training","Multiplies earth titan dig rate by "+MD.uv.level1mult+".","Study hard my friends.",n("8G"),function(){return MD.HIRELINGS_OWNED[8]>=10}),new MD.Upgrade(34,"Hyperion","Multiplies earth titan dig rate by "+MD.uv.level2mult+".","Applied mythology.",n("100G"),function(){return MD.HIRELINGS_OWNED[8]>=50}),new MD.Upgrade(35,"Commander Kronus","Multiplies earth titan dig rate by "+MD.uv.level3mult+".","The master of time - as opposed to you, who has spent ages on this game.",n("10P"),function(){return MD.HIRELINGS_OWNED[8]>=100}),new MD.Upgrade(103,"Masters of Old","Multiplies earth titan dig rate by "+MD.uv.level4mult+".","You sometimes wonder why they choose to help you.",n("80E"),function(){return MD.HIRELINGS_OWNED[8]>=150}),new MD.Upgrade(137,"Diamond Hearts","Allows alchemical transmutation of earth titans.","They seem to be growing warmer.",{perfect:300},function(){return MD.HIRELINGS_OWNED[8]>=200}),new MD.Upgrade(170,"Rock Out","Multiplies stone production by "+MD.uv.level2mult+".","About time these things started carrying their weight.",{steel:500,stone:n("1M")},function(){return MD.TOTAL_STEEL>=0&&MD.HIRELINGS_OWNED[8]>=n("1M")}),new MD.Upgrade(210,"Symbiosis","Your earth titans produce "+s(MD.uv.titanperpop)+" more gold for each population in your habitation.","Yay for gold!",{perfect:n("1M")},function(){return MD.HIRELINGS_OWNED[8]>=n("1G")}),new MD.Upgrade(211,"Academic Symbiosis","Your earth titans produce "+s(100*MD.uv.titanperpop)+" more gold for each scholar in your university.","I was wondering what scholars were good for...",{perfect:n("1G")},function(){return MD.HIRELINGS_OWNED[8]>=n("1T")}),new MD.Upgrade(52,"Rotating Jaw","Multiplies world eater dig rate by "+MD.uv.level1mult+".","If you thought they were scary before, try filling their mouths with saw blades.",n("1T"),function(){return MD.HIRELINGS_OWNED[9]>=10}),new MD.Upgrade(53,"Aerodynamic Plating","Multiplies world eater dig rate by "+MD.uv.level2mult+".","Picture an eel, but weighing five hundred tons and gliding through solid rock.",n("1P"),function(){return MD.HIRELINGS_OWNED[9]>=50}),new MD.Upgrade(54,"Diamond Enforced Teeth","Multiplies world eater dig rate by "+MD.uv.level3mult+".","A bright blue sparkle is the last thing you'll ever see.",n("1E"),function(){return MD.HIRELINGS_OWNED[9]>=100}),new MD.Upgrade(104,"Apophis","Multiplies world eater dig rate by "+MD.uv.level4mult+".","Eaters of worlds... perhaps this is overkill?",n("1Z"),function(){return MD.HIRELINGS_OWNED[9]>=150}),new MD.Upgrade(138,"Crystal Shard Eyes","Allows alchemical transmutation of world eaters.","They see all.",{majestic:10},function(){return MD.HIRELINGS_OWNED[9]>=200}),new MD.Upgrade(212,"Makes Sense","World eaters now produce dirt.","I guess all the stuff they dig through has to go somewhere.",{majestic:n("250K")},function(){return MD.HIRELINGS_OWNED[9]>=n("1G")}),new MD.Upgrade(213,"Energy of Earth","The amount of adamantium found in the smelting pit increases for each dirt converted to mana by your alchemists.","We're not sure how this is related to world eaters.",{majestic:n("250M")},function(){return MD.HIRELINGS_OWNED[9]>=n("1T")}),new MD.Upgrade(57,"Ventral Sacs","Increases queen spawn rate by "+MD.uv.queenupgrade1+".","Overlords gain the ability to transport... what game is this again?.",n("500T"),function(){return MD.HIRELINGS_OWNED[10]>=10}),new MD.Upgrade(81,"Bulbosity Enhancement","Increases queen spawn rate by "+MD.uv.queenupgrade2+".","This doesn't really seem like a good thing.",n("5P"),function(){return MD.HIRELINGS_OWNED[10]>=25}),new MD.Upgrade(58,"Larval Acceleration","Increases queen spawn rate by "+MD.uv.queenupgrade2+".","The mine has become significantly more... writhy.",n("1E"),function(){return MD.HIRELINGS_OWNED[10]>=50}),new MD.Upgrade(59,"Unnatural Virility","Increases queen spawn rate by "+MD.uv.queenupgrade3+".","This is becoming a problem....",n("1Z"),function(){return MD.HIRELINGS_OWNED[10]>=100}),new MD.Upgrade(105,"Hive Mentality","Increases queen spawn rate by "+MD.uv.queenupgrade4+".","The ground is alive.",n("1Y"),function(){return MD.HIRELINGS_OWNED[10]>=150}),new MD.Upgrade(139,"Diamond-Spiked Eggs","Allows alchemical transmutation of hive queens.","Just try to get near these suckers.",{majestic:100},function(){return MD.HIRELINGS_OWNED[10]>=200}),new MD.Upgrade(214,"Ever Advancing","Queen spawn rate increases based on the number of ants you have.","This... could be a problem.",{majestic:n("1M")},function(){return MD.HIRELINGS_OWNED[10]>=n("1G")}),new MD.Upgrade(215,"Extreme Mutation","Hive Queens occasionally produce a small number of non-ant hirelings.","A sac of world eater eggs is about the scariest thing on earth.",{majestic:n("1G")},function(){return MD.HIRELINGS_OWNED[10]>=n("1T")}),new MD.Upgrade(106,"Reinforced Claws","Increases wyvern dig rate by "+MD.uv.level1mult+".","They tear through stone like its made of paper.",n("1E"),function(){return MD.HIRELINGS_OWNED[11]>=10}),new MD.Upgrade(107,"Crystal Vision","Increases wyvern dig rate by "+MD.uv.level2mult+".","It feels like they're looking through you... or trying to decide what the iron in your blood is worth.",n("2Z"),function(){return MD.HIRELINGS_OWNED[11]>=50}),new MD.Upgrade(108,"Rhenium Heart","Increases wyvern dig rate by "+MD.uv.level3mult+" and allows alchemical transmutation of wyverns.","This makes them dig faster, and definitely does not lead to immediate cardiac arrest.",n("2Y"),function(){return MD.HIRELINGS_OWNED[11]>=100}),new MD.Upgrade(109,"Truth Exceeding Legend","Increases wyvern dig rate by "+MD.uv.level4mult+".","Right out of a storybook used to scare children.",n("800Y"),function(){return MD.HIRELINGS_OWNED[11]>=150}),new MD.Upgrade(153,"Mythical Power","Increases wyvern dig rate by "+MD.uv.level5mult+".","All men tremble when the blue terror blots out the sun.",n("250X"),function(){return MD.HIRELINGS_OWNED[11]>=200}),new MD.Upgrade(171,"Iron Affinity","Multiplies iron production by "+MD.uv.level1mult+".","Turns out they're good for more than just digging.",{steel:n("5K"),coal:n("50K")},function(){return MD.HIRELINGS_OWNED[11]>=n("1M")&&MD.TOTAL_STEEL>0}),new MD.Upgrade(189,"Adamantium Affinity","You now produce 1 adamantium per second for every ten million Wyverns hired.","Now and then they find something useful.",{adamantium:n("75")},function(){return MD.HIRELINGS_OWNED[11]>=n("1M")&&MD.TOTAL_ADAMANTIUM>0}),new MD.Upgrade(216,"Ten Thousand Foot View","Buried treasure becomes much more common.","How does this work? X-ray vision!",{majestic:n("4M")},function(){return MD.HIRELINGS_OWNED[11]>=n("1G")}),new MD.Upgrade(217,"Big Cousins","Dragon level up cost is reduced by 2%.","This will save you more than you'd think.",{majestic:n("4G")},function(){return MD.HIRELINGS_OWNED[11]>=n("1T")}),new MD.Upgrade(147,"Neurological Compounding","Increases neurochrysalis generation rate by "+MD.uv.level1mult+".","Combining the neurological centers of entire colonies of ants has yielded unforeseen advances in mana technology.",{mana:n("3P")},function(){return MD.HIRELINGS_OWNED[12]>=10}),new MD.Upgrade(148,"Full Assimilation","Increases neurochrysalis generation rate by "+MD.uv.level2mult+".","Far greater mana gain can be achieved when removing chyrsalis constraints on drawing irrecoverably from the host.",{mana:n("20P")},function(){return MD.HIRELINGS_OWNED[12]>=50}),new MD.Upgrade(167,"Metamorphosis","Increases neurochrysalis generation rate by "+MD.uv.level3mult+".","Growing and morphing... what will come of this?",{mana:n("750P")},function(){return MD.HIRELINGS_OWNED[12]>=100}),new MD.Upgrade(181,"Neurological Enlightenment","Allows alchemical transmutation of neurochrysalis.","About time we figured this out.",{"large ant":n("1P")},function(){return MD.HIRELINGS_OWNED[12]>=100&&MD.MAGE_TOWER_RESEARCH>=n("100K")}),new MD.Upgrade(251,"Flax Affinity","You now produce 1 flax per second for every twenty million neurochrysalises hired.","Do not try to bend the flax, only realize the truth. There is no flax.",{flax:n("10K")},function(){return MD.HIRELINGS_OWNED[12]>=n("100M")&&MD.TOTAL_FLAX>0}),new MD.Upgrade(218,"Mental Energies","Your alchemists can convert dirt to mana 15 times as efficiently.","I'm a little bit worried about what these neurothingies are doing.",{majestic:n("250M")},function(){return MD.HIRELINGS_OWNED[12]>=n("1G")}),new MD.Upgrade(219,"Collective Knowledge","Scholars increase essence gain by a tiny amount.","If you're a student, then what are you still doing here? Don't you have homework?",{majestic:n("250G")},function(){return MD.HIRELINGS_OWNED[12]>=n("1T")}),new MD.Upgrade(253,"Mana Man","Neurochrysalises produce twice as much mana and slightly more flax.","Never give up - eventually things will work out.",{mana:n("1X"),gold:n("100KQ")},function(){return sumArray(MD.IMBUEMENT_LEVEL)>=2500}),new MD.Upgrade(244,"Archery Courses","Increases dragon hunter hunt rate by "+MD.uv.level1mult+".","It's about time they stopped flinging arrows about willy nilly.",{dragonscale:100},function(){return MD.HIRELINGS_OWNED[13]>=10}),new MD.Upgrade(245,"Adamantium Tipped Arrows","Increases dragon hunter hunt rate by "+MD.uv.level2mult+".","Why were we making our arrows out of gold again?",{dragonscale:n("1K")},function(){return MD.HIRELINGS_OWNED[13]>=50}),new MD.Upgrade(246,"Homing Darts","Increases dragon hunter hunt rate by "+MD.uv.level3mult+".","No skill required.",{dragonscale:n("10K")},function(){return MD.HIRELINGS_OWNED[13]>=100}),new MD.Upgrade(247,"Human Fusion","Allows alchemical transmutation of dragon hunters.","How is this different than a miner with a bow? We don't know.",{dragonscale:n("100K"),fire:25},function(){return MD.HIRELINGS_OWNED[13]>=100&&MD.hasDragon("Youngling")}),new MD.Upgrade(259,"Draconic Knowledge","Dragon level up cost is reduced by 3%.","Who'd have thunk it... they're good for more than just killing.",{dragonscale:n("10G"),fire:n("25K")},function(){return MD.HIRELINGS_OWNED[13]>=n("1G")&&MD.hasDragon("Youngling")&&MD.hasUpgrade("Big Cousins")}),new MD.Upgrade(36,"Magic!","Multiplies mage damage by "+MD.uv.level1mult+".","Magic, magic, magic!",n("10M"),function(){return MD.MAGES>=10}),new MD.Upgrade(37,"Dumbledore's Finest","Multiplies mage damage by "+MD.uv.level2mult+".","Only Hogwarts trained wizards need apply!",n("100G"),function(){return MD.MAGES>=50}),new MD.Upgrade(38,"Merlin","Multiplies mage damage by "+MD.uv.level3mult+".","Wrapped in mystery, none dare to question the wizards of the mine!",n("100T"),function(){return MD.MAGES>=100}),new MD.Upgrade(112,"Deity-ish","Multiplies mage damage by "+MD.uv.level4mult+".","They are like gods... if gods were limited to 3 very specific tasks!",{gold:n("100P"),mana:n("100M")},function(){return MD.MAGES>=150}),new MD.Upgrade(140,"Durable Mana Channels","Mages remain charged up for twice as long.","It just keeps going.",n("10T"),function(){return MD.MAGE_MAX_TIME>=3600&&MD.MAGES>=35}),new MD.Upgrade(141,"Eternal Energy","Mages remain charged up for twice as long.","They become like the surrounding environment. Tranquil. Unmoving.",{exceptional:1},function(){return MD.MAGE_MAX_TIME>=7200&&MD.MAGES>=50}),new MD.Upgrade(142,"Mana Overcharge","Mages require fewer clicks to charge up.","New and improved, now with faster boot times!.",n("10T"),function(){return MD.MAGE_MAX_TIME>=10800&&MD.MAGES>=75}),new MD.Upgrade(193,"Instant Power","Mages charge up in a single click and remain that way for longer.","With this upgrade, 1 click is the equivalent of 38 episodes of Dragonball Z.",n("10W"),function(){return MD.MAGE_MAX_TIME>=43200&&MD.MAGES>=300}),new MD.Upgrade(39,"Elbow Grease","Multiplies craftsman repair rate by "+MD.uv.level1mult+".","Sometimes you just have to get er done.",n("5M"),function(){return MD.MASONS>=10}),new MD.Upgrade(40,"Takin Care of Business","Multiplies craftsman repair rate by "+MD.uv.level2mult+" plus "+MD.uv.masonPercent1+"% of wall durability.","Every day! Each and every way!",n("10G"),function(){return MD.MASONS>=50}),new MD.Upgrade(41,"Overall-Clad Blurs","Multiplies craftsman repair rate by "+MD.uv.level3mult+" plus "+MD.uv.masonPercent2+"% of wall durability.","We're not even sure how they move that fast...",n("50T"),function(){return MD.MASONS>=100}),new MD.Upgrade(113,"Alchemical Repair Rates","Multiplies craftsman repair rate by "+MD.uv.level4mult+" plus "+MD.uv.masonPercent3+"% of wall durability.","They just sort of clap, some sparks fly and things get fixed.",n("50P"),function(){return MD.MASONS>=150}),new MD.Upgrade(144,"Alchemical Furor","Multiplies alchemical speed by "+MD.uv.level1mult+".","Not everything is as it seems.",{gold:n("5Y"),normal:2000},function(){return MD.ALCHEMISTS>=10}),new MD.Upgrade(145,"Philosopher's Stone","Multiplies alchemical speed by "+MD.uv.level2mult+".","This is the law of equivalence exchange, but it can be avoided.",{gold:n("5X"),normal:5000},function(){return MD.ALCHEMISTS>=50}),new MD.Upgrade(146,"The Elric Brothers","Multiplies alchemical speed by "+MD.uv.level3mult+".","Experts from a foreign land have come to share their trade.",{gold:n("50X"),normal:10000},function(){return MD.ALCHEMISTS>=100}),new MD.Upgrade(248,"Flying Sparks","Multiplies alchemical speed by "+MD.uv.level4mult+".","Armies rise out of the dust of a thousand shattered gems.",{gold:n("25D"),majestic:n("250M")},function(){return MD.ALCHEMISTS>=150}),new MD.Upgrade(180,"Higher Learning","Multiplies alchemical speed by "+MD.uv.level5mult+" and farms produce "+MD.uv.level3mult+" more food.","Stay in school, so you can make bread from gold. Wait... what?",{gold:n("10S")},function(){return MD.ALCHEMISTS>=200&&MD.getEducationLevel()>=50000}),new MD.Upgrade(151,"Increased Yields","Alchemical recipes produce "+MD.uv.level1mult+" times as much at no additional cost.","It takes some time to get these things right.",{majestic:100,mana:n("1P")},function(){return MD.ALCHEMISTS>=10&&MD.TOTAL_GEMS>=n("1M")}),new MD.Upgrade(152,"Unequivalent Exchange","Alchemical recipes produce "+MD.uv.level2mult+" times as much at no additional cost.","Sometimes you really do get something for nothing.",{majestic:400,mana:n("10P")},function(){return MD.ALCHEMISTS>=25&&MD.TOTAL_GEMS>=n("2.5M")}),new MD.Upgrade(156,"Desert Bloom","Alchemical recipes produce "+MD.uv.level3mult+" times as much at no additional cost.","You've done great things with the place.",{majestic:5000,mana:n("250P")},function(){return MD.ALCHEMISTS>=75&&MD.TOTAL_GEMS>=n("75M")}),new MD.Upgrade(42,"Existing Tunnel Systems","Ants gain "+MD.uv.antpersandshrew+" base gold per second for every sandshrew hired.","Hmm, maybe those ants are good for more than just eating my lunches.",n("50K"),function(){return(MD.HIRELINGS_OWNED[0]>=10&&MD.HIRELINGS_OWNED[3]>=10)}),new MD.Upgrade(43,"Friends With Rare Candies","Sandshrews gain "+MD.uv.sandshrewperminer+" base gold per second for every miner hired.","It is inconclusive whether these effect IV spread, but the little critters sure seem to love them.",n("1M"),function(){return(MD.HIRELINGS_OWNED[3]>=20&&MD.HIRELINGS_OWNED[5]>=15)}),new MD.Upgrade(44,"Affinity With Nature","Woodpeckers gain "+MD.uv.woodpeckerpertitan+" base gold per second for every earth titan owned.","The forests are beautiful again...",n("10G"),function(){return(MD.HIRELINGS_OWNED[1]>=50&&MD.HIRELINGS_OWNED[8]>=10)}),new MD.Upgrade(50,"Gentle Giants","Ants gain "+MD.uv.antperrockgolem+" base gold per second for every rock golem hired.","Harmony between the most simple and the most terrifying is elegant indeed.",n("100G"),function(){return(MD.HIRELINGS_OWNED[0]>=80&&MD.HIRELINGS_OWNED[6]>=50)}),new MD.Upgrade(51,"Mechanized Industry","Miners gain "+MD.uv.minerperbagger+" base gold per second for every bagger 288 hired.","Replenish the earth, and subdue it.",n("1G"),function(){return(MD.HIRELINGS_OWNED[5]>=25&&MD.HIRELINGS_OWNED[7]>=25)}),new MD.Upgrade(114,"Dragonborn","Miners gain "+s(MD.uv.minerperwyvern)+" base gold per second for every wyvern hired.","I just bought Skyrim during the steam sale and haven't played it, so I don't know what to write here.",{perfect:1},function(){return(MD.HIRELINGS_OWNED[5]>=80&&MD.HIRELINGS_OWNED[11]>=10)}),new MD.Upgrade(115,"Internal Army","World eaters gain "+s(MD.uv.worldperant)+" base gold per second for every ant hired.","Crawling in my skin. These wounds, they will not heal.",{exceptional:6,gold:n("100P")},function(){return(MD.HIRELINGS_OWNED[9]>=60&&MD.HIRELINGS_OWNED[0]>=n("25M"))}),new MD.Upgrade(117,"Man's Best Friend","Bloodhounds gain gold per second equal to the number of craftsmen to the power of "+MD.uv.houndpercraftexponent+".","Bloodhounds don't suck.",{normal:4},function(){return(MD.MASONS>=25&&MD.HIRELINGS_OWNED[2]>=60)}),new MD.Upgrade(149,"Everything is Tunnels","Ants gain "+s(MD.uv.antperbagger)+" base gold per second for every bagger 288 hired.","It makes you wonder if the ants are really necessary... your GPS suggests yes.",{"bagger 288":50},function(){return MD.HIRELINGS_OWNED[7]>=n("1K")}),new MD.Upgrade(154,"Not Just A Boulder","Sandshrew gain "+s(MD.uv.sandshrewpergolem)+" base gold per second for every rock golem hired.","The pioneers used to ride these babies for miles!",{sandshrew:n("5K")},function(){return MD.HIRELINGS_OWNED[6]>=n("3K")}),new MD.Upgrade(173,"Underdogs","Goblin gold production is multiplied by the number of bloodhounds and bloodhound gold production is multiplied by the number of goblins.","Teamwork is a good thing.",{"world eater":n("10K")},function(){return(MD.HIRELINGS_OWNED[2]*MD.HIRELINGS_OWNED[4])>n("10G")}),new MD.Upgrade(45,"Pirate's Luck","Treasures appear twice as often","Arr!",n("1G"),function(){return MD.TREASURES_FOUND>=50}),new MD.Upgrade(94,"Gleaming Treasure","Buried treasures now contain gems.","It just adds some color to your run of the mill buried riches.",n("1T"),function(){return MD.TREASURES_FOUND>=200}),new MD.Upgrade(95,"Gold Forever","The maximum treasure amount is multiplied by "+MD.uv.goldforevermult+".","They just keep making these bigger and bigger.",n("1P"),function(){return MD.TREASURES_FOUND>=500}),new MD.Upgrade(60,"A Little Bugged","Pick efficiency is increased by "+MD.uv.pickgainperant+" per ant.","It is said that a man surrounded by insects starts to become one himself.",n("3P"),function(){return MD.PICK_LEVEL>=MD.getPickID("Swarm")&&MD.HIRELINGS_OWNED[0]>n("500K")}),new MD.Upgrade(61,"Mantis Extension","Pick efficiency is increased by "+MD.uv.pickgainperant2+" per ant.","The miner is beginning to look a little... twisted.",n("10P"),function(){return MD.PICK_LEVEL>=MD.getPickID("Swarm")&&MD.HIRELINGS_OWNED[0]>n("5M")}),new MD.Upgrade(67,"A Fan of Upgrades","Upgrades cost "+MD.uv.upgradereduction+"% less.","I'm beginning to think this game is just about collecting stuff.",n("3P"),function(){return MD.UPGRADES_BOUGHT>=50}),new MD.Upgrade(143,"Encouraging Achievements","Each upgrade purchased boosts gold per second by "+MD.uv.gpsperupgrade+"%.","It just gives you a good feeling to see those trophies up there.",n("25M"),function(){return MD.UPGRADES_BOUGHT>=20}),new MD.Upgrade(68,"Bigshot Manager","Hirelings cost "+MD.uv.upgradereduction+"% less.","It is an army bred for a single purpose: to dig up the world of gold.",n("3P"),function(){return(sumArray(MD.HIRELINGS_OWNED)-MD.HIRELINGS_OWNED[0])>=500}),new MD.Upgrade(93,"Communal Effort","Pick efficiency is increased by "+s(MD.uv.pickgainperhireling)+" for each non-ant hireling.","Take a load off.",n("10P"),function(){return(sumArray(MD.HIRELINGS_OWNED)-MD.HIRELINGS_OWNED[0])>=800}),new MD.Upgrade(116,"Advanced Magick","Pick efficiency is increased by an amount that your mages can't quite specify.","Your mages were sitting around, drank a little bit too much, and fired off this spell by accident.",{majestic:3,gold:n("800Y"),mana:n("100G")},function(){return(MD.hasMageUpgrade("HEART!")&&MD.hasUpgrade("Dark Portents")&&MD.MAGES>=260)}),new MD.Upgrade(165,"Trap Aficionado","Goblin gold per second is increased by "+s(MD.uv.goblinpertrap1)+" for each trap purchased.","You scared of a little fight?",n("5G"),function(){return sumArray(MD.TRAPS_BOUGHT)>=100}),new MD.Upgrade(166,"Trap Master","Goblin gold per second is increased by "+s(MD.uv.goblinpertrap2)+" for each trap purchased.","There are people at your camp who have never even seen a goblin.",n("5T"),function(){return sumArray(MD.TRAPS_BOUGHT)>=250&&MD.hasUpgrade("Trap Aficionado")}),new MD.Upgrade(197,"Team Rocket Buyer","Alchemists can now transform sandshrews into gold","They say we're selling them... but they never leave the alchemist's lair.",{sandshrew:50},function(){return MD.HIRELINGS_OWNED[3]>=1000}),new MD.Upgrade(162,"Studiosity","Mage research accumulates "+MD.uv.level1mult+" times as quickly.","It helps to bury your head in books from time to time.",{mana:n("50P")},function(){return MD.MAGE_TOWER_RESEARCH>=n("5K")}),new MD.Upgrade(163,"Age of Wonders","Mage research accumulates "+MD.uv.level2mult+" times as quickly.","Greatness ebbs and flows, and you are going to help it on it's way.",{mana:n("200P")},function(){return MD.MAGE_TOWER_RESEARCH>=n("25K")}),new MD.Upgrade(168,"Mechanical Overload","Your auto-smithy combines gems "+MD.uv.overloadmult1+" times as quickly.","Turn this screw just so, and hit it with a wrench right in the widget.",{steel:n("1K"),coal:n("2.5K")},function(){return MD.hasConstruct("Smelting Pit")&&MD.CONSTRUCT_LEVELS[0]>=10}),new MD.Upgrade(249,"Mechanical Supercharge","Your auto-smithy combines gems "+MD.uv.overloadmult2+" times as quickly.","Wow! Such gem! Much shiny!.",{steel:n("1M"),coal:n("2.5M")},function(){return MD.hasConstruct("Smelting Pit")&&MD.CONSTRUCT_LEVELS[0]>=40&&MD.hasUpgrade("Industrial Brakes")}),new MD.Upgrade(174,"Rush Job","Multiplies land preparation speed by the number of craftsmen hired divided by 100.","Git-R-Done.",{steel:n("2.5K")},function(){return countElements(MD.CONSTRUCT_LOCATIONS,null)<20&&MD.TOTAL_STEEL>0}),new MD.Upgrade(175,"Agriculture","Farms now produce "+MD.convals.farmrate2+" food every harvest.","The bloom of civilization is upon us.",{adamantium:1,steel:n("25K")},function(){return MD.getEducationLevel()>=50}),new MD.Upgrade(176,"Industrial Brakes","Allows you to set a minimum gem amount for the auto-smithy.","Woah there. Let's stop and look around.",{adamantium:1,steel:n("25K")},function(){return MD.getEducationLevel()>=100}),new MD.Upgrade(177,"Steel Affinity","Multiplies smelting pit steel production by "+MD.uv.level1mult+".","About time you kicked things up.",{adamantium:3,steel:n("75K")},function(){return MD.getEducationLevel()>=250}),new MD.Upgrade(178,"War Vultures","The chance of finding adamantium after a campaign is multiplied by "+MD.uv.level3mult+".","All that work of a campaign... and they hardly even search the loot.",{adamantium:5,coal:n("100K")},function(){return MD.getEducationLevel()>=750}),new MD.Upgrade(179,"Irrigation","Farms now produce "+MD.convals.farmrate3+" food every harvest.","Viva la revolucion agricola!.",{adamantium:10,steel:n("100K")},function(){return MD.getEducationLevel()>=2000}),new MD.Upgrade(182,"Peer Pressure","The smelting pit now produces "+MD.uv.level1mult+" times as much.","So many goblins!",{steel:n("5K")},function(){return MD.TOTAL_STEEL>0&&MD.HIRELINGS_OWNED[4]>=n("100K")}),new MD.Upgrade(183,"Enter the Horde","The smelting pit now produces "+MD.uv.level2mult+" times as much.","Only the best may smelt.",{steel:n("50K")},function(){return MD.TOTAL_STEEL>=n("250K")&&MD.HIRELINGS_OWNED[4]>=n("1M")}),new MD.Upgrade(184,"Waste Not","The smelting pit's coal and iron cost per steel is cut in half.","Workplace safety is kind of a concern around here...",{goblin:n("50K")},function(){return MD.TOTAL_STEEL>=0&&MD.CONSTRUCT_LEVELS[5]>=10}),new MD.Upgrade(185,"Want Not","The smelting pit's coal and iron cost per steel is cut in half.","Seriously... why are all these goblins dying?",{goblin:n("500K")},function(){return MD.TOTAL_STEEL>=0&&MD.CONSTRUCT_LEVELS[5]>=20}),new MD.Upgrade(186,"Heavy Smelting","The smelting pit now has a small chance of producing Adamantium at the cost of 100 goblins.","That's right - I dare you to turn it off now!",{adamantium:10},function(){return MD.TOTAL_ADAMANTIUM>=100}),new MD.Upgrade(187,"Learn from the Fallen","Delving mages now find more gems for every goblin sacrified to the smelting pit.","About time those mages did their jobs.",{steel:n("5K"),goblin:n("100K")},function(){return MD.GOBLINS_SACRIFIED>=n("100K")}),new MD.Upgrade(188,"Miner Productivity","The chance of a special discovery at the quarry is multiplied by the number of mine clicks in the past second.","How about some motivation?.",{steel:n("1K"),miner:n("50K")},function(){return MD.hasUpgrade("Deep Mining")&&MD.hasUpgrade("Terra's Might")&&MD.TOTAL_STEEL>0}),new MD.Upgrade(190,"Have Not","The smelting pit now costs half a goblin for every steel it produces, in addition to the regular price.","But... why?.",{goblin:n("10M")},function(){return MD.hasUpgrade("Want Not")&&MD.HIRELINGS_OWNED[4]>=n("25M")}),new MD.Upgrade(191,"Builder's Regret","You now have an option to move buildings on the industry screen.","Don't ask about the logistics here. It's neuro-magic.",{neurochrysalis:50},function(){return MD.hasUpgrade("Neurological Enlightenment")&&MD.TOTAL_STEEL>0}),new MD.Upgrade(194,"Obsessive Recordkeeping","Allows the construction of an administration building, where you can track the growth of your resources over time.","About time somebody knew what was going on around here...",{miner:1000},function(){return MD.hasConstruct("University")}),new MD.Upgrade(220,"Blind Revenge","You can now automatically attack at set intervals from the graveyard.","He who strikes blindly never misses. Except for most of the time.",{population:200,steel:n("5K"),adamantium:n("1K")},function(){return MD.hasConstruct("Graveyard")&&MD.SOLDIERS_LOST>=n("10K")}),new MD.Upgrade(252,"Strike Blindly","Whenever blind revenge activates, a bomb is also dropped if you can afford it.","This is a bad idea.",{population:500,steel:n("5M"),adamantium:n("100K")},function(){return MD.hasConstruct("Graveyard")&&MD.SOLDIERS_LOST>=n("25K")}),new MD.Upgrade(221,"Baby Bonuses","Population recovers twice as quickly.","Making babies, for fun and profit.",{coal:n("2M"),steel:n("1M")},function(){return MD.hasConstruct("Habitation")&&MD.getPopulationMax()>=200}),new MD.Upgrade(222,"Green Revolution","Population recovers twice as quickly and eats half as much.","Mmm... manual labor.",{coal:n("5M"),steel:n("10M"),adamantium:10},function(){return MD.hasConstruct("Habitation")&&MD.getPopulationMax()>=500}),new MD.Upgrade(256,"Untapped Markets","You now have the option to send out scouts to look for new merchants.","The old merchants won't have a chance to rip us off again...",{flax:100,adamantium:100},function(){return MD.MARKET_TRADES>=250&&MD.FLAX>0}),new MD.Upgrade(254,"Ghosts of Quarry Future","Every 30 seconds, if your quarry has found something, it will be added automatically.","We could just hire a miner... but super expensive ghosts are way cooler.",{spirit:3,woodpecker:n("1G")},function(){return MD.TOTAL_SPIRIT_ESSENCE>=3&&MD.HIRELINGS_OWNED[1]>=n("20G")}),new MD.Upgrade(255,"Ghosts of Economic Prowess","Your average market rate is increased based on the number of scholars you own.","All these academics are finely doing something practical...",{spirit:5,majestic:n("5G")},function(){return MD.TOTAL_SPIRIT_ESSENCE>=25&&MD.CONSTRUCT_LEVELS[10]>=n("25M")}),new MD.Upgrade(257,"Ghosts of Rapid Mechanization","Your machinist builds more each second based on your total essence earned.","Santa has elves? Well we have ghosts. Take that Santa.",{spirit:25,majestic:n("5T")},function(){return MD.TOTAL_SPIRIT_ESSENCE>=100&&(MD.hasUpgrade("Fury of Flame")||MD.hasUpgrade("One with Nature")||MD.hasUpgrade("Fury of the Sea"))}),new MD.Upgrade(258,"Auto-Rift 9000","Your machinist inform you of a strange machine they have built, which feeds, raises, and sacrifices a dragon, all in a single click.","Such mighty beasts reduced to this...",{spirit:1000,majestic:n("500T")},function(){return MD.TOTAL_SPIRIT_ESSENCE>=1000&&MD.HIRELINGS_OWNED[13]>=n("1T")}),new MD.Upgrade(263,"Auto-Auto-Rift 9000","For when automatic sacrifice isn't enough.","This is getting out of hand.",{spirit:n("1M"),majestic:n("500P")},function(){return MD.TOTAL_SPIRIT_ESSENCE>=n("1M")&&MD.HIRELINGS_OWNED[13]>=n("1P")&&MD.hasUpgrade("Auto-Rift 9000")}),new MD.Upgrade(46,"The First Steps","Multiplies your gold per second by "+MD.uv.timeupgrade1+".","And so it begins.",n("500"),function(){return MD.TICKS>=600}),new MD.Upgrade(47,"Tick Tock Time","Multiplies your gold per second by "+MD.uv.timeupgrade2+".","The first of many.",n("500K"),function(){return MD.TICKS>=3600}),new MD.Upgrade(48,"Flowing Like A River","Multiplies your gold per second by "+MD.uv.timeupgrade3+".","The hours slip by.",n("500M"),function(){return MD.TICKS>=36000}),new MD.Upgrade(49,"Chronological Torrent","Multiplies your gold per second by "+MD.uv.timeupgrade4+".","Life is but a flash.",n("500T"),function(){return MD.TICKS>=360000}),new MD.Upgrade(158,"Birth of a World","Multiplies stone production by "+MD.uv.level1mult+".","It's amazing what you can get done in a week.",n("500P"),function(){return MD.TICKS>=864000&&MD.TOTAL_STONE>=1}),new MD.Upgrade(192,"On and On","Population recovers twice as quickly.","So much time... at least there have been advances in... medicine or something?",{adamantium:100},function(){return MD.hasConstruct("Habitation")&&MD.TICKS>=1209600}),new MD.Upgrade(250,"Lotsa Time","All resource gain is multiplied by 2.","20 days of Mine Defense!",{fire:100,water:100},function(){return MD.TICKS>=1728000}),new MD.Upgrade(70,"Nightmare Ants","Multiplies mana gain by "+MD.uv.manamult+".","Even ants are scarier with red eyes.",n("25P"),function(){return MD.IMBUEMENT_LEVEL[0]>=5}),new MD.Upgrade(71,"Nightmare Woodpeckers","Multiplies mana gain by "+MD.uv.manamult+".","Fun fact - these woodpeckers can punture a human skull. The more you know.",n("20P"),function(){return MD.IMBUEMENT_LEVEL[1]>=5}),new MD.Upgrade(72,"Nightmare Bloodhounds","Multiplies mana gain by "+MD.uv.manamult+".","You can almost feel their breath on your neck as you work.",n("2P"),function(){return MD.IMBUEMENT_LEVEL[2]>=5}),new MD.Upgrade(73,"Nightmare Sandshrew","Multiplies mana gain by "+MD.uv.manamult+".","Remember the dark pokemon from Pokemon XD? They're like that.",n("4P"),function(){return MD.IMBUEMENT_LEVEL[3]>=5}),new MD.Upgrade(74,"Nightmare Goblins","Multiplies mana gain by "+MD.uv.manamult+".","Cackling in the night. Maybe they're not as tame as we though.",n("6P"),function(){return MD.IMBUEMENT_LEVEL[4]>=5}),new MD.Upgrade(75,"Nightmare Miners","Multiplies mana gain by "+MD.uv.manamult+".","Absolute power corrupts absolutely.",n("8P"),function(){return MD.IMBUEMENT_LEVEL[5]>=5}),new MD.Upgrade(76,"Nightmare Rock Golems","Multiplies mana gain by "+MD.uv.manamult+".","Obsidian shadows loom in the night.",n("10P"),function(){return MD.IMBUEMENT_LEVEL[6]>=5}),new MD.Upgrade(77,"Nightmare Baggers","Multiplies mana gain by "+MD.uv.manamult+".","A haunting grind eminates through your camp.",n("12P"),function(){return MD.IMBUEMENT_LEVEL[7]>=5}),new MD.Upgrade(78,"Nightmare Titans","Multiplies mana gain by "+MD.uv.manamult+".","Nature's kiss is a little less green now.",n("14P"),function(){return MD.IMBUEMENT_LEVEL[8]>=5}),new MD.Upgrade(79,"Nightmare World Eaters","Multiplies mana gain by "+MD.uv.manamult+".","Just when you thought these things couldn't get any worse.",n("16P"),function(){return MD.IMBUEMENT_LEVEL[9]>=5}),new MD.Upgrade(80,"Nightmare Hive Queens","Multiplies mana gain by "+MD.uv.manamult+".","Writhing in the night.",n("18P"),function(){return MD.IMBUEMENT_LEVEL[10]>=5}),new MD.Upgrade(110,"Nightmare Wyverns","Multiplies mana gain by "+MD.uv.manamult+".","All is still, until a jagged shadow blots out the moon. And then all is dark.",n("1E"),function(){return MD.IMBUEMENT_LEVEL[11]>=5}),new MD.Upgrade(159,"Nightmare Neurochrysalises","Neurochrysalis mana production increases by "+MD.uv.neuropermage1+"% for each mage.","These things make my skin crawl.",{mana:n("50P")},function(){return MD.IMBUEMENT_LEVEL[12]>=5}),new MD.Upgrade(82,"Arcane Ants","Multiplies mana gain by "+MD.uv.manamult2+".","Your ants are beginning to emit an eerie blue light as they work.",{gold:n("250P"),mana:n("10M")},function(){return MD.IMBUEMENT_LEVEL[0]>=25}),new MD.Upgrade(83,"Arcane Woodpeckers","Multiplies mana gain by "+MD.uv.manamult2+".","Woodpeckers that can pierce through body and mind.",{gold:n("20P"),mana:n("1M")},function(){return MD.IMBUEMENT_LEVEL[1]>=25}),new MD.Upgrade(84,"Arcane Bloodhounds","Multiplies mana gain by "+MD.uv.manamult2+".","Watching. Always watching.",{gold:n("20P"),mana:n("1M")},function(){return MD.IMBUEMENT_LEVEL[2]>=25}),new MD.Upgrade(85,"Arcane Sandshrew","Multiplies mana gain by "+MD.uv.manamult2+".","Sandshrew learned Psychic! Wait... what?.",{gold:n("40P"),mana:n("2M")},function(){return MD.IMBUEMENT_LEVEL[3]>=25}),new MD.Upgrade(86,"Arcane Goblins","Multiplies mana gain by "+MD.uv.manamult2+".","Revenge courses through their mind without ceasing.",{gold:n("60P"),mana:n("3M")},function(){return MD.IMBUEMENT_LEVEL[4]>=25}),new MD.Upgrade(87,"Arcane Miners","Multiplies mana gain by "+MD.uv.manamult2+".","You are not among equals.",{gold:n("80P"),mana:n("4M")},function(){return MD.IMBUEMENT_LEVEL[5]>=25}),new MD.Upgrade(88,"Arcane Rock Golems","Multiplies mana gain by "+MD.uv.manamult2+".","Those that were since the beginning.",{gold:n("100P"),mana:n("5M")},function(){return MD.IMBUEMENT_LEVEL[6]>=25}),new MD.Upgrade(89,"Arcane Baggers","Multiplies mana gain by "+MD.uv.manamult2+".","No longer running off gasoline.",{gold:n("120P"),mana:n("6M")},function(){return MD.IMBUEMENT_LEVEL[7]>=25}),new MD.Upgrade(90,"Arcane Titans","Multiplies mana gain by "+MD.uv.manamult2+".","Silent guardians. Or are they silent threats?.",{gold:n("140P"),mana:n("8M")},function(){return MD.IMBUEMENT_LEVEL[8]>=25}),new MD.Upgrade(91,"Arcane World Eaters","Multiplies mana gain by "+MD.uv.manamult2+".","World eaters dig through space and time, consuming all.",{gold:n("160P"),mana:n("10M")},function(){return MD.IMBUEMENT_LEVEL[9]>=25}),new MD.Upgrade(92,"Arcane Hive Queens","Multiplies mana gain by "+MD.uv.manamult2+".","0_0.",{gold:n("180P"),mana:n("12M")},function(){return MD.IMBUEMENT_LEVEL[10]>=25}),new MD.Upgrade(111,"Arcane Wyverns","Multiplies mana gain by "+MD.uv.manamult2+".","An ominous blue glow is the last thing you'll ever see.",{gold:n("5E"),mana:n("250G")},function(){return MD.IMBUEMENT_LEVEL[11]>=25}),new MD.Upgrade(160,"Arcane Neurochrysalises","Neurochrysalis mana production increases by "+MD.uv.neuropermage2+"% for each mage.","Somethings is crawling in my brain...",{gold:n("5X"),mana:n("500P")},function(){return MD.IMBUEMENT_LEVEL[12]>=25}),new MD.Upgrade(118,"Eldritch Ants","Unlocks 10% of the alchemists potential.","It takes a steady hand to harness the power of an army.",{gold:n("250E"),"large ant":n("1G")},function(){return MD.IMBUEMENT_LEVEL[0]>=55}),new MD.Upgrade(119,"Eldritch Woodpeckers","Unlocks 10% of the alchemists potential.","Lend me your peck, peck, peck, power.",{gold:n("20E"),"large ant":n("100M")},function(){return MD.IMBUEMENT_LEVEL[1]>=55}),new MD.Upgrade(120,"Eldritch Bloodhounds","Unlocks 10% of the alchemists potential.","Lazy mutts.",{gold:n("20E"),"large ant":n("100M")},function(){return MD.IMBUEMENT_LEVEL[2]>=55}),new MD.Upgrade(121,"Eldritch Sandshrew","Unlocks 10% of the alchemists potential.","Pokeball go!!!.",{gold:n("40E"),"large ant":n("200M")},function(){return MD.IMBUEMENT_LEVEL[3]>=55}),new MD.Upgrade(122,"Eldritch Goblins","Unlocks 10% of the alchemists potential.","Channel their fury.",{gold:n("60E"),"large ant":n("300M")},function(){return MD.IMBUEMENT_LEVEL[4]>=55}),new MD.Upgrade(123,"Eldritch Miners","Unlocks 10% of the alchemists potential.","We obey.",{gold:n("80E"),"large ant":n("400M")},function(){return MD.IMBUEMENT_LEVEL[5]>=55}),new MD.Upgrade(124,"Eldritch Rock Golems","Unlocks 10% of the alchemists potential.","Power from stone.",{gold:n("100E"),"large ant":n("500M")},function(){return MD.IMBUEMENT_LEVEL[6]>=55}),new MD.Upgrade(125,"Eldritch Baggers","Unlocks 10% of the alchemists potential.","Engines of Destruction.",{gold:n("120E"),"large ant":n("600M")},function(){return MD.IMBUEMENT_LEVEL[7]>=55}),new MD.Upgrade(126,"Eldritch Titans","Unlocks 10% of the alchemists potential.","Such power.",{gold:n("140E"),"large ant":n("800M")},function(){return MD.IMBUEMENT_LEVEL[8]>=55}),new MD.Upgrade(127,"Eldritch World Eaters","Unlocks 10% of the alchemists potential.","Powering the new order.",{gold:n("160E"),"large ant":n("1G")},function(){return MD.IMBUEMENT_LEVEL[9]>=55}),new MD.Upgrade(128,"Eldritch Hive Queens","Unlocks 10% of the alchemists potential.","Spawning pure energy.",{gold:n("180E"),"large ant":n("1.2G")},function(){return MD.IMBUEMENT_LEVEL[10]>=55}),new MD.Upgrade(129,"Eldritch Wyverns","Unlocks 10% of the alchemists potential.","Overcharged.",{gold:n("5Z"),"large ant":n("10G")},function(){return MD.IMBUEMENT_LEVEL[11]>=55}),new MD.Upgrade(161,"Eldritch Neurochrysalises","Neurochrysalis mana production increases by "+MD.uv.neuropermage3+"% for each mage.","Slither.",{gold:n("5W"),"large ant":n("250G")},function(){return MD.IMBUEMENT_LEVEL[12]>=55}),new MD.Upgrade(223,"A Whole New World","Farms produce twice as much food.","Inspired by your kingdom's new mascot, farmers work extra hard!",{food:n("10M"),dragonscale:250},function(){return MD.hasDragon("Hatchling")},"dragon"),new MD.Upgrade(224,"Little Lizard","Your army strength is multiplied by 1.5.","Your soldiers have adopted a new hack and slash combat style, to great effect.",{food:n("10M"),dragonscale:1000},function(){return MD.hasDragon("Baby")},"dragon"),new MD.Upgrade(225,"First Steps","Population recovers at 1.5 times the speed.","Seeing an adorable baby dragon around has inspired your people to... you know.",{earth:n("1K"),dragonscale:2500},function(){return MD.hasDragon("Child")},"dragon"),new MD.Upgrade(226,"Teenage Rebellion","Goblins are much more likely to rebel, and yield greater rewards.","As if your goblins needed more motivation!",{fire:n("1K"),dragonscale:n("10K")},function(){return MD.hasDragon("Youngling")&&MD.hasUpgrade("Traitorous Goblins")},"dragon"),new MD.Upgrade(227,"Grasshopper","Barracks training costs 1/10th as much.","Let's all fight together!",{lightning:n("1K"),dragonscale:n("25K")},function(){return MD.hasDragon("Novice")},"dragon"),new MD.Upgrade(228,"Sensei","When sending students to the university, you get twice as many scholars.","We have no idea how this works, but it helps!",{adamantium:n("10M"),dragonscale:n("100K")},function(){return MD.hasDragon("Master")},"dragon"),new MD.Upgrade(229,"World of Flame","Fire essence is produced twice as quickly!","The fire shrine flares angrily at all times.",{fire:n("2.5K"),dragonscale:n("250K")},function(){return MD.hasDragon("Fire")},"dragon"),new MD.Upgrade(230,"Fury of Flame","The machinist now has an option to try and produce a mage each second.","About time we automated this sucker.",{fire:n("5K"),dragonscale:n("1M")},function(){return MD.hasDragon("Blazing")},"dragon"),new MD.Upgrade(231,"Volcanic Fury","Mages are twice as efficient at all tasks.","Your mages have learned the way of flame.",{fire:n("10K"),dragonscale:n("2.5M")},function(){return MD.hasDragon("Inferno")},"dragon"),new MD.Upgrade(232,"World of Water","Water essence is produced twice as quickly!.","The water shrine's vortex swirls faster and faster.",{water:n("2.5K"),dragonscale:n("250K")},function(){return MD.hasDragon("Water")},"dragon"),new MD.Upgrade(233,"Fury of the Sea","The machinist now has an option to try and produce an alchemist each second.","Creating creators... creatorception?",{water:n("5K"),dragonscale:n("1M")},function(){return MD.hasDragon("Aquatic")},"dragon"),new MD.Upgrade(234,"Eye of the Hurricane","Alchemist speed is doubled.","Your alchemists have learned the way of the sea.",{water:n("10K"),dragonscale:n("2.5M")},function(){return MD.hasDragon("Torrential")},"dragon"),new MD.Upgrade(235,"World of Earth","Earth essence is produced twice as quickly!.","The earth shrine is... particularly earthy.",{earth:n("2.5K"),dragonscale:n("250K")},function(){return MD.hasDragon("Earth")},"dragon"),new MD.Upgrade(236,"One with Nature","The machinist now has an option to try and produce a craftsman each second.","Crafting craftsmen... craftception?",{earth:n("5K"),dragonscale:n("1M")},function(){return MD.hasDragon("Terrene")},"dragon"),new MD.Upgrade(237,"Center of the Quake","Farms produce 8 times as much food.","Little known fact - crops grow much better when shaken daily.",{earth:n("10K"),dragonscale:n("2.5M")},function(){return MD.hasDragon("Terrestrial")},"dragon"),new MD.Upgrade(238,"World of Lightning","Lightning essence is produced twice as quickly!.","The lightning shrine sparks furiously in the night.",{lightning:n("2.5K"),dragonscale:n("250K")},function(){return MD.hasDragon("Lightning")},"dragon"),new MD.Upgrade(239,"Electric Current","Your gold per second is multiplied by 4.","Let's get charged!",{lightning:n("5K"),dragonscale:n("1M")},function(){return MD.hasDragon("Electric")},"dragon"),new MD.Upgrade(240,"Thunder of Death","Your mages do 8 times as much damage.","Boom! Boom! Zap! Argggg!",{lightning:n("10K"),dragonscale:n("2.5M")},function(){return MD.hasDragon("Thundering")},"dragon"),new MD.Upgrade(241,"King of the Sky","Rebel goblins give far more essence when killed.","Why does this thing help us again?",{spirit:1,dragonscale:n("5M")},function(){return MD.hasDragon("Imperial")},"dragon"),new MD.Upgrade(242,"Overwhelming Might","Bombing enemies is much cheaper and your military strength is doubled.","Let it rain.",{spirit:10,dragonscale:n("25M")},function(){return MD.hasDragon("Majestic")},"dragon"),new MD.Upgrade(243,"The Ultimate Prize","All resource gain is multiplied by 10.","I'm quickly running out of superlatives.",{spirit:25,dragonscale:n("100M")},function(){return MD.hasDragon("Eternal")},"dragon"),new MD.Upgrade(260,"Spirit Overcharge","Spirit essence gain is doubled.","Well this certainly cost enough.",{spirit:n("25K"),gold:n("1QQ")},function(){return MD.hasDragon("Eternal")&&MD.MAX_DRAGON_LEVEL>=n("1Z")},"dragon"),new MD.Upgrade(261,"Ancestral Might","Spirit essence gain is increased based on the highest dragon level achieved.","We stand on the shoulders of giants.",{spirit:n("1M"),gold:n("100MQQ")},function(){return MD.hasDragon("Eternal")&&MD.MAX_DRAGON_LEVEL>=n("1X")},"dragon")];MD.MageUpgrade=function(e,a,b,d,c){this.id=e;this.name=a;this.effect=b;if(typeof(d)=="number"){d={mana:d}}this.cost=d;this.unlock_function=c};MD.MAGE_UPGRADES=[new MD.MageUpgrade(0,"Enhanced Fireballs","Multiplies mage damage by "+MD.uv.level1mult+".",10,function(){return(true)}),new MD.MageUpgrade(1,"Lightning Torrent","Multiplies mage damage by "+MD.uv.level2mult+".",50,function(){return MD.hasMageUpgrade("Enhanced Fireballs")}),new MD.MageUpgrade(2,"Heaven's Fury","Multiplies mage damage by "+MD.uv.level3mult+".",150,function(){return MD.hasMageUpgrade("Lightning Torrent")}),new MD.MageUpgrade(9,"Insecticide","Multiplies mage damage by "+MD.uv.level4mult+".",500,function(){return MD.hasMageUpgrade("Heaven's Fury")&&MD.hasUpgrade("Embrace The Swarm")}),new MD.MageUpgrade(12,"Supercharged","Multiplies mage damage by "+MD.uv.level5mult+".",n("100K"),function(){return MD.hasMageUpgrade("Insecticide")&&MD.TOTAL_MANA>=n("50K")}),new MD.MageUpgrade(17,"FIRE!","Multiplies mage damage by "+MD.uv.level5mult+".",n("10M"),function(){return MD.hasMageUpgrade("Supercharged")}),new MD.MageUpgrade(25,"Secrets of Old","Multiplies mage damage by "+MD.uv.level6mult+".",n("50P"),function(){return MD.MAGE_TOWER_RESEARCH>=100}),new MD.MageUpgrade(29,"Ancient Wisdom","Multiplies mage damage by "+MD.uv.level7mult+".",n("500P"),function(){return MD.MAGE_TOWER_RESEARCH>=2500&&MD.hasMageUpgrade("Secrets of Old")}),new MD.MageUpgrade(3,"Advanced Delving Techniques","Each delving mage has a "+MD.uv.gemFindPerMage1+"% chance to find a gem each second.",25,function(){return(true)}),new MD.MageUpgrade(4,"Algorithmic Sparkle Isolation","Each deliving mage has a "+MD.uv.gemFindPerMage2+"% chance to find a gem each second.",50,function(){return MD.hasMageUpgrade("Advanced Delving Techniques")}),new MD.MageUpgrade(8,"Glowing Mind's Eye","Each deliving mage has a "+MD.uv.gemFindPerMage3+"% chance to find a gem each second.",150,function(){return MD.hasMageUpgrade("Algorithmic Sparkle Isolation")}),new MD.MageUpgrade(13,"Gems For Days!","Each delving mage has a "+MD.uv.gemFindPerMage4+"% chance to find a gem each second.",n("100K"),function(){return MD.hasMageUpgrade("Glowing Mind's Eye")&&MD.TOTAL_MANA>=n("50K")}),new MD.MageUpgrade(18,"EARTH!","Each delving mage has a "+MD.uv.gemFindPerMage5+"% chance to find a gem each second.",n("10M"),function(){return MD.hasMageUpgrade("Gems For Days!")}),new MD.MageUpgrade(26,"Crystal Underground","Mages find "+MD.uv.gemMult1+" gems where they once found just one.",n("100P"),function(){return MD.MAGE_TOWER_RESEARCH>=250}),new MD.MageUpgrade(30,"Penticity","Mages find "+MD.uv.gemMult2+" gems where they once found just one.",n("600P"),function(){return MD.MAGE_TOWER_RESEARCH>=5000&&MD.hasMageUpgrade("Crystal Underground")}),new MD.MageUpgrade(10,"Delving Mastery","Delving mages find "+MD.uv.level1mult+" times more gold.",200,function(){return MD.TOTAL_GEMS>100}),new MD.MageUpgrade(11,"Power Overwhelming","Delving mages find "+MD.uv.level2mult+" times more gold.",500,function(){return MD.TOTAL_GEMS>1000}),new MD.MageUpgrade(14,"Midas Reborn","Delving mages find "+MD.uv.level3mult+" times more gold.",n("100K"),function(){return MD.hasMageUpgrade("Power Overwhelming")&&MD.TOTAL_MANA>=n("50K")}),new MD.MageUpgrade(20,"WATER!","Delving mages find "+MD.uv.level4mult+" times more gold.",n("10M"),function(){return MD.hasMageUpgrade("Midas Reborn")}),new MD.MageUpgrade(27,"Delving Perfection","Delving mages find "+MD.uv.level5mult+" times more gold.",n("150P"),function(){return MD.MAGE_TOWER_RESEARCH>=500}),new MD.MageUpgrade(31,"Delving Transcendence","Delving mages find "+MD.uv.level6mult+" times more gold.",n("700P"),function(){return MD.MAGE_TOWER_RESEARCH>=10000&&MD.hasMageUpgrade("Delving Perfection")}),new MD.MageUpgrade(21,"Gettin' Lucky","Delving mages find more valuable gems.",n("4P"),function(){return MD.hasMageUpgrade("EARTH!")&&MD.ALCHEMISTS>=10}),new MD.MageUpgrade(22,"Lookin' Hard","Delving mages find even more valuable gems.",n("10P"),function(){return MD.hasMageUpgrade("Gettin' Lucky")&&MD.ALCHEMISTS>=25}),new MD.MageUpgrade(23,"Bein' Awesome","Delving mages find really valuable gems.",n("25P"),function(){return MD.hasMageUpgrade("Lookin' Hard")&&MD.ALCHEMISTS>=50}),new MD.MageUpgrade(24,"Old Pros","Delving mages find really, really valuable gems.",n("200P"),function(){return MD.hasMageUpgrade("Bein' Awesome")&&MD.ALCHEMISTS>=100}),new MD.MageUpgrade(5,"Magical Optimization","Each meditating mage is "+MD.uv.meditatelevel1+" times more efficient.",25,function(){return(true)}),new MD.MageUpgrade(6,"Spell of Focus","Each meditating mage is "+MD.uv.meditatelevel2+" times more efficient.",50,function(){return MD.hasMageUpgrade("Magical Optimization")}),new MD.MageUpgrade(15,"Current of Nature","Each meditating mage is "+MD.uv.meditatelevel3+" times more efficient.",n("100K"),function(){return MD.hasMageUpgrade("Spell of Focus")&&MD.TOTAL_MANA>=n("50K")}),new MD.MageUpgrade(16,"WIND!","Each meditating mage is "+MD.uv.meditatelevel4+" times more efficient.",n("10M"),function(){return MD.hasMageUpgrade("Current of Nature")}),new MD.MageUpgrade(28,"Neurofeedback","Meditating mages gain "+MD.uv.neuropercent1+"% of the mana rate of a Neurochrysalis.",n("200P"),function(){return MD.MAGE_TOWER_RESEARCH>=1000}),new MD.MageUpgrade(32,"Neurobacklash","Meditating mages gain "+MD.uv.neuropercent2+"% of the mana rate of a Neurochrysalis.",n("800P"),function(){return MD.MAGE_TOWER_RESEARCH>=15000&&MD.hasMageUpgrade("Neurofeedback")}),new MD.MageUpgrade(7,"Elemental Pickaxe","Your pickaxe efficiency and damage is multiplied by "+MD.uv.elementalpick+".",1000,function(){return MD.hasMageUpgrade("Heaven's Fury")&&MD.hasMageUpgrade("Glowing Mind's Eye")&&MD.hasMageUpgrade("Spell of Focus")&&MD.MAGES>=40}),new MD.MageUpgrade(19,"HEART!","By your powers combined, Captain Planet will double your pick efficiency for every "+MD.uv.numPerDouble+" mages (up to "+20*MD.uv.numPerDouble+").",n("25M"),function(){return MD.hasMageUpgrade("FIRE!")&&MD.hasMageUpgrade("WIND!")&&MD.hasMageUpgrade("WATER!")&&MD.hasMageUpgrade("EARTH!")}),new MD.MageUpgrade(33,"Crystallizing Influence","Your mages have learned to influence the laws of alchemy, allowing ants to be converted into great gems in place of normal.",n("10E"),function(){return MD.MAGE_TOWER_RESEARCH>=30000}),new MD.MageUpgrade(34,"Ruby Affinity","Each delving mage is twice as likely to find gems each second.",n("1X"),function(){return MD.hasDragon("Inferno")}),new MD.MageUpgrade(35,"Sapphire Affinity","Each delving mage is twice as likely to find gems each second.",n("1X"),function(){return MD.hasDragon("Torrential")}),new MD.MageUpgrade(36,"Emerald Affinity","Each delving mage is twice as likely to find gems each second.",n("1X"),function(){return MD.hasDragon("Terrestrial")}),new MD.MageUpgrade(37,"Topaz Affinity","Each delving mage is twice as likely to find gems each second.",n("1X"),function(){return MD.hasDragon("Thundering")}),new MD.MageUpgrade(38,"Diamond Affinity","Mages now find more gems for each sacrificed goblin.",n("10X"),function(){return MD.hasMageUpgrade("Ruby Affinity")&&MD.hasMageUpgrade("Sapphire Affinity")&&MD.hasMageUpgrade("Emerald Affinity")&&MD.hasMageUpgrade("Topaz Affinity")})];MD.OracleTeaching=function(a,c,b){this.name=a;this.text=c;this.complete_function=b};MD.ORACLE_TEACHINGS=[new MD.OracleTeaching("Wisdom of the Magi","It is rumored that mages of great power can be hired... but you lack gold.",function(){return MD.MAGES>=1}),new MD.OracleTeaching("True Potential","Mages are capable of so much more than fighting - but they cannot work alone, consider hiring more.",function(){return MD.MAGES>=5}),new MD.OracleTeaching("Pick Enhancement","You notice your pickaxe has strange slots - perhaps finding more gems will help you learn what they are for.",function(){return MD.craftingAvailable()}),new MD.OracleTeaching("Bigger and Better","Greater beasts exist in this world than those you've seen. More gold is the key.",function(){return MD.TOTAL_GOLD>n("300G")}),new MD.OracleTeaching("Financing Insects","Rumor holds that great insects roam distant lands, followed by swarms of ants. Perhaps they would appear if you had more gold.",function(){return MD.TOTAL_GOLD>n("50T")}),new MD.OracleTeaching("Infestation","Rumor holds that great insects roam distant lands, followed by swarms of ants. Perhaps hiring more ants would attract some.",function(){return MD.HIRELINGS_OWNED[0]>=80}),new MD.OracleTeaching("Arachnophobia","The goblins seem to be recruiting reinforcements. Perhaps they'll see you as a worthy target once you acquire more ants.",function(){return MD.HIRELINGS_OWNED[0]>=n("3M")}),new MD.OracleTeaching("Goblin Overkill","The goblins seem to be recruiting reinforcements. Perhaps they'll see you as a worthy target once you kill more goblins.",function(){return MD.hasUpgrade("Goblin's Bane")}),new MD.OracleTeaching("Why?","How do you not have more mages? What are you doing? Buy some!",function(){return MD.MAGES>=10}),new MD.OracleTeaching("Inner Darkness","The mages appear to be growing... darker with each passing moment. Every second they spend fully charged brings them closer to their goal.",function(){return MD.MAGE_MAX_TIME>=1800}),new MD.OracleTeaching("Arcane Magic","All living things can learn to create mana, but only if they're imbued with enough power. Keep going.",function(){return MD.getManaMultiplier()>=n("4M")}),new MD.OracleTeaching("From the Depths","It is said that with enough mana, mages can summon powerful creatures to do their bidding.",function(){return MD.MANA>=n("1G")}),new MD.OracleTeaching("Physics is Overrated","Mages aren't the only magic users around. Perhaps if you imbue your servants with more power something else will show up.",function(){return MD.getAlchemistPotential()>0}),new MD.OracleTeaching("The Ants Go Marching","You need a few alchemists before they really figure out what's what.",function(){return MD.ALCHEMISTS>=5}),new MD.OracleTeaching("Sandshrew Swarm","Word on the street is that Sandshrews fetch a high price. If you get 1000, maybe you'll attract a buyer.",function(){return MD.hasUpgrade("Team Rocket Buyer")}),new MD.OracleTeaching("Hive Expansion","I feel like your 200th Hive Queen will be a real breakthrough.",function(){return MD.HIRELINGS_OWNED[10]>=200}),new MD.OracleTeaching("Strange Compulsion","I have a strange feeling that you'd benefit from far more Bagger 288s.",function(){return MD.HIRELINGS_OWNED[7]>=6750}),new MD.OracleTeaching("Breaking Ground","All champions of industry have to start somewhere. Lay some dirt and see what you can build.",function(){return MD.CONSTRUCT_LOCATIONS.indexOf(0)!=-1}),new MD.OracleTeaching("Rock Out","The age of the bagger has ended. Turn your attention to golems of rock, and you shall be rewarded... with rock.",function(){return MD.HIRELINGS_OWNED[6]>=n("12.34K")}),new MD.OracleTeaching("Wyvern Mount","Great quantities of stone and gold are required to build the next structure.",function(){return MD.TOTAL_GOLD>n("1W")&&MD.TOTAL_STONE>n("100M")}),new MD.OracleTeaching("Wyvern Mount","Wyverns must fill the sky before one can hope to build them a home.",function(){return MD.HIRELINGS_OWNED[11]>=200}),new MD.OracleTeaching("Tower of the Magi","Your mages wish for a place to call home - but they lack mana.",function(){return MD.TOTAL_MANA>n("1E")}),new MD.OracleTeaching("Tower of Stones","Your mages wish for a place to call home - but they lack stone.",function(){return MD.TOTAL_STONE>n("250M")}),new MD.OracleTeaching("Full House","Your mages wish for a place to call home - but you need more of them first.",function(){return MD.MAGES>=280}),new MD.OracleTeaching("Kingdom","You wish to build monuments to show the lands your strength... perhaps you need more iron to build them with?.",function(){return MD.TOTAL_IRON>1000}),new MD.OracleTeaching("Steel","You have a feeling that perhaps iron and coal are not the best you can forge, but your mages haven't yet discovered how.",function(){return MD.MAGE_TOWER_RESEARCH>=15000}),new MD.OracleTeaching("More Statues","Your mages have learned much - but you need more statues to implement your findings.",function(){return MD.CONSTRUCT_LEVELS[4]>=5}),new MD.OracleTeaching("Steel For Civilization","You are on the edge of a great civilization, and it will be founded on steel.",function(){return MD.TOTAL_STEEL>=n("2.5K")}),new MD.OracleTeaching("Where's the People?","Your kingdom is kind of quiet, given that every living soul is working in the mine.",function(){return MD.POPULATION>0}),new MD.OracleTeaching("To War!","Throughout history, great empires have had one thing in common. Going into other lands and messing people up. Perhaps with a bigger population they would find the courage to fight?",function(){return MD.getPopulationMax()>=50}),new MD.OracleTeaching("Technology","All great armies need weapons, and when your enemies grow too powerful, other strategies might come in handy. Win a few more campaigns and see what you learn.",function(){return MD.CAMPAIGNS_WON>=5}),new MD.OracleTeaching("Education","A great society needs more than just killing, but learning as well. Perhaps a rare reward from campaigns will get you started.",function(){return MD.TOTAL_ADAMANTIUM>0}),new MD.OracleTeaching("Reverse","You should probably hire a lot more goblins.",function(){return MD.HIRELINGS_OWNED[4]>=n("20M")||MD.hasUpgrade("Have Not")}),new MD.OracleTeaching("Reverse 2","Almost there - a few more goblins.",function(){return MD.HIRELINGS_OWNED[4]>=n("25M")||MD.hasUpgrade("Have Not")}),new MD.OracleTeaching("Reverse 3","You have enough goblins... you're just not killing them fast enough. Why not level up your smelting pit a bit more?.",function(){return MD.CONSTRUCT_LEVELS[5]>=20||MD.hasUpgrade("Have Not")}),new MD.OracleTeaching("Adamantium Overload","Your adamantium supplies are a little low. I bet if you had a whole bunch of wyverns, they could find some more.",function(){return MD.hasUpgrade("Adamantium Affinity")}),new MD.OracleTeaching("Farm 1","Some days you wake up and just think... I need more land. You can farm it once you've won it.",function(){return MD.CAMPAIGNS_WON>=100}),new MD.OracleTeaching("Farm 2","More land! More!! To grow food for you armies.",function(){return MD.CAMPAIGNS_WON>=500}),new MD.OracleTeaching("Hunting Time","I hear there are some new farmlands around. Maybe you can grow something interesting on them...",function(){return MD.TOTAL_FLAX>0}),new MD.OracleTeaching("Dragons","You've acquired a sudden interest in dragons. If you had more mages, they could teach you about them.",function(){return MD.MAGES>=400}),new MD.OracleTeaching("Dragons 2","Your mages have suggested that you could share in the power of dragons... but until you win more battles, they won't respect you.",function(){return MD.CAMPAIGNS_WON>=500}),new MD.OracleTeaching("Fire Shrine","You've begun to understand to strength of dragons of flame - build their shrine!",function(){return MD.hasConstruct("Fire Shrine")}),new MD.OracleTeaching("Dragons 3","You have learned to acquire the power of flame. But that isn't all - you need more alchemists.",function(){return MD.ALCHEMISTS>=150}),new MD.OracleTeaching("Dragons 4","Your mages have suggested that you could learn more of the dragon's power... but until you win more battles, they won't respect you.",function(){return MD.CAMPAIGNS_WON>=1000}),new MD.OracleTeaching("Water Shrine","You've begun to understand to strength of dragons of the sea - build their shrine!",function(){return MD.hasConstruct("Water Shrine")}),new MD.OracleTeaching("Machinist","Some of your brightest minds think you could actually build mages... they need some water essence for their experiments.",function(){return MD.TOTAL_WATER_ESSENCE>=5}),new MD.OracleTeaching("Dragons 5","The earthen dragons have much to offer... but you need to do more manual mining. There are also rumors that if you get enough woodpeckers, they'll click for you...",function(){return MD.totalClicks()>=n("25K")}),new MD.OracleTeaching("Dragons 6","Your mages have suggested that you could learn more of the dragon's power... but until you win more battles, they won't respect you.",function(){return MD.CAMPAIGNS_WON>=2000}),new MD.OracleTeaching("Earth Shrine","You've begun to understand to strength of dragons of earth - build their shrine!",function(){return MD.hasConstruct("Earth Shrine")}),new MD.OracleTeaching("Graveyard","You think you might be able to automate attacking in some way... but you need to lose more men to learn more.",function(){return MD.SOLDIERS_LOST>=10000}),new MD.OracleTeaching("Dragons 7","The most powerful dragons of the sky have taken interest in you... but you are lacking gold.",function(){return MD.TOTAL_GOLD>=n("1R")}),new MD.OracleTeaching("Dragons 8","Your mages have suggested that you could learn more of the dragon's power... but until you win more battles, they won't respect you.",function(){return MD.CAMPAIGNS_WON>=3000}),new MD.OracleTeaching("Lightning Shrine","You've begun to understand to strength of dragons of lightning - build their shrine!",function(){return MD.hasConstruct("Lightning Shrine")}),new MD.OracleTeaching("Egg","You have finally learned enough to actually raise a dragon. Why not build a nest?",function(){return MD.hasConstruct("Dragon Nest")}),new MD.OracleTeaching("Baby","Food makes a dragon grow... but it needs a strong earth shrine to learn to walk.",function(){return MD.CONSTRUCT_LEVELS[19]>=25}),new MD.OracleTeaching("Child","Food makes a dragon grow... but it needs a strong fire shrine to learn to breathe.",function(){return MD.CONSTRUCT_LEVELS[15]>=25}),new MD.OracleTeaching("Youngling","Food makes a dragon grow... but it needs a strong lightning shrine to learn to soar.",function(){return MD.CONSTRUCT_LEVELS[21]>=25}),new MD.OracleTeaching("Novice","Food makes a dragon grow... but it needs many brothers to learn to hunt.",function(){return MD.HIRELINGS_OWNED[11]>=n("100M")}),new MD.OracleTeaching("Master","Food makes a dragon grow... but it needs a great deal of essence to understand itself.",function(){return MD.totalEssence()>=n("25K")}),new MD.OracleTeaching("Hireling Upgrades","Rumor speaks of great rewards for having one trillion of a hireling. Perhaps it's time to investigate.",function(){return MD.hirelingsGreater(n("1T"))}),new MD.OracleTeaching("Split","Your dragon has chosen a path... but it needs a strong shrine to achieve its potential.",function(){return MD.CONSTRUCT_LEVELS[15]>=100||MD.CONSTRUCT_LEVELS[17]>=100||MD.CONSTRUCT_LEVELS[19]>=100||MD.CONSTRUCT_LEVELS[21]>=100}),new MD.OracleTeaching("Imperial","Your dragon is mighty beyond belief... but it seeks the spirit of masters of all the elements.",function(){return MD.totalHirelings()>=n("20T")&&MD.TOTAL_SPIRIT_ESSENCE>=10&&MD.hasUpgrade("Volcanic Fury")&&MD.hasUpgrade("Eye of the Hurricane")&&MD.hasUpgrade("Center of the Quake")&&MD.hasUpgrade("Thunder of Death")}),new MD.OracleTeaching("Majestic","Your dragon is mighty beyond belief... but it seeks a great population, military triumph, and great spirit.",function(){return MD.getPopulationMax()>=n("25K")&&MD.CAMPAIGNS_WON>=n("10K")&&MD.TOTAL_SPIRIT_ESSENCE>=100}),new MD.OracleTeaching("Eternal","Your dragon is mighty beyond belief... but it seeks great essence and powerful buildings.",function(){return MD.totalEssence()>=n("1G")&&MD.TOTAL_SPIRIT_ESSENCE>=n("1K")&&MD.totalConstructLevel()>=2500})];MD.Structure=function(f,b,d,e,a,c){this.id=f;this.name=b;this.desc=d;this.cost=e;this.multiple_allowed=a;this.unlock_function=c};MD.STRUCTURES=[new MD.Structure(0,"Alchemist's Lair","Provides a home for powerful alchemists seeking to further their trade.",{majestic:2,mana:n("100G"),gold:n("10Y")},false,function(){return MD.getAlchemistPotential()>0})];MD.Construct=function(g,a,e,f,b,d,c){this.id=g;this.name=a;this.desc=e;this.cost=f;this.upgrade_cost=b;this.unlock_function=d;this.image=c};MD.CONSTRUCTS=[new MD.Construct(0,"Auto-Smithy","Allows you to automatically craft gems to a particular level.",{majestic:1000,gold:n("10X")},{stone:n("100M"),coal:0.25},function(){return MD.hasUpgrade("Precious Resources")},["./resources/minedefense/autosmith.png"]),new MD.Construct(1,"Quarry","Allows you to mine various subterranean substances in addition to gold.",{majestic:2000,gold:n("50X")},{dirt:n("250M")},function(){return MD.hasUpgrade("The Wheel Turns")},["./resources/minedefense/quarry.png"]),new MD.Construct(2,"Wyvern-Mount","Provides a comforting mountain of gold for your wyverns to rest and grow stronger.",{majestic:2500,gold:n("1W"),stone:n("250M")},{stone:n("100M"),gold:n("1W")},function(){return MD.TOTAL_GOLD>n("1W")&&MD.TOTAL_STONE>n("100M")&&MD.HIRELINGS_OWNED[11]>=200},["./resources/minedefense/dragonmount0.png","./resources/minedefense/dragonmount1.png","./resources/minedefense/dragonmount2.png","./resources/minedefense/dragonmount3.png"]),new MD.Construct(3,"Mage Tower","A great tower where Mages from across the world can hone their art.",{gold:n("1W"),stone:n("500M")},{},function(){return MD.TOTAL_MANA>n("1E")&&MD.TOTAL_STONE>n("250M")&&MD.MAGES>=280},["./resources/minedefense/magetower.png"]),new MD.Construct(4,"Regal Statue","A majestic statue to place throughout the land and remind them of your power.",{gold:n("2.5W"),iron:n("100K")},{iron:n("75K"),miner:50},function(){return MD.TOTAL_IRON>=1000},["./resources/minedefense/regalstatue.png"]),new MD.Construct(5,"Smelting Pit","A dark place where nightmarish goblins toil day and night over vats of hot metal.",{stone:n("1G"),goblin:n("50K")},{stone:n("1G"),goblin:n("50K")},function(){return MD.hasUpgrade("Secret of Barad-dur")},["./resources/minedefense/smeltingpit.png"]),new MD.Construct(6,"Exchange Market","A bustling market filled with exotic food and rare minerals.",{steel:n("1K"),gold:n("50W")},{},function(){return MD.TOTAL_STEEL>0},["./resources/minedefense/exchangehouse.png"]),new MD.Construct(7,"Habitation","A few crude huts sitting in a field. For now.",{steel:n("5K"),gold:n("100W")},{steel:n("1K")},function(){return MD.TOTAL_STEEL>=n("2.5K")},["./resources/minedefense/habitation0.png","./resources/minedefense/habitation1.png","./resources/minedefense/habitation2.png","./resources/minedefense/habitation3.png"]),new MD.Construct(8,"Farm","A lush field of... something.",{steel:n("2K"),gold:n("10W")},{steel:10,stone:n("1K"),coal:100},function(){return MD.TOTAL_STEEL>=n("2.5K")},["./resources/minedefense/farm0.png","./resources/minedefense/farm1.png","./resources/minedefense/farm2.png"]),new MD.Construct(9,"Barracks","Time for war.",{steel:n("5K"),food:n("25K")},{steel:n("5K"),food:n("1K"),gold:n("1V")},function(){return MD.getPopulationMax()>=50},["./resources/minedefense/barracks.png"]),new MD.Construct(10,"University","Build the World.",{steel:n("25K"),adamantium:1},{},function(){return MD.TOTAL_ADAMANTIUM>0},["./resources/minedefense/university.png"]),new MD.Construct(11,"Blacksmith","Fight!",{steel:n("250K"),adamantium:3},{adamantium:0.3,steel:n("25K")},function(){return MD.CAMPAIGNS_WON>=5},["./resources/minedefense/blacksmith.png"]),new MD.Construct(12,"Expanded Farm","A lush field of... something.",{steel:n("1M"),adamantium:10},{steel:10,stone:n("1K"),coal:100},function(){return MD.CAMPAIGNS_WON>=100},["./resources/minedefense/farm0.png","./resources/minedefense/farm1.png","./resources/minedefense/farm2.png"]),new MD.Construct(13,"Vast Farm","A lush field of... something.",{steel:n("5M"),adamantium:25},{steel:10,stone:n("1K"),coal:100},function(){return MD.CAMPAIGNS_WON>=500},["./resources/minedefense/farm0.png","./resources/minedefense/farm1.png","./resources/minedefense/farm2.png"]),new MD.Construct(14,"Fletcher","Allows you to train dragonhunters.",{flax:100},{flax:1000},function(){return MD.TOTAL_FLAX>0&&MD.hasUpgrade("Adamantium Affinity")},["./resources/minedefense/fletcher.png"]),new MD.Construct(15,"Fire Shrine","Allows you to receive the gifts of fire.",{dragonscale:1000,adamantium:n("25K"),gold:n("1V")},{dragonscale:50,gold:n("10V")},function(){return MD.CAMPAIGNS_WON>=500&&MD.MAGES>=400},["./resources/minedefense/fireshrine.png"]),new MD.Construct(16,"Administration Building","For every resource in your kingdom, provides a sense of whether it is increasing or decreasing.",{gold:n("100W"),stone:n("10G")},{},function(){return MD.hasUpgrade("Obsessive Recordkeeping")},["./resources/minedefense/administration.png"]),new MD.Construct(17,"Water Shrine","Allows you to receive the gifts of water.",{dragonscale:2500,adamantium:n("50K"),gold:n("50V"),fire:100},{dragonscale:125,gold:n("500V")},function(){return MD.CAMPAIGNS_WON>=1000&&MD.ALCHEMISTS>=150&&MD.TOTAL_FIRE_ESSENCE>0},["./resources/minedefense/watershrine.png"]),new MD.Construct(18,"Machinist","Allows you to construct various things from rare resources.",{dragonscale:5000,fire:10,water:10},{},function(){return MD.hasConstruct("Water Shrine")&&MD.TOTAL_WATER_ESSENCE>=5},["./resources/minedefense/machinist.png"]),new MD.Construct(19,"Earth Shrine","Allows you to receive the gifts of earth.",{dragonscale:5000,adamantium:n("100K"),gold:n("1U"),water:100},{dragonscale:250,gold:n("10U")},function(){return MD.CAMPAIGNS_WON>=2000&&MD.totalClicks()>=n("25K")&&MD.TOTAL_WATER_ESSENCE>0},["./resources/minedefense/earthshrine.png"]),new MD.Construct(20,"Graveyard","A resting place for those who fall in your campaigns.",{population:100,adamantium:500,stone:n("10G")},{},function(){return MD.CAMPAIGNS_WON>=100&&MD.SOLDIERS_LOST>=n("5K")},["./resources/minedefense/graveyard.png"]),new MD.Construct(21,"Lightning Shrine","Allows you to receive the gifts of lightning.",{dragonscale:n("10K"),adamantium:n("250K"),gold:n("10U"),earth:100},{dragonscale:500,gold:n("100U")},function(){return MD.CAMPAIGNS_WON>=3000&&MD.TOTAL_GOLD>=n("1R")&&MD.TOTAL_EARTH_ESSENCE>0},["./resources/minedefense/lightningshrine.png"]),new MD.Construct(22,"Dragon Nest","Allows you to spawn a dragon.",{dragonscale:n("100K"),earth:100,fire:100,water:100,lightning:100},{},function(){return MD.TOTAL_LIGHTNING_ESSENCE>0},["./resources/minedefense/dragonnest.png"]),new MD.Construct(23,"Dimensional Rift","Allows you to sacrifice a dragon.",{dragonscale:n("1M"),earth:100,fire:100,water:100,lightning:100},{},function(){return MD.hasDragon("Novice")},["./resources/minedefense/dimensionalrift.png"]),new MD.Construct(24,"Arcaneum","Allows you to use spirit essence to boost resource gain.",{earth:100,fire:100,water:100,lightning:100},{gold:n("1KQQ")},function(){return MD.TOTAL_SPIRIT_ESSENCE>0},["./resources/minedefense/arcaneum.png"])];MD.AlchRecipe=function(f,b,e,d,c,a){this.base_res=f;this.final_res=b;this.cost=e;this.yield_amt=d;this.amount=c;this.unlock_condition=a};MD.ALCH_RECIPES=[new MD.AlchRecipe("gold","mana",n("1M"),1,n("25M"),function(){return true}),new MD.AlchRecipe("large ant","normal",n("30K"),1,1,function(){return MD.ALCHEMISTS>=5}),new MD.AlchRecipe("normal","woodpecker",100,1,2,function(){return MD.hasUpgrade("Jeweled Beak")}),new MD.AlchRecipe("normal","bloodhound",400,1,2,function(){return MD.hasUpgrade("Jeweled Eyes")}),new MD.AlchRecipe("great","sandshrew",80,1,2,function(){return MD.hasUpgrade("Bedazzled Pokeballs")}),new MD.AlchRecipe("great","goblin",200,1,2,function(){return MD.hasUpgrade("Gleaming Eyes")}),new MD.AlchRecipe("flawless","miner",125,1,2,function(){return MD.hasUpgrade("Crystal Axes")}),new MD.AlchRecipe("flawless","rock golem",100,1,2,function(){return MD.hasUpgrade("Crystalline Hands")}),new MD.AlchRecipe("flawless","bagger 288",75,1,2,function(){return MD.hasUpgrade("Diamond-Studded Treads")}),new MD.AlchRecipe("perfect","titan of earth",20,1,2,function(){return MD.hasUpgrade("Diamond Hearts")}),new MD.AlchRecipe("majestic","world eater",7,1,2,function(){return MD.hasUpgrade("Crystal Shard Eyes")}),new MD.AlchRecipe("majestic","hive queen",27,1,2,function(){return MD.hasUpgrade("Diamond-Spiked Eggs")}),new MD.AlchRecipe("majestic","wyvern",104,1,2,function(){return MD.hasUpgrade("Rhenium Heart")}),new MD.AlchRecipe("dirt","mana",n("10M"),n("1P"),1,function(){return MD.TOTAL_DIRT>=n("500M")}),new MD.AlchRecipe("majestic","neurochrysalis",10033,1,2,function(){return MD.hasUpgrade("Neurological Enlightenment")}),new MD.AlchRecipe("water","dragonscale",0.5,1,1,function(){return MD.hasConstruct("Water Shrine")}),new MD.AlchRecipe("sandshrew","gold",0.1,n("0.8Y"),1,function(){return MD.hasUpgrade("Team Rocket Buyer")}),new MD.AlchRecipe("majestic","dragon hunter",430077,1,2,function(){return MD.hasUpgrade("Human Fusion")})];MD.ExchangeRate=function(e,c,b,d,a){this.base_res=e;this.base_amt=c;this.final_res=b;this.final_amt=d;this.unlock_condition=a};MD.EXCHANGE_RATES=[new MD.ExchangeRate("great",360,"majestic",1,function(){return true}),new MD.ExchangeRate("dirt",3,"stone",4,function(){return MD.TOTAL_DIRT>0&&MD.TOTAL_STONE>0}),new MD.ExchangeRate("stone",1000,"iron",1,function(){return MD.TOTAL_STONE>0&&MD.TOTAL_IRON>0}),new MD.ExchangeRate("iron",100,"coal",5,function(){return MD.TOTAL_COAL>0&&MD.TOTAL_IRON>0}),new MD.ExchangeRate("iron",250,"steel",1,function(){return MD.TOTAL_IRON>0&&MD.TOTAL_STEEL>0}),new MD.ExchangeRate("steel",1,"food",15,function(){return MD.TOTAL_STEEL>0&&MD.TOTAL_FOOD>0}),new MD.ExchangeRate("flax",50,"adamantium",1,function(){return MD.TOTAL_ADAMANTIUM>0&&MD.TOTAL_FLAX>0}),new MD.ExchangeRate("adamantium",100,"flax",1,function(){return MD.TOTAL_ADAMANTIUM>0&&MD.TOTAL_FLAX>0})];MD.Dragon=function(h,c,d,f,b,e,g,a){this.id=h;this.name=c;this.power=d;this.description=f;this.progressions=b;this.price=e;this.base_essence=g;this.unlock_condition=a};MD.DRAGONS=[new MD.Dragon(0,"Egg","This dragon doesn't do a whole lot... but you do seem to find more stone.","A large egg sits in a nest of dirt and straw. Perhaps it will hatch if you feed it.",[1],{food:n("1M")},0,function(){return MD.hasConstruct("Dragon Nest")}),new MD.Dragon(1,"Hatchling","Food production is slightly increased with this guy around.","A small green dragon has hatched from the egg. It doesn't seem to be good for much, but boy can it eat!",[2],{food:n("1M"),dragonscale:10},1000,function(){return true}),new MD.Dragon(2,"Baby","Damage taken to your wall is reduced with the baby around.","Aww... it's like a sweet little baby lizard... with razor sharp claws and a rock solid carapace.",[3],{food:n("1M"),earth:0.01},n("10K"),function(){return MD.CONSTRUCT_LEVELS[19]>=25}),new MD.Dragon(3,"Child","Regal statue rewards are increased due to dragon scouting.","Your dragon is beginning to stretch its wings. It's now almost as large as the wyverns.",[4],{food:n("1M"),fire:0.001},n("100K"),function(){return MD.CONSTRUCT_LEVELS[15]>=25}),new MD.Dragon(4,"Youngling","The reward for killing goblins is much better with this dragon around.","Ah, the teenage years. Your dragon is a tad rebellious... and who are you to argue with a 20,000 pound dragon?.",[5],{food:n("1M"),lightning:0.0001},n("1M"),function(){return MD.CONSTRUCT_LEVELS[21]>=25}),new MD.Dragon(5,"Novice","Your soldiers fight much better with the novice dragon at their head.","No longer a child, your dragon fights with precision and strength, with claw and flame.",[6],{population:0.01,adamantium:5},n("10M"),function(){return MD.HIRELINGS_OWNED[11]>=n("100M")}),new MD.Dragon(6,"Master","Your soldiers fight with great vigor with this mighty beast soaring overhead.","You have learned that a dragon has its own choices to make in life. Choose wisely how you nurture it, for its future is at stake.",[7,10,13,16],{},n("100M"),function(){return MD.totalEssence()>=n("25K")}),new MD.Dragon(7,"Fire","Fire essence gain is increased with this dragon around.","Your dragon begins to take on a distinct red hue, and his flames melts steel instantly.",[8],{mana:n("1G"),fire:0.00005},n("1G"),function(){return MD.MAGES>=500&&MD.CONSTRUCT_LEVELS[15]>=50}),new MD.Dragon(8,"Blazing","Fire essence gain is greatly increased with this dragon around","Flames ripple up and down the great red dragon, many hirelings have died simply from being nearby.",[9],{mana:n("10G"),fire:0.00001},n("10G"),function(){return MD.MAGES>=600&&MD.CONSTRUCT_LEVELS[15]>=75}),new MD.Dragon(9,"Inferno","Fire essence gain is supercharged with this dragon around","A nightmarish beast of flames, almost too bright to look upon, your dragon has reached a mastery of flame never before seen.",[19],{mana:n("100G"),fire:0.0000025},n("100G"),function(){return MD.MAGES>=700&&MD.CONSTRUCT_LEVELS[15]>=100}),new MD.Dragon(10,"Water","Water essence gain is increased with this dragon around.","Your dragon has taken poorly to the transition, cuts appear in its skin, and the flames it spits are damp and weak.",[11],{"hive queen":1,water:0.00005},n("1G"),function(){return MD.ALCHEMISTS>=200&&MD.CONSTRUCT_LEVELS[17]>=50}),new MD.Dragon(11,"Aquatic","Water essence gain is greatly increased with this dragon around","The cuts have revealed themselves as a functioning set of gills - your dragon sweeps freely through the seas, and breathes boiling hot steam when angered.",[12],{wyvern:1,water:0.00001},n("10G"),function(){return MD.ALCHEMISTS>=250&&MD.CONSTRUCT_LEVELS[17]>=75}),new MD.Dragon(12,"Torrential","Water essence gain is supercharged with this dragon around","A true master of the storm, your dragon's wings creates small typhoons and its enemies fall as crumpled husks as the water is drained from them.",[19],{neurochrysalis:0.1,water:0.0000025},n("100G"),function(){return MD.ALCHEMISTS>=300&&MD.CONSTRUCT_LEVELS[17]>=100}),new MD.Dragon(13,"Earth","Earth essence gain is increased with this dragon around.","Breathing fire takes a backseat as your dragon seems to put all of its energy into becoming a stone.",[14],{dirt:n("1M"),stone:n("1M"),earth:0.00005},n("1G"),function(){return MD.totalClicks()>=n("25K")&&MD.CONSTRUCT_LEVELS[19]>=50}),new MD.Dragon(14,"Terrene","Earth essence gain is greatly increased with this dragon around","Your dragon is now many times larger than the fiercest earth titan, and crevices snake out from its footfalls.",[15],{iron:n("100K"),steel:n("1K"),earth:0.00001},n("10G"),function(){return MD.totalClicks()>=n("50K")&&MD.CONSTRUCT_LEVELS[19]>=75}),new MD.Dragon(15,"Terrestrial","Earth essence gain is supercharged with this dragon around","Your dragon becomes long and narrow like a massive world eater, churning through the earth and leaving trails of molten lave in its wake.",[19],{adamantium:25,earth:0.0000025},n("100G"),function(){return MD.totalClicks()>=n("100K")&&MD.CONSTRUCT_LEVELS[19]>=100}),new MD.Dragon(16,"Lightning","Lightning essence gain is increased with this dragon around.","Lightning replaces fire when your dragon roars, and sparks ricochet across the walls when it passes metal buildings.",[17],{gold:n("1X"),lightning:0.00005},n("1G"),function(){return MD.TOTAL_GOLD>=n("1S")&&MD.CONSTRUCT_LEVELS[21]>=50}),new MD.Dragon(17,"Electric","Lightning essence gain is greatly increased with this dragon around","In the peak of its rage, your dragon seems to blur and vibrate, as if it is actually formed of lightning.",[18],{gold:n("100W"),lightning:0.00001},n("10G"),function(){return MD.TOTAL_GOLD>=n("1R")&&MD.CONSTRUCT_LEVELS[21]>=75}),new MD.Dragon(18,"Thundering","Lightning essence gain is supercharged with this dragon around","Thunder falls continuously for miles around the dragon, and anything standing too close is disintegrated in a flash.",[19],{gold:n("10V"),lightning:0.0000025},n("100G"),function(){return MD.TOTAL_GOLD>=n("1Q")&&MD.CONSTRUCT_LEVELS[21]>=100}),new MD.Dragon(19,"Imperial","Your mages find far more gem inspired by this dragon.","A true king of dragons, its voice cracks with thunder and the earth quakes at its steps.",[20],{majestic:n("100K")},n("1T"),function(){return MD.totalHirelings()>=n("20T")&&MD.TOTAL_SPIRIT_ESSENCE>=10&&MD.hasUpgrade("Volcanic Fury")&&MD.hasUpgrade("Eye of the Hurricane")&&MD.hasUpgrade("Center of the Quake")&&MD.hasUpgrade("Thunder of Death")}),new MD.Dragon(20,"Majestic","Your soldiers fight with an inhuman fury with this dragon leading the charge","A dark purple dragon, coated in dark molten gems and fatal simply to look upon for all but the strongest warriors.",[21],{dragonscale:100,adamantium:100},n("1P"),function(){return MD.getPopulationMax()>=n("25K")&&MD.CAMPAIGNS_WON>=n("10K")&&MD.TOTAL_SPIRIT_ESSENCE>=100}),new MD.Dragon(21,"Eternal","The powers of this dragon are far reaching, altering many aspects of your kingdom.","You have done well. Your dragon is the most powerful creature to set face upon the earth. You shall reap rich rewards having such a beast in your care, and your name will be forever remembered as the one who gave rise to the beast king of Mineria. Its sacrifice will release a power never before known.",[],{fire:0.000005,earth:0.000005,water:0.000005,lightning:0.000005,gold:n("1YQ")},n("1E"),function(){return MD.totalEssence()>=n("1G")&&MD.TOTAL_SPIRIT_ESSENCE>=n("1K")&&MD.totalConstructLevel()>=2500})];MD.ResClone=function(a){return jQuery.extend(true,{},a)};MD.ResAffordable=function(d){var a=Infinity;for(var b in d){var c=MD.RESOURCES[b].amount_function()/d[b];if(c<a){a=c}}return Math.floor(a)};MD.ResMult=function(d,a){d=MD.ResClone(d);for(var b in d){var c=d[b]*a;d[b]=c}return d};MD.ResAdd=function(d,b){d=MD.ResClone(d);for(var c in d){d[c]=Math.round(d[c]+b)}return d};MD.ResPrint=function(f,a,e){a=setDefault(a,false);e=setDefault(e,false);var d="";var c=true;for(var b in f){if(f[b]!=0){if(!c){d+=", "}else{c=!c}d+=s(f[b],a,e)+" "+MD.RESOURCES[b].print_name}}return d};MD.ResCompare=function(d,c){var g=["spirit","lightning","earth","water","fire","dragonscale","adamantium","population","steel","food","iron","coal","stone","dirt","majestic","bagger 288","sandshrew","large ant","perfect","exceptional","mana","flawless","great","normal","gold","flawed","cracked","murky","dreary"];for(var f=0;f<g.length;f++){var h=d[g[f]];var e=c[g[f]];if(Boolean(h)&&Boolean(e)){if(h!=e){return h-e}}else{if(Boolean(h)){return 1}else{if(Boolean(e)){return -1}}}}return 0};MD.getResMult=function(a){var b=1;if(MD.CONSTRUCT_LOCATIONS.indexOf(24)!=-1){var c=MD.convals.archspiriteffect();if(a=="Basic"){b+=MD.ARCH_ARRAY[0]/(100/c)}else{if(a=="Gems"){b+=MD.ARCH_ARRAY[1]/(100/c)}else{if(a=="Raw Materials"){b+=MD.ARCH_ARRAY[2]/(100/c)}else{if(a=="Rare Materials"){b+=MD.ARCH_ARRAY[3]/(100/c)}else{if(a=="Hirelings"){b+=MD.ARCH_ARRAY[4]/(100/c)}else{if(a=="Essence"){b+=MD.ARCH_ARRAY[5]/(100/c)}}}}}}}if(a=="Essence"&&MD.hasUpgrade("Collective Knowledge")){b*=(1+Math.pow(MD.CONSTRUCT_LEVELS[10],0.33)/200)}if(a=="Raw Materials"&&MD.activeDragon("Eternal")){b*=10}if(MD.hasUpgrade("The Ultimate Prize")){b*=10}if(MD.hasUpgrade("Lotsa Time")){b*=2}return b};MD.totalEssence=function(){return MD.TOTAL_FIRE_ESSENCE+MD.TOTAL_WATER_ESSENCE+MD.TOTAL_EARTH_ESSENCE+MD.TOTAL_LIGHTNING_ESSENCE};MD.totalHirelings=function(a){setDefault(a,false);var b=sumArray(MD.HIRELINGS_OWNED,1);b+=(a?MD.HIRELINGS_OWNED[0]:0);return b};MD.totalClicks=function(){return MD.MANUAL_CLICKS+MD.AUTO_CLICKS};MD.hirelingsGreater=function(b){for(var a=1;a<MD.HIRELINGS_OWNED.length;a++){if(MD.HIRELINGS_OWNED[a]>=b){return true}}return false};MD.totalConstructLevel=function(){var b=0;for(var a=0;a<MD.CONSTRUCT_LEVELS.length;a++){if(a!=7&&a!=10){b+=MD.CONSTRUCT_LEVELS[a]}}return b};MD.getPrice=function(a,c){var b=null;if(a==11){b=MD.ResMult(MD.HIRELINGS[a].base_cost,Math.pow(MD.WYVERN_MULTIPLIER,c))}else{if(a==10){b=MD.ResMult(MD.HIRELINGS[a].base_cost,Math.pow(MD.HIVE_QUEEN_MULTIPLIER,c))}else{b=MD.ResMult(MD.HIRELINGS[a].base_cost,Math.pow(MD.PRICE_MULTIPLIER,c))}}if(MD.hasUpgrade("Bigshot Manager")){b=MD.ResMult(b,(100-MD.uv.upgradereduction)/100)}return b};MD.getHirelingByName=function(a){for(var b=0;b<MD.HIRELINGS.length;b++){if(MD.HIRELINGS[b].name.toLowerCase()==a.toLowerCase()){return b}}return -1};MD.getProduction=function(a){var b=MD.HIRELINGS[a];var c=b.output;if(a==0){c=(MD.hasUpgrade("Existing Tunnel Systems")?(c+(MD.uv.antpersandshrew*MD.HIRELINGS_OWNED[3])):c);c=(MD.hasUpgrade("Gentle Giants")?(c+(MD.uv.antperrockgolem*MD.HIRELINGS_OWNED[6])):c);c=(MD.hasUpgrade("Everything is Tunnels")?(c+(MD.uv.antperbagger*MD.HIRELINGS_OWNED[7])):c);c=c*(MD.hasUpgrade("Enlarged Pincers")?MD.uv.level1mult:1)*(MD.hasUpgrade("Fire Ants")?MD.uv.level2mult:1)*(MD.hasUpgrade("For The Queen")?MD.uv.level3mult:1)*(MD.hasUpgrade("Colonization")?MD.uv.level4mult:1)*(MD.hasUpgrade("Who's Pathetic Now?")?MD.uv.level5mult:1)}else{if(a==1){c=(MD.hasUpgrade("Affinity With Nature")?(c+(MD.uv.woodpeckerpertitan*MD.HIRELINGS_OWNED[8])):c);c=c*(MD.hasUpgrade("Feeding Frenzy")?MD.uv.level1mult:1)*(MD.hasUpgrade("Curved Beaks")?MD.uv.level2mult:1)*(MD.hasUpgrade("Nature's Power Drill")?MD.uv.level3mult:1)*(MD.hasUpgrade("Ironbeaks")?MD.uv.level4mult:1)}else{if(a==2){c=(MD.hasUpgrade("Man's Best Friend")?(c+Math.pow(MD.MASONS,MD.uv.houndpercraftexponent)):c);c=c*(MD.hasUpgrade("Sharpened Senses")?MD.uv.level1mult:1)*(MD.hasUpgrade("Reduced Slobber")?MD.uv.level2mult:1)*(MD.hasUpgrade("Nightmare Hounds")?MD.uv.level3mult:1)*(MD.hasUpgrade("Cerberus")?MD.uv.level4mult:1);c=c*(MD.hasUpgrade("Underdogs")?MD.HIRELINGS_OWNED[4]:1)}else{if(a==3){c=(MD.hasUpgrade("Friends With Rare Candies")?(c+(MD.uv.sandshrewperminer*MD.HIRELINGS_OWNED[5])):c);c=(MD.hasUpgrade("Not Just A Boulder")?(c+(MD.uv.sandshrewpergolem*MD.HIRELINGS_OWNED[6])):c);c=c*(MD.hasUpgrade("Cute Overload")?MD.uv.level1mult:1)*(MD.hasUpgrade("Fury Swipes")?MD.uv.level2mult:1)*(MD.hasUpgrade("Sandslash")?MD.uv.level3mult:1)*(MD.hasUpgrade("Earthquake")?MD.uv.level4mult:1);c=c+(MD.hasUpgrade("Armor Sharing")?MD.TIMES_FORTIFIED*MD.uv.sandperfort:0)}else{if(a==4){c=c*(MD.hasUpgrade("Seed of Rebellion")?Math.sqrt(MD.GOBLIN_DAMAGE)/100:1);c=c*(MD.hasUpgrade("Midas Touch")?MD.uv.level1mult:1)*(MD.hasUpgrade("Gringotts Employee")?MD.uv.level2mult:1)*(MD.hasUpgrade("Azog")?MD.uv.level3mult:1)*(MD.hasUpgrade("Blinding Greed")?MD.uv.level4mult:1);c=(MD.hasUpgrade("Trap Aficionado")?(c+sumArray(MD.TRAPS_BOUGHT)*(MD.hasUpgrade("Trap Master")?MD.uv.goblinpertrap2:MD.uv.goblinpertrap1)):c);c=c*(MD.hasUpgrade("Underdogs")?MD.HIRELINGS_OWNED[2]:1)}else{if(a==5){c=(MD.hasUpgrade("Mechanized Industry")?(c+(MD.uv.minerperbagger*MD.HIRELINGS_OWNED[7])):c);c=(MD.hasUpgrade("Dragonborn")?(c+(MD.uv.minerperwyvern*MD.HIRELINGS_OWNED[11])):c);c=c*(MD.hasUpgrade("Overtime")?MD.uv.level1mult:1)*(MD.hasUpgrade("Dual Pickaxes")?MD.uv.level2mult:1)*(MD.hasUpgrade("Herobrine")?MD.uv.level3mult:1)*(MD.hasUpgrade("Blur of Picks")?MD.uv.level4mult:1)}else{if(a==6){c=b.output*(MD.hasUpgrade("Runite Ore Drop")?MD.uv.level1mult:1)*(MD.hasUpgrade("Extra Pointy")?MD.uv.level2mult:1)*(MD.hasUpgrade("Mountain Men")?MD.uv.level3mult:1)*(MD.hasUpgrade("Carbonado Cores")?MD.uv.level4mult:1)}else{if(a==7){c=b.output*(MD.hasUpgrade("13500")?MD.uv.level1mult:1)*(MD.hasUpgrade("Sehr gut!")?MD.uv.level2mult:1)*(MD.hasUpgrade("German Engineering")?MD.uv.level3mult:1)*(MD.hasUpgrade("Unreasonable Force")?MD.uv.level4mult:1)}else{if(a==8){c=b.output*(MD.hasUpgrade("Gaia's Training")?MD.uv.level1mult:1)*(MD.hasUpgrade("Hyperion")?MD.uv.level2mult:1)*(MD.hasUpgrade("Commander Kronus")?MD.uv.level3mult:1)*(MD.hasUpgrade("Masters of Old")?MD.uv.level4mult:1);c=c+(MD.hasUpgrade("Symbiosis")?MD.POPULATION*MD.uv.titanperpop:0);c=c+(MD.hasUpgrade("Academic Symbiosis")?MD.CONSTRUCT_LEVELS[10]*100*MD.uv.titanperpop:0)}else{if(a==9){c=(MD.hasUpgrade("Internal Army")?(c+(MD.uv.worldperant*MD.HIRELINGS_OWNED[0])):c);c=c*(MD.hasUpgrade("Rotating Jaw")?MD.uv.level1mult:1)*(MD.hasUpgrade("Aerodynamic Plating")?MD.uv.level2mult:1)*(MD.hasUpgrade("Diamond Enforced Teeth")?MD.uv.level3mult:1)*(MD.hasUpgrade("Apophis")?MD.uv.level4mult:1)}else{if(a==11){c=b.output*(MD.hasUpgrade("Reinforced Claws")?MD.uv.level1mult:1)*(MD.hasUpgrade("Crystal Vision")?MD.uv.level2mult:1)*(MD.hasUpgrade("Rhenium Heart")?MD.uv.level3mult:1)*(MD.hasUpgrade("Truth Exceeding Legend")?MD.uv.level4mult:1)*(MD.hasUpgrade("Mythical Power")?MD.uv.level5mult:1);c*=MD.convals.dragonmount_function(MD.CONSTRUCT_LEVELS[2])}}}}}}}}}}}c*=(1+MD.IMBUEMENT_LEVEL[a]*0.2);return c};MD.hire=function(b){var a=MD.multibuyActive()?10:1;while(MD.canAfford(MD.getPrice(b,MD.HIRELINGS_OWNED[b]))&&a>0){MD.spend(MD.getPrice(b,MD.HIRELINGS_OWNED[b]));MD.HIRELINGS_OWNED[b]++;a--}MD.setHirelingButtons();MD.updateGoldPerSecond()};MD.setHirelingButtons=function(){for(var c=0;c<MD.HIRELINGS.length;c++){get("hireling"+c).innerHTML=MD.HIRELINGS[c].name+" <br>"+MD.ResPrint(MD.getPrice(c,MD.HIRELINGS_OWNED[c]))+"   -   "+s(Math.round(MD.HIRELINGS_OWNED[c]))+" hired";if(MD.HIRELINGS[c].unlock_function()){if(get("hireling"+c).style.display=="none"){MDART.alertTab("hire")}var a;var b=$("#hireling"+c);if(MD.HIRELINGS[c].name=="Hive Queen"){a=MD.HIRELINGS[c].description+" Spawns "+s(MD.getQueenProduction()*MD.getResMult("Hirelings"))+" ants per second. ("+s(MD.getQueenProduction()*MD.getResMult("Hirelings")*MD.HIRELINGS_OWNED[c])+" total)";MDART.setTooltip(b,"",a);b.toggleClass("unaffordable",!MD.canAfford(MD.getPrice(c,MD.HIRELINGS_OWNED[c])));get("hireling"+c).style.display="inline"}else{if(MD.HIRELINGS[c].name=="Neurochrysalis"){a=MD.HIRELINGS[c].description+" Generates "+s(MD.getChrysalisProduction()*MD.getResMult("Basic"))+" mana per second. ("+s(MD.getChrysalisProduction()*MD.getResMult("Basic")*MD.HIRELINGS_OWNED[c])+" total)";MDART.setTooltip(b,"",a);b.toggleClass("unaffordable",!MD.canAfford(MD.getPrice(c,MD.HIRELINGS_OWNED[c])));get("hireling"+c).style.display="inline"}else{if(MD.HIRELINGS[c].name=="Dragon Hunter"){a=MD.HIRELINGS[c].description+" Finds "+s(MD.getHunterProduction()*MD.getResMult("Rare Materials"))+" dragonscale per second. ("+s(MD.getHunterProduction()*MD.getResMult("Rare Materials")*MD.HIRELINGS_OWNED[c])+" total)";MDART.setTooltip(b,"",a);b.toggleClass("unaffordable",!MD.canAfford(MD.getPrice(c,MD.HIRELINGS_OWNED[c])));get("hireling"+c).style.display="inline"}else{a=MD.HIRELINGS[c].description+" Provides "+s(MD.getProduction(c)*MD.getResMult("Basic"))+" gold per second. ("+s(MD.getProduction(c)*MD.getResMult("Basic")*MD.HIRELINGS_OWNED[c])+" total)";MDART.setTooltip(b,"",a);b.toggleClass("unaffordable",!MD.canAfford(MD.getPrice(c,MD.HIRELINGS_OWNED[c])));get("hireling"+c).style.display="inline"}}}}else{get("hireling"+c).style.display="none";get("hireling"+c).title=""}}};MD.changeHirelings=function(b,a){a*=((a>0)?MD.getResMult("Hirelings"):1);MD.HIRELINGS_OWNED[b]+=a};MD.hasHirelings=function(b,a){return MD.HIRELINGS_OWNED[b]>=a};MD.getHirelings=function(a){return MD.HIRELINGS_OWNED[a]};MD.processWyvernAdamantium=function(){if(MD.hasUpgrade("Adamantium Affinity")){MD.changeAdamantium(MD.HIRELINGS_OWNED[11]/n("10M"))}};MD.processSpecialHirelings=function(){if(MD.hasUpgrade("Woody See, Woody Do")){var a=Math.min(20,Math.floor(MD.HIRELINGS_OWNED[1]/n("1G")));if(a>0){MD.dig(null,null,a)}}if(MD.hasUpgrade("Getting Hungry")){if(MD.HIRELINGS_OWNED[0]>MD.HIRELINGS_OWNED[2]){MD.changeHirelings(0,-MD.HIRELINGS_OWNED[2]);MD.ANTS_EATEN+=MD.HIRELINGS_OWNED[2]}}if(MD.hasUpgrade("Miner Blindness Reduction")){MD.getGaussianGem(4,2,Math.pow(MD.HIRELINGS_OWNED[5],1/5)*748576)}if(MD.hasUpgrade("Strange Transformation")&&tryPercentChance(0.05)&&MD.hasHirelings(6,1)){MD.changeHirelings(6,-1);MD.MAGES++}if(MD.hasUpgrade("Dig Smarter, Not Harder")){var a=MD.HIRELINGS_OWNED[7]*(MD.hasUpgrade("Diesel Engines")?MD.uv.level1mult:1);MD.changeCoal(a/n("100K"))}if(MD.hasUpgrade("Flax Affinity")){var a=MD.HIRELINGS_OWNED[12]/n("20M");a*=(MD.hasUpgrade("Mana Man")?1.5:1);MD.changeFlax(a)}};MD.getQueenProduction=function(){var a=MD.QUEEN_BASE+(MD.hasUpgrade("Ventral Sacs")?MD.uv.queenupgrade1:0)+(MD.hasUpgrade("Bulbosity Enhancement")?MD.uv.queenupgrade2:0)+(MD.hasUpgrade("Larval Acceleration")?MD.uv.queenupgrade2:0)+(MD.hasUpgrade("Unnatural Virility")?MD.uv.queenupgrade3:0)+(MD.hasUpgrade("Hive Mentality")?MD.uv.queenupgrade4:0);if(MD.hasUpgrade("Ever Advancing")){a+=MD.uv.hivequeenantincrease()}a*=(1+MD.IMBUEMENT_LEVEL[10]*0.2);return a};MD.processQueens=function(){MD.changeHirelings(0,MD.HIRELINGS_OWNED[10]*MD.getQueenProduction());if(MD.hasUpgrade("Extreme Mutation")&&tryPercentChance(10)){MD.changeHirelings(getRandom(1,12),Math.sqrt(sumArray(MD.HIRELINGS_OWNED)-MD.HIRELINGS_OWNED[0])*30)}};MD.getChrysalisProduction=function(){var b=MD.NEURO_BASE*(MD.hasUpgrade("Neurological Compounding")?MD.uv.level1mult:1)*(MD.hasUpgrade("Full Assimilation")?MD.uv.level2mult:1)*(MD.hasUpgrade("Metamorphosis")?MD.uv.level3mult:1)*(MD.hasUpgrade("Mana Man")?2:1);var a=0;if(MD.hasUpgrade("Nightmare Neurochrysalises")){a++}if(MD.hasUpgrade("Arcane Neurochrysalises")){a++}if(MD.hasUpgrade("Eldritch Neurochrysalises")){a++}b+=b*((a*MD.MAGES)/100);b*=(1+MD.IMBUEMENT_LEVEL[12]*0.2);return b};MD.processChrysalis=function(){MD.changeMana(MD.HIRELINGS_OWNED[12]*MD.getChrysalisProduction())};MD.getHunterProduction=function(){var a=0.006*Math.pow(MD.CONSTRUCT_LEVELS[14]+1,1.15);a*=(MD.hasUpgrade("Archery Courses")?MD.uv.level1mult:1)*(MD.hasUpgrade("Adamantium Tipped Arrows")?MD.uv.level2mult:1)*(MD.hasUpgrade("Homing Darts")?MD.uv.level3mult:1);a*=(1+MD.IMBUEMENT_LEVEL[13]*0.2);return a};MD.processHunters=function(){MD.changeDragonscale(MD.HIRELINGS_OWNED[13]*MD.getHunterProduction())};MD.hasDirt=function(a){return MD.DIRT>=a};MD.getDirt=function(){return MD.DIRT};MD.changeDirt=function(a){a*=((a>0)?MD.getResMult("Raw Materials"):1);MD.DIRT+=a;if(a>0){MD.TOTAL_DIRT+=a}MD.updateDirtDisplay()};MD.updateDirtDisplay=function(){if(MD.TOTAL_DIRT>0){get("dirtdisplay").innerHTML="Dirt: "+s(MD.DIRT)}else{get("dirtdisplay").innerHTML=""}};MD.processDirtProduction=function(){if(MD.hasUpgrade("Precious Resources")){var a=MD.HIRELINGS_OWNED[7]*(MD.hasUpgrade("Diesel Engines")?MD.uv.level1mult:1);if(MD.hasUpgrade("Myth and Machine")){a*=(Math.pow(MD.HIRELINGS_OWNED[6],0.4)/4)}MD.changeDirt(a)}if(MD.hasUpgrade("Makes Sense")){var a=MD.HIRELINGS_OWNED[9]*MD.uv.dirtpereater;MD.changeDirt(a)}};MD.hasStone=function(a){return MD.STONE>=a};MD.getStone=function(){return MD.STONE};MD.changeStone=function(b,a){b*=((b>0&&typeof(a)=="undefined")?MD.getResMult("Raw Materials"):1);MD.STONE+=b;if(b>0){MD.TOTAL_STONE+=b}MD.updateStoneDisplay()};MD.updateStoneDisplay=function(){if(MD.TOTAL_STONE>0){get("stonedisplay").innerHTML="Stone: "+s(MD.STONE)}else{get("stonedisplay").innerHTML=""}};MD.hasCoal=function(a){return MD.COAL>=a};MD.getCoal=function(){return MD.COAL};MD.changeCoal=function(b,a){b*=((b>0&&typeof(a)=="undefined")?MD.getResMult("Raw Materials"):1);MD.COAL+=b;if(b>0){MD.TOTAL_COAL+=b}MD.updateCoalDisplay()};MD.updateCoalDisplay=function(){if(MD.TOTAL_COAL>0){get("coaldisplay").innerHTML="Coal: "+s(MD.COAL)}else{get("coaldisplay").innerHTML=""}};MD.hasIron=function(a){return MD.IRON>=a};MD.getIron=function(){return MD.IRON};MD.changeIron=function(b,a){b*=((b>0&&typeof(a)=="undefined")?MD.getResMult("Raw Materials"):1);MD.IRON+=b;if(b>0){MD.TOTAL_IRON+=b}MD.updateIronDisplay()};MD.updateIronDisplay=function(){if(MD.TOTAL_IRON>0){get("irondisplay").innerHTML="Iron: "+s(MD.IRON)}else{get("irondisplay").innerHTML=""}};MD.hasSteel=function(a){return MD.STEEL>=a};MD.getSteel=function(){return MD.STEEL};MD.changeSteel=function(b,a){b*=((b>0&&typeof(a)=="undefined")?MD.getResMult("Rare Materials"):1);MD.STEEL+=b;if(b>0){MD.TOTAL_STEEL+=b}MD.updateSteelDisplay()};MD.updateSteelDisplay=function(){if(MD.TOTAL_STEEL>0){get("steeldisplay").innerHTML="Steel: "+s(MD.STEEL)}else{get("steeldisplay").innerHTML=""}var a=get("pop-amt");if(!$(a).is(":focus")){a.value=MD.getMaxHabitationIncrease();MD.habitationInputChange()}};MD.hasFood=function(a){return MD.FOOD>=a};MD.changeFood=function(b,a){b*=((b>0&&typeof(a)=="undefined")?MD.getResMult("Raw Materials"):1);MD.FOOD+=b;if(b>0){MD.TOTAL_FOOD+=b}MD.updateFoodDisplay()};MD.getFood=function(){return MD.FOOD};MD.updateFoodDisplay=function(){if(MD.TOTAL_FOOD>0){get("fooddisplay").innerHTML="Food: "+s(MD.FOOD)}else{get("fooddisplay").innerHTML=""}};MD.hasAdamantium=function(a){return MD.ADAMANTIUM>=a};MD.changeAdamantium=function(b,a){b*=((b>0&&typeof(a)=="undefined")?MD.getResMult("Rare Materials"):1);MD.ADAMANTIUM+=b;if(b>0){MD.TOTAL_ADAMANTIUM+=b}MD.updateAdamantiumDisplay()};MD.getAdamantium=function(){return MD.ADAMANTIUM};MD.updateAdamantiumDisplay=function(){if(MD.TOTAL_ADAMANTIUM>0){get("adamdisplay").innerHTML="Adamantium: "+s(MD.ADAMANTIUM);get("barrack-adamantium-counter").innerHTML="Adamantium: "+s(MD.ADAMANTIUM)}else{get("adamdisplay").innerHTML=""}};MD.hasPopulation=function(a){return MD.POPULATION>=a};MD.changePopulation=function(a){MD.POPULATION+=a;if(a>0){MD.TOTAL_POPULATION+=a}MD.updatePopulationDisplay()};MD.getPopulation=function(){return MD.POPULATION};MD.updatePopulationDisplay=function(){if(MD.TOTAL_POPULATION>0){get("popdisplay").innerHTML="Population: "+s(MD.POPULATION)}else{get("popdisplay").innerHTML=""}var a=get("scholar-amt");if(!$(a).is(":focus")){a.value=MD.getPopulation()}};MD.hasFlax=function(a){return MD.FLAX>=a};MD.changeFlax=function(b,a){b*=((b>0&&typeof(a)=="undefined")?MD.getResMult("Rare Materials"):1);MD.FLAX+=b;if(b>0){MD.TOTAL_FLAX+=b}MD.updateFlaxDisplay()};MD.getFlax=function(){return MD.FLAX};MD.updateFlaxDisplay=function(){if(MD.TOTAL_FLAX>0){get("flaxdisplay").innerHTML="Flax: "+s(MD.FLAX)}else{get("flaxdisplay").innerHTML=""}};MD.hasDragonscale=function(a){return MD.DRAGONSCALE>=a};MD.changeDragonscale=function(a){a*=((a>0)?MD.getResMult("Rare Materials"):1);MD.DRAGONSCALE+=a;if(a>0){MD.TOTAL_DRAGONSCALE+=a}MD.updateDragonscaleDisplay()};MD.getDragonscale=function(){return MD.DRAGONSCALE};MD.updateDragonscaleDisplay=function(){if(MD.TOTAL_DRAGONSCALE>0){get("dragdisplay").innerHTML="Dragonscale: "+s(MD.DRAGONSCALE)}else{get("dragdisplay").innerHTML=""}};MD.hasFireEssence=function(a){return MD.FIRE_ESSENCE>=a};MD.changeFireEssence=function(a){a*=((a>0)?MD.getResMult("Essence"):1);MD.FIRE_ESSENCE+=a;if(a>0){MD.TOTAL_FIRE_ESSENCE+=a}MD.updateFireEssenceDisplay()};MD.getFireEssence=function(){return MD.FIRE_ESSENCE};MD.updateFireEssenceDisplay=function(){if(MD.TOTAL_FIRE_ESSENCE>0){get("fireessdisplay").innerHTML="Fire Essence: "+s(MD.FIRE_ESSENCE)}else{get("fireessdisplay").innerHTML=""}};MD.hasWaterEssence=function(a){return MD.WATER_ESSENCE>=a};MD.changeWaterEssence=function(a){a*=((a>0)?MD.getResMult("Essence"):1);MD.WATER_ESSENCE+=a;if(a>0){MD.TOTAL_WATER_ESSENCE+=a}MD.updateWaterEssenceDisplay()};MD.getWaterEssence=function(){return MD.WATER_ESSENCE};MD.updateWaterEssenceDisplay=function(){if(MD.TOTAL_WATER_ESSENCE>0){get("wateressdisplay").innerHTML="Water Essence: "+s(MD.WATER_ESSENCE)}else{get("wateressdisplay").innerHTML=""}};MD.hasEarthEssence=function(a){return MD.EARTH_ESSENCE>=a};MD.changeEarthEssence=function(a){a*=((a>0)?MD.getResMult("Essence"):1);MD.EARTH_ESSENCE+=a;if(a>0){MD.TOTAL_EARTH_ESSENCE+=a}MD.updateEarthEssenceDisplay()};MD.getEarthEssence=function(){return MD.EARTH_ESSENCE};MD.updateEarthEssenceDisplay=function(){if(MD.TOTAL_EARTH_ESSENCE>0){get("earthessdisplay").innerHTML="Earth Essence: "+s(MD.EARTH_ESSENCE)}else{get("earthessdisplay").innerHTML=""}};MD.hasLightningEssence=function(a){return MD.LIGHTNING_ESSENCE>=a};MD.changeLightningEssence=function(a){a*=((a>0)?MD.getResMult("Essence"):1);MD.LIGHTNING_ESSENCE+=a;if(a>0){MD.TOTAL_LIGHTNING_ESSENCE+=a}MD.updateLightningEssenceDisplay()};MD.getLightningEssence=function(){return MD.LIGHTNING_ESSENCE};MD.updateLightningEssenceDisplay=function(){if(MD.TOTAL_LIGHTNING_ESSENCE>0){get("lightessdisplay").innerHTML="Lightning Essence: "+s(MD.LIGHTNING_ESSENCE)}else{get("lightessdisplay").innerHTML=""}};MD.hasSpiritEssence=function(a){return MD.SPIRIT_ESSENCE>=a};MD.changeSpiritEssence=function(a){MD.SPIRIT_ESSENCE+=a;if(a>0){MD.TOTAL_SPIRIT_ESSENCE+=a}MD.updateSpiritEssenceDisplay()};MD.getSpiritEssence=function(){return MD.SPIRIT_ESSENCE};MD.updateSpiritEssenceDisplay=function(){if(MD.TOTAL_SPIRIT_ESSENCE>0){get("spiritessdisplay").innerHTML="Spirit Essence: "+s(Math.floor(MD.SPIRIT_ESSENCE))}else{get("spiritessdisplay").innerHTML=""}};MD.updateMilitaryButton=function(){if(MD.hasConstruct("Barracks")){get("warButton").style.display="inline"}else{get("warButton").style.display="none"}};MD.updateMilitaryPage=function(){get("enemy-strength").innerHTML="Enemy Strength: "+s(MD.getEnemyStrength());get("available-troops").innerHTML="Available Soldiers: "+s(Math.ceil(MD.getPopulation()/2));get("effective-troops").innerHTML="Army Strength: "+s(MD.getMilitaryStrength());var a=MD.getConstructUpgradeCost(9);get("barrack-upgrade-cost").innerHTML="Training Cost: "+MD.ResPrint(a);if(a.food<=MD.getFood()){get("barrack-upgrade-remainder").innerHTML="Food Remaining After Training: "+s(MD.getFood()-a.food)+" Food"}else{get("barrack-upgrade-remainder").innerHTML=""}var b=MD.getConstructUpgradeCost(9);$("#training-btn").toggleClass("unaffordable",!MD.canAfford(b));get("campaignswon2").innerHTML=(MD.CAMPAIGNS_WON>0)?"Campaigns Won: "+s(MD.CAMPAIGNS_WON):""};MD.getEnemyStrength=function(){return MD.convals.barracks_formula(MD.GOBLIN_LEVEL,MD.SPIDER_LEVEL)};MD.getMilitaryStrength=function(){var a=Math.ceil(MD.getPopulation()/2)*(1+((MD.CONSTRUCT_LEVELS[9])/10))*(1+((MD.CONSTRUCT_LEVELS[11])/25));if(MD.hasConstruct("Graveyard")){a+=a*(MD.convals.graveyardbonus()/100)}if(MD.hasUpgrade("Little Lizard")){a*=1.5}if(MD.hasUpgrade("Overwhelming Might")){a*=2}if(MD.activeDragon("Novice")){a*=2}if(MD.activeDragon("Master")||MD.activeDragon("Eternal")){a*=4}if(MD.activeDragon("Majestic")){a*=10}return a};MD.getAdamantiumReward=function(){var a=Math.max(1,Math.ceil(Math.pow(Math.min(MD.CAMPAIGNS_WON,50000)/1001,5)));a+=(MD.CAMPAIGNS_WON>50000?Math.max(1,Math.ceil(Math.pow((MD.CAMPAIGNS_WON-50000)/253,4))):0);return a};MD.launchCampaign=function(l){l=setDefault(l,false);var d=(MD.multibuyActive()&&!l)?10:1;while(d>0){var a=gaussianRandom(MD.getEnemyStrength(),MD.getEnemyStrength()/5);var g=gaussianRandom(MD.getMilitaryStrength(),MD.getMilitaryStrength()/5);var b=Math.ceil(MD.getPopulation()/2);if(g>a){var j=Math.max(0,Math.round(gaussianRandom(a,a/10))*100);var m=Math.max(0,Math.round(gaussianRandom(a,a/10)*1000));var h=Math.max(0,Math.round(gaussianRandom(a,a/10)*50));var k=0;chance=7*(MD.hasUpgrade("War Vultures")?MD.uv.level3mult:1);if(tryPercentChance(chance)){k=MD.getAdamantiumReward()}var c=(k==1?"You have also found a strange green ore in the ruins. ":" ");c=(k>1?"You have found "+s(k)+" adamantium ore in the wreckage. ":c);MD.changeAdamantium(k);var e=getRandom(Math.ceil(b/20),Math.ceil(b/10));get("military-results").innerHTML="Victory! You have plundered "+s(m)+" iron, "+s(j)+" coal, and "+s(h)+" steel from the defeated horde."+c+s(e)+" soldiers were killed in the battle.";MD.changeCoal(j);MD.changeIron(m);MD.changeSteel(h);var f=(g-a)/120;MD.GOBLIN_LEVEL+=f*n("8K");MD.SPIDER_LEVEL+=f*n("2K");MD.SOLDIERS_LOST+=e;MD.killPopulation(e);MD.CAMPAIGNS_WON++;get("campaignswon2").innerHTML=(MD.CAMPAIGNS_WON>0)?"Campaigns Won: "+s(MD.CAMPAIGNS_WON):"";get("grave-effect").innerHTML="Your army strength is increased by "+s(MD.convals.graveyardbonus())+"% by memories of fallen comrades."}else{var e=getRandom(Math.ceil(b/4),Math.ceil(b/2));get("military-results").innerHTML="Defeat! "+s(e)+" soldiers were killed in battle!";MD.SOLDIERS_LOST+=e;MD.killPopulation(e)}d--}MD.updateMilitaryPage()};MD.updateMechButton=function(){if(MD.hasConstruct("Machinist")){get("mechButton").style.display="inline"}else{get("mechButton").style.display="none"}};MD.getAutoBuildAmount=function(){var a=1;if(MD.hasUpgrade("Ghosts of Rapid Mechanization")){a=Math.max(1,Math.pow(Math.log(MD.totalEssence()),2))}return Math.round(a)};MD.updateMechPage=function(){$("#mech-craftsman").toggle(MD.hasConstruct("Earth Shrine"));$("#mech-alchemist").toggle(MD.hasConstruct("Lightning Shrine"));var c=(MD.hasUpgrade("Fury of Flame")||MD.hasUpgrade("One with Nature")||MD.hasUpgrade("Fury of the Sea")?"You can automatically build up to "+s(MD.getAutoBuildAmount())+" mechanical servant each second.":"");get("auto-amt").innerHTML=c;var f=get("buildMageButton");var e=get("autoMageButton");f.innerHTML="Build Mage ("+MD.ResPrint(MD.convals.mechmagecost)+")";$(f).toggleClass("unaffordable",!MD.canAfford(MD.convals.mechmagecost));e.innerHTML="Try to Auto-Build: "+(MD.MACHINIST_AUTO[0]?"True":"False");$(e).toggle(MD.hasUpgrade("Fury of Flame"));get("mech-mage-count").innerHTML="Total Mages: "+s(MD.MAGES);var d=get("buildMasonButton");var g=get("autoMasonButton");d.innerHTML="Build Craftsman ("+MD.ResPrint(MD.convals.mechmasoncost)+")";$(d).toggleClass("unaffordable",!MD.canAfford(MD.convals.mechmasoncost));g.innerHTML="Try to Auto-Build: "+(MD.MACHINIST_AUTO[1]?"True":"False");$(g).toggle(MD.hasUpgrade("One with Nature"));get("mech-mason-count").innerHTML="Total Craftsmen: "+s(MD.MASONS);var b=get("buildAlchButton");var a=get("autoAlchButton");b.innerHTML="Build Alchemist ("+MD.ResPrint(MD.convals.mechalchcost)+")";$(b).toggleClass("unaffordable",!MD.canAfford(MD.convals.mechalchcost));a.innerHTML="Try to Auto-Build: "+(MD.MACHINIST_AUTO[2]?"True":"False");$(a).toggle(MD.hasUpgrade("Fury of the Sea"));get("mech-alch-count").innerHTML="Total Alchemists: "+s(MD.ALCHEMISTS)};MD.buildMage=function(d){var a=MD.multibuyActive()?10:1;a=((typeof(d)=="undefined")?a:d);var b=MD.ResAffordable(MD.convals.mechmagecost);a=Math.min(a,b);var c=MD.ResMult(MD.convals.mechmagecost,a);MD.spend(c);MD.MAGES+=a;MD.updateMechPage()};MD.buildCraftsman=function(d){var a=MD.multibuyActive()?10:1;a=((typeof(d)=="undefined")?a:d);var b=MD.ResAffordable(MD.convals.mechmasoncost);a=Math.min(a,b);var c=MD.ResMult(MD.convals.mechmasoncost,a);MD.spend(c);MD.MASONS+=a;MD.updateMechPage()};MD.buildAlchemist=function(d){var a=MD.multibuyActive()?10:1;a=((typeof(d)=="undefined")?a:d);var b=MD.ResAffordable(MD.convals.mechalchcost);a=Math.min(a,b);var c=MD.ResMult(MD.convals.mechalchcost,a);MD.spend(c);MD.ALCHEMISTS+=a;MD.updateMechPage()};MD.toggleAutoMage=function(){MD.MACHINIST_AUTO[0]=!MD.MACHINIST_AUTO[0];MD.updateMechPage()};MD.toggleAutoMason=function(){MD.MACHINIST_AUTO[1]=!MD.MACHINIST_AUTO[1];MD.updateMechPage()};MD.toggleAutoAlch=function(){MD.MACHINIST_AUTO[2]=!MD.MACHINIST_AUTO[2];MD.updateMechPage()};MD.updateArchButton=function(){if(MD.hasConstruct("Arcaneum")){get("libButton").style.display="inline"}else{get("libButton").style.display="none"}};MD.updateArchPage=function(){if(MD.spiritAvailable()<0){for(var a=MD.ARCH_ARRAY.length-1;a>=0;a--){if(MD.ARCH_ARRAY[a]>Math.abs(MD.spiritAvailable())){MD.ARCH_ARRAY[a]-=Math.abs(MD.spiritAvailable())}else{MD.ARCH_ARRAY[a]=0}}}$("#arc-gold-area").toggle(MD.hasUpgrade("The Golden Well"));var d=MD.getConstructUpgradeCost(24);var b=get("arc-power-btn");b.innerHTML="Make a Wish! ("+MD.ResPrint(d)+")";$(b).toggleClass("unaffordable",!MD.canAfford(d));get("arc-gold-effect").innerHTML="Your Arcaneum is level "+s(MD.CONSTRUCT_LEVELS[24])+" so each essence provides a "+s(MD.convals.archspiriteffect())+"% multiplier.";get("total-spirit-essence").innerHTML="Total Spirit Essence: "+s(Math.floor(MD.SPIRIT_ESSENCE))+" ("+s(MD.spiritAvailable())+" available)";for(var a=0;a<MD.ARCH_ARRAY.length;a++){var c=get("res-text-"+a);c.innerHTML=s(MD.ARCH_ARRAY[a])+" (Boosting resource gain by "+s(MD.ARCH_ARRAY[a]*MD.convals.archspiriteffect())+"%)"}};MD.spiritAvailable=function(){return Math.floor(MD.SPIRIT_ESSENCE)-sumArray(MD.ARCH_ARRAY)};MD.addSpirit=function(b){var a=MD.multibuyActive()?Math.min(10,MD.spiritAvailable()):1;a=(get("spirit-move-amt").value!=""?Math.min(Number(get("spirit-move-amt").value),MD.spiritAvailable()):a);if(MD.spiritAvailable()>0){MD.ARCH_ARRAY[b]+=a;MD.updateArchPage()}MD.updateArchPage()};MD.remSpirit=function(b){var a=MD.multibuyActive()?Math.min(10,MD.ARCH_ARRAY[b]):1;a=(get("spirit-move-amt").value!=""?Math.min(Number(get("spirit-move-amt").value),MD.ARCH_ARRAY[b]):a);if(MD.ARCH_ARRAY[b]>0){MD.ARCH_ARRAY[b]-=a;MD.updateArchPage()}MD.updateArchPage()};MD.resetSpiritMove=function(){get("spirit-move-amt").value=""};MD.updateDragonButton=function(){if(MD.hasConstruct("Dragon Nest")){get("dragonButton").style.display="inline"}else{get("dragonButton").style.display="none"}};MD.updateDragonPage=function(){if(MD.CURRENT_DRAGON>-1){MD.setDragonLevelMessage();MD.checkDragonUpdate(MD.DRAGONS[MD.CURRENT_DRAGON]);var f=MD.DRAGONS[MD.CURRENT_DRAGON];var h=Math.min(n("1Z"),MD.getDragonUpdateCost(f));var g=Math.floor(0.01*h);var d=Math.floor(0.1*h);var l=Math.floor(h);var c=Math.floor(MD.MAX_DRAGON_LEVEL*0.05);get("dragon-name").innerHTML=f.name+" Dragon";get("dragon-description").innerHTML=f.description;get("dragon-power").innerHTML=f.power;var a=MD.ResClone(f.price);if(f.name=="Master"){if(MD.MASTER_DRAGON_PRICE==null){a={}}else{a=MD.MASTER_DRAGON_PRICE}}else{if(f.name=="Eternal"&&MD.DRAGON_LEVEL>=n("1Z")){a.gold*=Math.pow((MD.DRAGON_LEVEL/n("1Z")),5)}}if(MD.hasUpgrade("Big Cousins")){if(MD.hasUpgrade("Draconic Knowledge")){a=MD.ResMult(a,0.95)}else{a=MD.ResMult(a,0.98)}}get("dragon-1p").innerHTML=((f.name!="Eternal")?"Feed 1% (":"Feed a Little (")+MD.ResPrint(MD.ResMult(a,g),false,true)+")";$("#dragon-1p").toggleClass("unaffordable",!MD.canAfford(MD.ResMult(a,g)));get("dragon-10p").innerHTML=((f.name!="Eternal")?"Feed 10% (":"Feed More (")+MD.ResPrint(MD.ResMult(a,d),false,true)+")";$("#dragon-10p").toggleClass("unaffordable",!MD.canAfford(MD.ResMult(a,d)));get("dragon-100p").innerHTML=((f.name!="Eternal")?"Feed 100% (":"Feed a Lot (")+MD.ResPrint(MD.ResMult(a,l),false,true)+")";$("#dragon-100p").toggleClass("unaffordable",!MD.canAfford(MD.ResMult(a,l)));var k=get("dragon-lots");$(k).toggle(MD.DRAGON_LEVEL>=n("1Z"));k.innerHTML="Feed a Silly Amount ("+MD.ResPrint(MD.ResMult(a,c),false,true)+")";$("#dragon-lots").toggleClass("unaffordable",!MD.canAfford(MD.ResMult(a,c)));$("#essence-dragon-area").toggle(false);if(f.name=="Master"){if(MD.MASTER_DRAGON_PRICE==null){$("#essence-dragon-area").toggle(true);var m=["Fire","Water","Earth","Lightning"];var j=get("dragon-essence-type");if(j.options.length==0){clearSelectBox(j);for(var e=0;e<m.length;e++){var b=document.createElement("option");b.innerHTML=m[e];b.value=m[e].toLowerCase();j.appendChild(b)}}$("#feed-dragon-area").toggle(false)}}}else{if(MD.hasConstruct("Dragon Nest")){MD.CURRENT_DRAGON=0}}};MD.feedDragon=function(e){var b=MD.DRAGONS[MD.CURRENT_DRAGON];var d=Math.min(n("1Z"),MD.getDragonUpdateCost(b));var a=(b.name=="Eternal"?Infinity:d-MD.DRAGON_LEVEL);e=(e=="1P")?Math.floor(0.01*d):e;e=(e=="10P")?Math.floor(0.1*d):e;e=(e=="100P")?Math.floor(d):e;e=(e=="silly")?Math.floor(MD.MAX_DRAGON_LEVEL*0.05):e;e=Math.min(a,e);var c=MD.ResClone(b.price);if(b.name=="Master"){if(MD.MASTER_DRAGON_PRICE==null){c={}}else{c=MD.MASTER_DRAGON_PRICE}}else{if(b.name=="Eternal"&&MD.DRAGON_LEVEL>=n("1Z")){c.gold*=Math.pow((MD.DRAGON_LEVEL/n("1Z")),5)}}if(MD.hasUpgrade("Big Cousins")){if(MD.hasUpgrade("Draconic Knowledge")){c=MD.ResMult(c,0.95)}else{c=MD.ResMult(c,0.98)}}c=MD.ResMult(c,e);if(MD.canAfford(c)){MD.spend(c);MD.DRAGON_LEVEL+=e;if(MD.DRAGON_LEVEL>MD.MAX_DRAGON_LEVEL){MD.MAX_DRAGON_LEVEL=MD.DRAGON_LEVEL}}MD.setDragonLevelMessage();get("dragonleveldisplay").innerHTML="Dragon Level: "+s(MD.DRAGON_LEVEL)+" (Worth "+s(MD.getSpiritValue())+" Spirit Essence)";MD.checkDragonUpdate(b);MD.updateDragonPage()};MD.checkDragonUpdate=function(a){if(a.name=="Master"&&MD.MASTER_DRAGON_PRICE==null){return}if(MD.DRAGON_LEVEL>=MD.getDragonUpdateCost(a)){var b=-1;if(a.name!="Master"){b=a.progressions[0]}else{if(MD.MASTER_DRAGON_PRICE.fire!=undefined){b=7}else{if(MD.MASTER_DRAGON_PRICE.water!=undefined){b=10}else{if(MD.MASTER_DRAGON_PRICE.earth!=undefined){b=13}else{b=16}}}}if(MD.DRAGONS[b].unlock_condition()){MD.CURRENT_DRAGON=b;MD.MASTER_DRAGON_PRICE=null;MD.DRAGONS_OWNED[b]=true;MD.setDragonLevelMessage();$("#sacDragonButton").toggleClass("unaffordable",!MD.hasDragon("Novice"))}else{get("dragon-level").innerHTML="Your dragon is ready to progress, but you have not fulfilled the requirements for the next dragon!";MD.DRAGONS_OWNED[0]=true}}};MD.setDragonLevelMessage=function(){if(MD.CURRENT_DRAGON!=-1&&MD.DRAGONS[MD.CURRENT_DRAGON].name=="Eternal"){get("dragon-level").innerHTML="Your dragon is level "+s(MD.DRAGON_LEVEL)+". It has reached the final stage, you can keep feeding it to increase its value however!"}else{get("dragon-level").innerHTML="Your dragon is level "+s(MD.DRAGON_LEVEL)+". They grow up so fast!"}};MD.getDragonUpdateCost=function(a){if(a.name=="Eternal"){return Infinity}var b=a.progressions[0];return MD.DRAGONS[b].base_essence};MD.hasDragon=function(a){for(var b=0;b<MD.DRAGONS.length;b++){if(MD.DRAGONS[b].name==a){return MD.DRAGONS_OWNED[b]}}};MD.activeDragon=function(a){if(MD.CURRENT_DRAGON==-1){return false}return MD.DRAGONS[MD.CURRENT_DRAGON].name==a};MD.selectEssenceType=function(){var a=get("dragon-essence-type").value;MD.MASTER_DRAGON_PRICE={};MD.MASTER_DRAGON_PRICE[a]=0.00005;$("#essence-dragon-area").toggle(false);$("#feed-dragon-area").toggle(true);MD.updateDragonPage()};MD.getSpiritValue=function(){var a=Math.pow(MD.DRAGON_LEVEL/n("10M"),1/3);a*=(MD.hasUpgrade("Spirit Overcharge")?2:1);a*=(MD.hasUpgrade("Ancestral Might")?Math.max(1,Math.log(MD.MAX_DRAGON_LEVEL/n("100Y"))):1);return a};MD.autoSacrifice=function(e){e=setDefault(e,false);if(MD.MAGES<13){return}MD.MAGES-=13;var b=MD.CURRENT_DRAGON;var c=MD.DRAGONS[MD.CURRENT_DRAGON];while(MD.canAfford(c.price)){var d=MD.ResAffordable(c.price);if(d>n("9E")&&c.name=="Eternal"){d=n("9E")}MD.feedDragon(d);if(b==MD.CURRENT_DRAGON){break}c=MD.DRAGONS[MD.CURRENT_DRAGON];b=MD.CURRENT_DRAGON;if(c.name=="Master"){var a=["fire","earth","lightning","water"];get("dragon-essence-type").value=a[getRandom(0,3)];MD.selectEssenceType()}}MD.sacrificeDragon(true,e);MD.setDragonLevelMessage()};MD.toggleAutoSacrifice=function(a){MD.AUTO_RIFT=(a==undefined)?!MD.AUTO_RIFT:a;get("auto-auto-btn").innerHTML="Auto-Auto Rift: "+(MD.AUTO_RIFT?"On":"Off")};MD.processAutoSacrifice=function(){if(MD.AUTO_RIFT){MD.autoSacrifice(true)}};MD.sacrificeDragon=function(c,b){c=setDefault(c,false);b=setDefault(b,false);if(MD.hasDragon("Novice")){var a=(c?true:confirm("Are you sure? Your dragon will be converted to spirit essence and you will have to raise it again from an egg. Sacrificing dragons will also cause blind revenge to auto-attack faster."));if(a==true){MD.DRAGONS_SACRIFICED++;MD.changeSpiritEssence(MD.getSpiritValue());MD.DRAGON_LEVEL=0;MD.CURRENT_DRAGON=0;MD.DRAGONS_OWNED=[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false];MD.MASTER_DRAGON_PRICE=null;if(!b){MD.openConstructDialog(MD.CONSTRUCT_LOCATIONS.indexOf(23))}MD.updateDragonPage();$("#essence-dragon-area").toggle(false);$("#feed-dragon-area").toggle(true)}}else{MDART.notify("Your dragon is not old enough to enter the portal!")}};MD.updateIndustryButton=function(){if(MD.hasUpgrade("Precious Resources")){get("indButton").style.display="inline"}else{get("indButton").style.display="none"}if(MD.hasUpgrade("Builder's Regret")){get("industry-move-btn").style.display="inline"}else{get("industry-move-btn").style.display="none"}};MD.processIndustry=function(){for(var a=0;a<MD.CONSTRUCTION_STATUS.length;a++){if(MD.CONSTRUCTION_STATUS[a]==null){continue}if(MD.CONSTRUCTION_STATUS[a]<MDART.PIXELS_PER_PLOT){var b=(MD.hasUpgrade("Rush Job")?Math.max(1,Math.round(MD.MASONS/100)):1);while(b--){if(MD.canAfford(MD.COST_PER_PIXEL)){MD.INDUSTRY_WORKING=true;MD.spend(MD.COST_PER_PIXEL);MD.CONSTRUCTION_STATUS[a]++;MDART.drawDirtOnPlot(a,MD.CONSTRUCTION_STATUS[a],false,0);if(MD.CONSTRUCTION_STATUS[a]==MDART.PIXELS_PER_PLOT){MD.INDUSTRY_WORKING=false;break}}}continue}else{if(MD.CONSTRUCTION_STATUS[a]==MDART.PIXELS_PER_PLOT){continue}else{if(MD.CONSTRUCTION_STATUS[a]<MDART.PIXELS_PER_PLOT*2){var b=(MD.hasUpgrade("Rush Job")?Math.max(1,Math.round(MD.MASONS/100)):1);while(b--){MD.INDUSTRY_WORKING=true;MD.CONSTRUCTION_STATUS[a]++;MDART.drawDirtOnPlot(a,MD.CONSTRUCTION_STATUS[a]-MDART.PIXELS_PER_PLOT,false,1);if(MD.CONSTRUCTION_STATUS[a]==MDART.PIXELS_PER_PLOT*2){break}}}else{if(MD.CONSTRUCTION_STATUS[a]==MDART.PIXELS_PER_PLOT*2){MD.INDUSTRY_WORKING=false;MD.CONSTRUCTION_STATUS[a]++;MDART.drawConstructs()}else{if(MD.CONSTRUCTION_STATUS[a]==MDART.PIXELS_PER_PLOT*2+1){MD.performConstructAction(MD.CONSTRUCT_LOCATIONS[a])}}}}}}};MD.performConstructAction=function(c){switch(c){case 0:for(var k=0;k<MD.AUTO_SMITH_GEM;k++){var j=(MD.AUTO_SMITH_LIMIT==null?0:MD.AUTO_SMITH_LIMIT);MD.combineGem(k,MD.getSmithyPower(),false,j)}break;case 1:var b=MD.HIRELINGS_OWNED[6]*(MD.hasUpgrade("Birth of a World")?MD.uv.level1mult:1)*(MD.hasUpgrade("Rock Out")?MD.uv.level2mult:1);if(MD.hasUpgrade("Machine and Myth")){b*=(Math.max(4,Math.pow(MD.HIRELINGS_OWNED[7],0.4))/4)}if(MD.activeDragon("Egg")){b*=2}MD.changeStone(b);if(MD.hasUpgrade("Deep Mining")){var d=MD.HIRELINGS_OWNED[6]/2000*(MD.hasUpgrade("Iron Affinity")?MD.uv.level1mult:1);MD.changeIron(d);if(tryPercentChance(10)){var o=MD.HIRELINGS_OWNED[6]/10000*(MD.hasUpgrade("Dirty Hands")?MD.uv.level1mult:1);MD.changeCoal(o)}}var e=MD.convals.quarryFindChance*(MD.hasUpgrade("Miner Productivity")?MD.CLICKS_THIS_TICK+1:1);if(tryPercentChance(e)){MDART.notify("Something has been discovered in your quarry!");get("quarry-discovery").style.display="inline"}if(MD.hasUpgrade("Ghosts of Quarry Future")&&get("quarry-discovery").style.display=="inline"&&MD.TICKS%30==0){MD.findQuarryReward()}break;case 3:var h=(MD.hasUpgrade("Studiosity")?MD.uv.level1mult:1)*(MD.hasUpgrade("Age of Wonders")?MD.uv.level2mult:1);MD.MAGE_TOWER_RESEARCH+=MD.convals.magetower_gain*h*MD.MAGES;get("mage-tower-research").innerHTML="Mage Wisdom Level: "+s(MD.MAGE_TOWER_RESEARCH);get("wisdom-mult").innerHTML="Meditation Multiplier: "+s(MD.getMageTowerMult());break;case 4:var g=MD.TICKS%600;if(g==0){MD.getStatueReward(MD.CONSTRUCT_LEVELS[c])}get("statue-return-timer").innerHTML="Tax collectors return in "+getTime(600-g)+".";break;case 5:var b=MD.getPitProduction();var m=MD.getPitPrice();if(MD.canAfford(m)&&MD.PIT_SMELTING){MD.spend(m);MD.GOBLINS_SACRIFIED+=m.goblin;MD.changeSteel(b);if(MD.hasUpgrade("Heavy Smelting")){var b=1+((MD.hasUpgrade("Energy of Earth")&&MD.DIRT_TO_MANA>0)?Math.pow(MD.DIRT_TO_MANA*2,1/2):0);get("pit-addy-amt").innerHTML="Your smelting pit has a chance of producting "+s(b)+" adamantium.";if(tryPercentChance(MD.convals.smeltAddyChance)){if(MD.canAfford(MD.convals.smeltAddyCost)){MD.changeAdamantium(b);MD.spend(MD.convals.smeltAddyCost);MD.GOBLINS_SACRIFIED+=MD.convals.smeltAddyCost.goblin}}}}break;case 6:MD.MARKET_TIMER--;if(MD.MARKET_TIMER<=0){MD.CURRENT_RATES=[];for(var k=0;k<MD.EXCHANGE_RATES.length;k++){MD.CURRENT_RATES.push(MD.getMarketRate())}MD.startMarketTimer()}MD.refreshMarket();break;case 7:if(MD.POPULATION<=MD.FOOD){var q=MD.POPULATION/(MD.hasUpgrade("Green Revolution")?2:1);MD.changeFood(-q);var f=Math.max(1,Math.round(MD.getPopulationMax()/3600));f*=(MD.hasUpgrade("On and On")?2:1);f*=(MD.hasUpgrade("Baby Bonuses")?2:1);f*=(MD.hasUpgrade("Green Revolution")?2:1);f*=(MD.hasUpgrade("First Steps")?1.5:1);var t=Math.min(f,MD.getPopulationMax()-MD.getPopulation(),MD.FOOD);MD.changePopulation(t)}else{MD.changePopulation(-Math.max(1,Math.floor(MD.POPULATION/100)));MD.changeFood(-MD.FOOD);get("hab-upgrade-cost").innerHTML="Upgrade Cost: "+MD.ResPrint(MD.getLinearUpgradeCost(c));MDART.notify("Some of your citizens have starved to death!")}get("population-txt").innerHTML="Population: "+s(MD.getPopulation())+" out of "+s(MD.getPopulationMax());break;case 8:case 12:case 13:if(MD.TICKS%MD.convals.farmtime1==0){MD.changeFood(MD.getFarmProduction(c));if(c==12){MD.changeFlax(1*Math.ceil((MD.CONSTRUCT_LEVELS[c]+1)/10))}else{if(c==13){MD.changeFlax(3*Math.ceil((MD.CONSTRUCT_LEVELS[c]+1)/10))}}}break;case 9:break;case 10:break;case 11:break;case 14:break;case 15:if(MD.TICKS%(MD.hasUpgrade("World of Flame")?30:60)==0){var b=(MD.CONSTRUCT_LEVELS[c]+1)/10;b*=(MD.activeDragon("Fire")?2:1);b*=(MD.activeDragon("Blazing")||MD.activeDragon("Eternal")?4:1);b*=(MD.activeDragon("Inferno")?8:1);MD.changeFireEssence(b)}break;case 16:MD.ADMIN_TIME++;var l=true;for(var a in MD.ADMIN_ARRAY){l=false;break}if(l){MD.createAdminDialog()}else{if(MD.TICKS%10===0){MD.updateAdminDialog()}}break;case 17:if(MD.TICKS%(MD.hasUpgrade("World of Water")?30:60)==0){var b=(MD.CONSTRUCT_LEVELS[c]+1)/10;b*=(MD.activeDragon("Water")?2:1);b*=(MD.activeDragon("Aquatic")||MD.activeDragon("Eternal")?4:1);b*=(MD.activeDragon("Torrential")?8:1);MD.changeWaterEssence(b)}break;case 18:b=MD.getAutoBuildAmount();if(MD.MACHINIST_AUTO[0]){MD.buildMage(b)}if(MD.MACHINIST_AUTO[1]){MD.buildCraftsman(b)}if(MD.MACHINIST_AUTO[2]){MD.buildAlchemist(b)}break;case 19:if(MD.TICKS%(MD.hasUpgrade("World of Earth")?30:60)==0){var b=(MD.CONSTRUCT_LEVELS[c]+1)/10;b*=(MD.activeDragon("Earth")?2:1);b*=(MD.activeDragon("Terrene")||MD.activeDragon("Eternal")?4:1);b*=(MD.activeDragon("Terrestrial")?8:1);MD.changeEarthEssence(b)}break;case 20:break;case 21:if(MD.TICKS%(MD.hasUpgrade("World of Lightning")?30:60)==0){var b=(MD.CONSTRUCT_LEVELS[c]+1)/10;b*=(MD.activeDragon("Lightning")?2:1);b*=(MD.activeDragon("Electric")||MD.activeDragon("Eternal")?4:1);b*=(MD.activeDragon("Thundering")?8:1);MD.changeLightningEssence(b)}break;case 22:break}};MD.clickPlot=function(g){if(MD.CONSTRUCT_LOCATIONS[g]!=null&&MD.CONSTRUCTION_STATUS[g]==MDART.PIXELS_PER_PLOT*2+1){MD.openConstructDialog(g);return}if(MD.INDUSTRY_WORKING){$("#busy-dialog").dialog("open")}else{if(MD.CONSTRUCTION_STATUS[g]==undefined||MD.CONSTRUCTION_STATUS[g]<MDART.PIXELS_PER_PLOT){var b=$("#start-prep-land-btn");b.unbind();b.click(function(h){return function(){MD.startFilling(g)}}(g));$("#prep-land-dialog").dialog("open")}else{var f=$("#start-construction-btn");f.unbind();f.click(function(h){return function(){MD.startBuilding(g)}}(g));var e=[];for(var d=0;d<MD.CONSTRUCTS.length;d++){if(MD.CONSTRUCTS[d].unlock_function()&&MD.CONSTRUCT_LOCATIONS.indexOf(d)==-1){e.push(d)}}var a=get("construction-select");clearSelectBox(a);if(e.length==0){var c=document.createElement("option");c.innerHTML="None Available";c.value="None Available";a.appendChild(c)}for(d=0;d<e.length;d++){var c=document.createElement("option");c.innerHTML=MD.CONSTRUCTS[e[d]].name+" ("+MD.ResPrint(MD.CONSTRUCTS[e[d]].cost,true)+")";c.value=e[d];a.appendChild(c)}$("#start-construction-dialog").dialog("open")}}};MD.openConstructDialog=function(g){g=MD.CONSTRUCT_LOCATIONS[g];switch(g){case 0:var a=get("auto-smith-select");clearSelectBox(a);var e=document.createElement("option");e.innerHTML="None";e.value="None";a.appendChild(e);for(var d=0;d<MD.GEM_OBJECTS.length;d++){var e=document.createElement("option");e.innerHTML=MD.GEM_OBJECTS[d].name;e.value=d;a.appendChild(e)}a.value=MD.AUTO_SMITH_GEM;get("auto-smith-upgrade-cost").innerHTML="Upgrade Cost: "+MD.ResPrint(MD.getConstructUpgradeCost(g));get("auto-smith-power").innerHTML="Smithy Power: "+s(MD.getSmithyPower())+" gems per second";if(MD.TOTAL_STONE>0){get("auto-smith-upgrades").style.display="inline"}else{get("auto-smith-upgrades").style.display="none"}$("#limit-speed").toggle(MD.hasUpgrade("Industrial Brakes"));var c=(MD.AUTO_SMITH_LIMIT==null||MD.AUTO_SMITH_LIMIT==0?"":MD.AUTO_SMITH_LIMIT);get("auto-smith-limit-amt").value=c;get("auto-smith-limit").innerHTML=(MD.AUTO_SMITH_LIMIT==null||MD.AUTO_SMITH_LIMIT==0?"Minimum Gem Stockpile: None":"Minimum Gem Stockpile: "+String(MD.AUTO_SMITH_LIMIT));break;case 1:break;case 2:get("dragon-mount-desc").innerHTML=MD.convals.dragonmount_text[MD.getDragonmountStage()];get("dragon-mount-power").innerHTML="Wyvern Boost: "+s(MD.convals.dragonmount_function(MD.CONSTRUCT_LEVELS[g]))+" times gold per second.";var f=MD.getConstructUpgradeCost(g);get("dragon-mount-btn").innerHTML="Pile it on! ("+MD.ResPrint(f)+")";break;case 4:get("statue-upgrade-cost").innerHTML="Upgrade Cost: "+MD.ResPrint(MD.getConstructUpgradeCost(g));break;case 5:get("pit-upgrade-cost").innerHTML="Upgrade Cost: "+MD.ResPrint(MD.getConstructUpgradeCost(g));var h=MD.getPitProduction();if(MD.PIT_SMELTING){get("pit-rate").innerHTML="Smelting "+s(h)+" steel per second at a cost of "+MD.ResPrint(MD.getPitPrice())+".";get("pit-toggle-btn").innerHTML="Stop Smelting!"}else{get("pit-rate").innerHTML="Not smelting.";get("pit-toggle-btn").innerHTML="Start Smelting!"}break;case 6:MD.MARKET_DIALOG_OPEN=true;MD.refreshMarket();break;case 7:get("population-txt").innerHTML="Population: "+s(MD.getPopulation())+" out of "+s(MD.getPopulationMax());MD.habitationInputChange();break;case 8:case 12:case 13:get("farm-txt"+g).innerHTML="Harvest Data: "+s(MD.getFarmProduction(g)*MD.getResMult("Raw Materials"))+" food every "+MD.convals.farmtime1+" seconds ("+s((MD.getFarmProduction(g)*MD.getResMult("Raw Materials"))/MD.convals.farmtime1)+" per second)";get("farm-upgrade-cost"+g).innerHTML=MD.ResPrint(MD.getConstructUpgradeCost(g));break;case 9:break;case 10:get("uni-level").innerHTML="Education Level: "+s(MD.CONSTRUCT_LEVELS[g]);get("scholar-amt").value=MD.getPopulation();get("uni-market").innerHTML=(MD.hasUpgrade("Ghosts of Economic Prowess")?"Average Market Boost: "+s(MD.uv.marketscholarincrease()):"");get("uni-essence").innerHTML=(MD.hasUpgrade("Collective Knowledge")?"Essence Multiplier: "+s(Math.pow(MD.CONSTRUCT_LEVELS[10],0.33)/200):"");break;case 11:get("weapon-upgrade-btn").innerHTML="Hone Weapons ("+MD.ResPrint(MD.getConstructUpgradeCost(g))+")";get("army-weaken-btn").innerHTML="Bomb Enemies ("+MD.ResPrint(MD.convals.blacksmith_formula(MD.GOBLIN_LEVEL,MD.SPIDER_LEVEL))+")";break;case 14:get("fletcher-upgrade-cost").innerHTML="Train Hunters ("+MD.ResPrint(MD.getConstructUpgradeCost(g))+")";break;case 15:get("fireshrine-upgrade-cost").innerHTML="Upgrade Cost: "+MD.ResPrint(MD.getConstructUpgradeCost(g));MD.updateFireEssenceDisplay();break;case 16:get("admin-range").value=MD.ADMIN_RANGE;get("admin-display").value=MD.DISPLAYED_TIME;break;case 17:get("watershrine-upgrade-cost").innerHTML="Upgrade Cost: "+MD.ResPrint(MD.getConstructUpgradeCost(g));MD.updateWaterEssenceDisplay();break;case 18:break;case 19:get("earthshrine-upgrade-cost").innerHTML="Upgrade Cost: "+MD.ResPrint(MD.getConstructUpgradeCost(g));MD.updateEarthEssenceDisplay();break;case 20:get("grave-effect").innerHTML="Your army strength is increased by "+s(MD.convals.graveyardbonus())+"% by memories of fallen comrades.";$("#blind-revenge-btn").toggle(MD.hasUpgrade("Blind Revenge"));break;case 21:get("lightshrine-upgrade-cost").innerHTML="Upgrade Cost: "+MD.ResPrint(MD.getConstructUpgradeCost(g));MD.updateLightningEssenceDisplay();break;case 22:break;case 23:get("dragonleveldisplay").innerHTML="Dragon Level: "+s(MD.DRAGON_LEVEL)+" (Worth "+s(MD.getSpiritValue())+" Spirit Essence)";$("#sacDragonButton").toggleClass("unaffordable",!MD.hasDragon("Novice"));var b=$("#auto-sacrifice-btn");if(MD.hasUpgrade("Auto-Rift 9000")){b.toggle(true);b.toggleClass("unaffordable",MD.MAGES<13)}else{b.toggle(false)}$("#auto-auto-btn").toggle(MD.hasUpgrade("Auto-Auto-Rift 9000"));MD.updateSpiritEssenceDisplay();break;case 24:break}$("#construct-dialog-"+g).dialog("open");return};MD.increaseConstructLevel=function(c){var a=1;var b=MD.getConstructUpgradeCost(c);while(MD.canAfford(b)&&a>0){MD.spend(b);MD.CONSTRUCT_LEVELS[c]++;a--}if(c!=7){$("#construct-dialog-"+c).dialog("option","title",MD.CONSTRUCTS[c].name+" - Level "+s(MD.CONSTRUCT_LEVELS[c]))}if(c!=9&&c!=24){MD.openConstructDialog(MD.CONSTRUCT_LOCATIONS.indexOf(c))}else{if(c!=24){MD.updateMilitaryPage()}else{MD.updateArchPage()}}if(MD.CONSTRUCTS[c].image.length>1){MDART.drawConstructs()}};MD.getHabitationSum=function(d,c){var e=((c*c-d*d)+(c-d))*500;return{steel:e}};MD.addPopulation=function(){var b=Number(get("pop-amt").value);if(b>0){b=Math.min(b,MD.getMaxHabitationIncrease());var a=MD.getHabitationSum(MD.CONSTRUCT_LEVELS[7],MD.CONSTRUCT_LEVELS[7]+b);MD.spend(a);MD.STEEL=Math.max(0,MD.STEEL);MD.CONSTRUCT_LEVELS[7]+=b;MD.changePopulation(b);MD.openConstructDialog(MD.CONSTRUCT_LOCATIONS.indexOf(7));$("#construct-dialog-7").dialog("option","title",MD.CONSTRUCTS[7].name+" - Level "+s(MD.CONSTRUCT_LEVELS[7],true))}};MD.getMaxHabitationIncrease=function(){var b=MD.getLinearUpgradeCost(7);b=b.steel-1000;var c=MD.RESOURCES.steel.amount_function();var a=Math.floor((-b+Math.sqrt(b*b+4*500*c))/(2*500));return a};MD.habitationInputChange=function(){var b=Number(get("pop-amt").value);var a=MD.getHabitationSum(MD.CONSTRUCT_LEVELS[7],MD.CONSTRUCT_LEVELS[7]+b);get("hab-upgrade-cost").innerHTML="Upgrade Cost: "+MD.ResPrint(a)};MD.exilePopulation=function(){var a=Number(get("exile-amt").value);if(a>0){r=confirm("Are you sure you want to exile "+String(a)+" citizens? You will not receive a refund on construction costs!");if(r==true){a=Math.min(a,MD.CONSTRUCT_LEVELS[7]);MD.CONSTRUCT_LEVELS[7]-=a;if(MD.POPULATION>=a){MD.changePopulation(-a)}else{MD.changePopulation(-MD.POPULATION)}MD.openConstructDialog(MD.CONSTRUCT_LOCATIONS.indexOf(7))}}};MD.startFilling=function(a){MD.CONSTRUCTION_STATUS[a]=0;MD.INDUSTRY_WORKING=true;$("#prep-land-dialog").dialog("close")};MD.startBuilding=function(b){var a=get("construction-select").value;if(a=="None Available"){$("#start-construction-dialog").dialog("close");return}a=Number(a);if(MD.canAfford(MD.CONSTRUCTS[a].cost)){MD.spend(MD.CONSTRUCTS[a].cost);MD.CONSTRUCT_LOCATIONS[b]=a;MD.CONSTRUCTION_STATUS[b]=MDART.PIXELS_PER_PLOT+1;MD.INDUSTRY_WORKING=true}else{MDART.notify("Too expensive!")}$("#start-construction-dialog").dialog("close")};MD.initializeConstructUnlocked=function(){for(var a=0;a<MD.CONSTRUCTS.length;a++){MD.CONSTRUCT_UNLOCKED[a]=MD.CONSTRUCTS[a].unlock_function()}};MD.checkConstructs=function(){for(var a=0;a<MD.CONSTRUCTS.length;a++){if(!MD.CONSTRUCT_UNLOCKED[a]&&MD.CONSTRUCTION_STATUS[a]==null&&MD.CONSTRUCTS[a].unlock_function()){MD.CONSTRUCT_UNLOCKED[a]=true;MDART.alertBtn("indButton")}}};MD.openMoveBuildingDialog=function(){MD.MOVE_DIALOG_OPEN=true;MD.MOVE_BUILDING_1=null;MD.MOVE_BUILDING_2=null;get("swap-building-1").innerHTML="Building 1: None";get("swap-building-2").innerHTML="Building 2: None";var a={neurochrysalis:5};$("#perform-swap").toggleClass("unaffordable",!MD.canAfford(a));$("#move-construct-dialog").dialog("open")};MD.performBuildingMove=function(){var c=MD.MOVE_BUILDING_1;var a=MD.MOVE_BUILDING_2;if(c!==null&&a!==null){var b={neurochrysalis:5};if(MD.canAfford(b)){MD.spend(b);swapArray(MD.CONSTRUCT_LOCATIONS,c,a);swapArray(MD.CONSTRUCTION_STATUS,c,a);MDART.updateIndustryCanvas()}else{MDART.notify("Too expensive!")}}MD.MOVE_DIALOG_OPEN=false;MD.MOVE_BUILDING_1=null;MD.MOVE_BUILDING_2=null;get("swap-building-1").innerHTML="Building 1: None";get("swap-building-2").innerHTML="Building 2: None";$("#move-construct-dialog").dialog("close")};MD.hasConstruct=function(a){for(var b=0;b<MD.CONSTRUCTS.length;b++){if(MD.CONSTRUCTS[b].name===a){if(MD.CONSTRUCT_LOCATIONS.indexOf(b)!=null){if(MD.CONSTRUCTION_STATUS[MD.CONSTRUCT_LOCATIONS.indexOf(b)]==MDART.PIXELS_PER_PLOT*2+1){return true}}}}return false};MD.fillExistingIndustry=function(){for(var a=0;a<MD.CONSTRUCTION_STATUS.length;a++){if(MD.CONSTRUCTION_STATUS[a]==null){continue}if(MD.CONSTRUCTION_STATUS[a]!=null&&MD.CONSTRUCTION_STATUS[a]<=MDART.PIXELS_PER_PLOT){MDART.drawDirtOnPlot(a,MD.CONSTRUCTION_STATUS[a],true,0)}if(MD.CONSTRUCTION_STATUS[a]>MDART.PIXELS_PER_PLOT){MDART.drawDirtOnPlot(a,MDART.PIXELS_PER_PLOT,true,0);MDART.drawDirtOnPlot(a,MD.CONSTRUCTION_STATUS[a]-MDART.PIXELS_PER_PLOT,true,1)}}MDART.drawConstructs()};MD.getConstructUpgradeCost=function(a){var b=MD.ResMult(MD.CONSTRUCTS[a].upgrade_cost,Math.pow(MD.PRICE_MULTIPLIER,MD.CONSTRUCT_LEVELS[a]));if(a==9&&MD.hasUpgrade("Grasshopper")){b=MD.ResMult(b,0.1)}return b};MD.getLinearUpgradeCost=function(a){return MD.ResMult(MD.CONSTRUCTS[a].upgrade_cost,MD.CONSTRUCT_LEVELS[a]+1)};MD.getSmithyPower=function(){var a=(10+MD.CONSTRUCT_LEVELS[0]*10);a=a*(MD.hasUpgrade("Mechanical Overload")?MD.uv.overloadmult1:1);a=a*(MD.hasUpgrade("Mechanical Supercharge")?MD.uv.overloadmult2:1);return a};MD.setAutoSmithLimit=function(){var a=get("auto-smith-limit-amt").value;if(a>=0){MD.AUTO_SMITH_LIMIT=Number(a)}MD.openConstructDialog(MD.CONSTRUCT_LOCATIONS.indexOf(0))};MD.setAutoSmithGem=function(){var a=get("auto-smith-select").value;if(a=="None"){MD.AUTO_SMITH_GEM=0}else{MD.AUTO_SMITH_GEM=Number(a)}$("#construct-dialog-0").dialog("close")};MD.getDragonmountStage=function(){for(var a=1;a<MD.convals.dragonmount_levels.length;a++){if(MD.CONSTRUCT_LEVELS[2]<MD.convals.dragonmount_levels[a]){return a-1}}return MD.convals.dragonmount_levels.length-1};MD.getMageTowerMult=function(){return 1+Math.pow(MD.MAGE_TOWER_RESEARCH/10000,2.7)};MD.findQuarryReward=function(){get("quarry-discovery").style.display="none";var c=Math.round(sumArray(MD.GEMS));var d=Math.min(getRandom(c/200,c/100),MD.getStatueGemAmount(MD.CONSTRUCT_LEVELS[4]));var b=0;if(MD.hasUpgrade("Expert Consulting")){d*=MD.uv.quarryrewardmult();b=Math.min(Math.floor(MD.uv.quarryrewardmult()),15)}var a=getRandom(1,100);if(a<50-b){MD.changeGems(8,d);get("quarry-discovery-text").innerHTML="You found "+s(d)+" perfect gems!"}else{if(a<90-b&&MD.TOTAL_ADAMANTIUM>0){var e=Math.min(Math.max(1,Math.sqrt(MD.ADAMANTIUM*3)),n("1G"));MD.changeAdamantium(e);get("quarry-discovery-text").innerHTML="You have found "+s(e)+" pieces of adamantium!"}else{if(a<96-b){MD.changeGems(9,d);get("quarry-discovery-text").innerHTML="You found "+s(d)+" majestic gems!"}else{MD.ALCHEMISTS++;MD.setAlchemistButton();get("total-alchemists").innerHTML="Total Alchemists: "+s(MD.ALCHEMISTS)+" ("+s(MD.alchemistsAvailable())+" available)";get("quarry-discovery-text").innerHTML="You found a rare artifact, and an alchemist has come from afar to study it for you, free of charge!"}}}clearTimeout(MD.QUARRY_TIMEOUT);MD.QUARRY_TIMEOUT=setTimeout(function(){get("quarry-discovery-text").innerHTML=""},10000)};MD.getStatueGemAmount=function(a){return Math.round(Math.pow(2*a,1.3)+30*a+50)*450};MD.getStatueReward=function(c){var b=MD.getStatueGemAmount(c);b*=(MD.activeDragon("Child")?2:1);b=getRandom(b-Math.round(b/10),b+Math.round(b/10));var a=[0,0,0,0,0,0,0,0,0,0];for(var d=0;d<25;d++){var e=Math.round(gaussianRandom(3.5,3));e=Math.max(Math.min(MD.GEM_OBJECTS.length-1,e),0);a[e]+=Math.round(b/25)}for(var d=0;d<a.length;d++){MD.changeGems(d,a[d])}get("statue-findings").innerHTML="Your tax collectors have returned bearing "+s(b)+" gems."};MD.getPitProduction=function(){var a=MD.PIT_BASE*(MD.hasUpgrade("Steel Affinity")?MD.uv.level1mult:1);var b=MD.CONSTRUCT_LEVELS[5]+1;b*=b;var c=a*b;c=c*(MD.hasUpgrade("Peer Pressure")?MD.uv.level1mult:1)*(MD.hasUpgrade("Enter the Horde")?MD.uv.level2mult:1);return c};MD.getPitPrice=function(){var c=1;c*=(MD.hasUpgrade("Waste Not")?2:1)*(MD.hasUpgrade("Want Not")?2:1);var b=MD.PIT_BASE*(MD.CONSTRUCT_LEVELS[5]+1)/c;var a=MD.ResMult(MD.convals.pitPrice,b);a.goblin*=(MD.hasUpgrade("Waste Not")?2:1)*(MD.hasUpgrade("Want Not")?2:1);if(MD.hasUpgrade("Have Not")){a.goblin+=MD.getPitProduction()/2}return a};MD.togglePit=function(){MD.PIT_SMELTING=!MD.PIT_SMELTING;if(MD.PIT_SMELTING){get("pit-toggle-btn").innerHTML="Stop Smelting!"}else{get("pit-toggle-btn").innerHTML="Start Smelting!"}MD.openConstructDialog(MD.CONSTRUCT_LOCATIONS.indexOf(5))};MD.startMarketTimer=function(){var a=getRandom(40,80)*60;if(MD.activeDragon("Eternal")){a=a/3}MD.MARKET_TIMER=a;MD.MARKET_HALVED=false};MD.setMarket=function(a){MD.MARKET_RATE=a;MD.refreshMarket()};MD.marketTrade=function(b){var e=MD.EXCHANGE_RATES[b];var c=e.base_amt;var a=e.final_amt*MD.CURRENT_RATES[b]/100;var d=Math.floor(MD.RESOURCES[e.base_res].amount_function()*(MD.MARKET_RATE/100));a=(a*d)/c;c=d;if(MD.RESOURCES[e.base_res].check_function(c)){MD.RESOURCES[e.base_res].change_function(-c);MD.RESOURCES[e.final_res].change_function(a,true);MD.MARKET_TRADES++}MD.refreshMarket()};MD.getMarketRate=function(){var a=100+(MD.hasUpgrade("Ghosts of Economic Prowess")?MD.uv.marketscholarincrease():0);return Math.max(5,Math.round(gaussianRandom(a,50)))};MD.initializeMarketButtons=function(){var b=$("#market-trades");b.empty();for(var a=0;a<MD.EXCHANGE_RATES.length;a++){b.append("<button id='market-trade-btn-"+a+"' class='btn oval-btn dialog-button' onclick='MD.marketTrade("+a+")' style='display:none;'>Resources Not Available</button>")}};MD.refreshMarket=function(){if(MD.MARKET_DIALOG_OPEN){if(MD.CURRENT_RATES.length==0){for(var c=0;c<MD.EXCHANGE_RATES.length;c++){MD.CURRENT_RATES.push(MD.getMarketRate())}}get("market-time-remaining").innerHTML="New merchants with new prices will arrive in "+getTime(MD.MARKET_TIMER)+"!";var e=$("#send-scouts");if(MD.hasUpgrade("Untapped Markets")){e.toggle(true);e.toggleClass("unaffordable",MD.MARKET_HALVED||MD.MASONS<5)}else{e.toggle(false)}var h=$("#market-trades");for(var c=0;c<MD.EXCHANGE_RATES.length;c++){var g=MD.EXCHANGE_RATES[c];var d=g.base_amt;var a=g.final_amt*MD.CURRENT_RATES[c]/100;var f=Math.floor(MD.RESOURCES[g.base_res].amount_function()*(MD.MARKET_RATE/100));a=(a*f)/d;d=f;if(g.unlock_condition()){var b=get("market-trade-btn-"+c);if(b.style.display=="none"){b.style.display="block"}if(d>=1&&f>=1){b.innerHTML=s(d)+" "+MD.RESOURCES[g.base_res].print_name+" for "+s(a)+" "+MD.RESOURCES[g.final_res].print_name}else{b.innerHTML="Resources Not Available"}}MDART.setTooltip($("#market-trade-btn-"+c),"","Current Exchange Rate: "+MD.CURRENT_RATES[c])}}};MD.sendMarketScouts=function(){if(MD.MASONS>=5&&!MD.MARKET_HALVED){MD.MASONS-=5;MD.MARKET_HALVED=true;MD.MARKET_TIMER=Math.ceil(MD.MARKET_TIMER/2);MD.refreshMarket()}};MD.closeMarket=function(){$("#construct-dialog-6").dialog("close");MD.MARKET_DIALOG_OPEN=false};MD.getPopulationMax=function(){return MD.CONSTRUCT_LEVELS[7]+1};MD.killPopulation=function(a){MD.changePopulation(-a)};MD.getHabitationStage=function(){var a=0;for(var b=0;b<MD.convals.habLevels.length;b++){if(MD.CONSTRUCT_LEVELS[7]+1>=MD.convals.habLevels[b]){a++}}return a};MD.getFarmProduction=function(b){var a=(MD.hasUpgrade("Agriculture")?MD.convals.farmrate2:MD.convals.farmrate1);a=(MD.hasUpgrade("Irrigation")?MD.convals.farmrate3:a);a*=(MD.hasUpgrade("Higher Learning")?MD.uv.level3mult:1);a*=(MD.hasUpgrade("A Whole New World")?2:1);a*=(MD.hasUpgrade("Center of the Quake")?8:1);a*=(MD.activeDragon("Hatchling")||MD.activeDragon("Eternal")?1.5:1);return a*(MD.CONSTRUCT_LEVELS[b]+1)};MD.getFarmStage=function(){if(MD.hasUpgrade("Irrigation")){return 2}else{if(MD.hasUpgrade("Agriculture")){return 1}else{return 0}}};MD.addScholars=function(){var b=Number(get("scholar-amt").value);if(b>0){var a={population:b,adamantium:1};if(MD.canAfford(a)){MD.spend(a);MD.CONSTRUCT_LEVELS[10]+=(b*(MD.hasUpgrade("Sensei")?2:1));MD.openConstructDialog(MD.CONSTRUCT_LOCATIONS.indexOf(10));$("#construct-dialog-"+10).dialog("option","title",MD.CONSTRUCTS[10].name+" - Level "+s(MD.CONSTRUCT_LEVELS[10],true))}else{MDART.notify("You can't afford the cost of "+MD.ResPrint(a))}}};MD.getEducationLevel=function(){return MD.CONSTRUCT_LEVELS[10]};MD.bombEnemies=function(c){c=setDefault(c,false);var a=(MD.multibuyActive()&&!c)?10:1;var b=MD.convals.blacksmith_formula(MD.GOBLIN_LEVEL,MD.SPIDER_LEVEL);while(MD.canAfford(b)&&a>0){MD.spend(b);MD.GOBLIN_LEVEL*=0.92;MD.SPIDER_LEVEL*=0.92;if(!c){MD.openConstructDialog(MD.CONSTRUCT_LOCATIONS.indexOf(11))}a--;b=MD.convals.blacksmith_formula(MD.GOBLIN_LEVEL,MD.SPIDER_LEVEL)}};MD.createAdminDialog=function(){for(var b in MD.RESOURCES){var a=MD.RESOURCES[b];if(a.amount_function()>0){MD.ADMIN_ARRAY[b]=a.amount_function()}}};MD.updateAdminDialog=function(){var d=get("admin-range");var m=get("admin-display");MD.ADMIN_RANGE=Math.floor(Math.max(10,Number(d.value)));d.value=MD.ADMIN_RANGE;MD.DISPLAYED_TIME=Math.floor(Math.max(1,Number(m.value)));m.value=MD.DISPLAYED_TIME;var c=[];var f=false;for(var a in MD.RESOURCES){if(MD.ADMIN_ARRAY[a]===undefined){MD.ADMIN_ARRAY[a]=MD.RESOURCES[a].amount_function()}else{c.push({name:a,change:MD.RESOURCES[a].amount_function()-MD.ADMIN_ARRAY[a]});if(MD.ADMIN_TIME>=MD.ADMIN_RANGE){MD.ADMIN_ARRAY[a]=MD.RESOURCES[a].amount_function();f=true}}}var l=MD.RESOURCE_SECTION_NAMES;var k=MD.RESOURCE_SECTION_TITLES;for(var g=0;g<l.length;g++){var b=get("admin-"+l[g]+"-section");b.innerHTML=""}var j=MD.DISPLAYED_TIME/MD.ADMIN_TIME;for(var g=0;g<c.length;g++){var e="black";if(c[g].change>0){e="green"}else{if(c[g].change<0){e="red"}}get("admin-"+MD.RESOURCES[c[g].name].type+"-section").innerHTML+="<span style='color:"+e+"''>"+c[g].name.toTitleCase()+": "+s(c[g].change*j)+" /"+s(MD.DISPLAYED_TIME)+((MD.DISPLAYED_TIME==1)?" second":" seconds")+"</span><br>"}for(var g=0;g<l.length;g++){var b=get("admin-"+l[g]+"-section");if(b.innerHTML!=""){var h="<b>"+k[g]+"</b><br>"+b.innerHTML+"<br>";b.innerHTML=h}}if(f){MD.ADMIN_TIME=0}};MD.getBlindRevengeTime=function(){return Math.max(1,Math.ceil(30/(MD.DRAGONS_SACRIFICED==0?1:MD.DRAGONS_SACRIFICED)))};MD.toggleBlindRevenge=function(a){MD.BLIND_REVENGE=(a==undefined)?!MD.BLIND_REVENGE:a;get("blind-revenge-btn").innerHTML=(MD.BLIND_REVENGE?"Disable Blind Revenge":"Enable Blind Revenge");get("blind-revenge-txt").innerHTML=(MD.BLIND_REVENGE?"Your soldiers attack automatically once every "+MD.getBlindRevengeTime()+" seconds.":"")};MD.processBlindRevenge=function(){if(MD.BLIND_REVENGE){var a=MD.getBlindRevengeTime();if(MD.TICKS%a==0){MD.launchCampaign(true);if(MD.hasUpgrade("Strike Blindly")){MD.bombEnemies(true)}}}};MD.buypick=function(){var a=true;if(MD.pickSocketed()){a=confirm("Are you sure you want to buy a new pick? Your currently socketed gems will be lost!")}if(a==true){if(MD.PICK_LEVEL+1<MD.PICKS.length){if(MD.canAfford(MD.PICKS[MD.PICK_LEVEL+1].cost)){MD.spend(MD.PICKS[MD.PICK_LEVEL+1].cost);MD.setPickLevel(MD.PICK_LEVEL+1);MD.setSockets(MD.PICK_LEVEL);MDART.notify("Bought "+MD.PICKS[MD.PICK_LEVEL].name+" Pick!")}}}};MD.rebuypick=function(){var a=confirm("Are you sure you want to buy a new pick? You might get more sockets but you will lose your currently socketed gems!");if(a==true){if(MD.canAfford(MD.PICKS[MD.PICK_LEVEL].cost)){MD.spend(MD.PICKS[MD.PICK_LEVEL].cost);MD.setPickLevel(MD.PICK_LEVEL);MD.setSockets(MD.PICK_LEVEL);MDART.notify("Bought "+MD.PICKS[MD.PICK_LEVEL].name+" Pick!")}}};MD.getPickID=function(a){for(var b=0;b<MD.PICKS.length;b++){if(MD.PICKS[b].name.toLowerCase()==a.toLowerCase()){return b}}return -1};MD.setPickLevel=function(a){MD.PICK_LEVEL=a;MD.updatePickDisplay();MD.setBuyPickMessage(MD.PICK_LEVEL+1)};MD.setSockets=function(b){var a=getRandom(1,100);if(a<=b*2||b>=16){MD.PICK_SOCKETS=[null,null,null]}else{if(a<=b*8){MD.PICK_SOCKETS=[null,null]}else{if(a<=b*25){MD.PICK_SOCKETS=[null]}else{MD.PICK_SOCKETS=[]}}}MD.updateCraftingPage();MD.updateSocketDropDowns()};MD.getPickStrength=function(){var e=MD.PICKS[MD.PICK_LEVEL].strength;for(var b=0;b<MD.PICK_SOCKETS.length;b++){if(MD.PICK_SOCKETS[b]!=null){var c=MD.GEM_OBJECTS[MD.PICK_SOCKETS[b]].pick_increase;e+=c}}if(MD.hasMageUpgrade("Elemental Pickaxe")){e*=MD.uv.elementalpick}if(MD.hasUpgrade("Pioneer Spirit")){e*=MD.uv.pioneerspiritmult}if(MD.hasUpgrade("Mining Mastery")){e*=MD.uv.miningmasterymult}if(MD.hasUpgrade("Terra's Might")){e*=MD.uv.terrasmightmult}if(MD.hasUpgrade("A Little Bugged")){e+=MD.uv.pickgainperant*MD.HIRELINGS_OWNED[0]}if(MD.hasUpgrade("Mantis Extension")){e+=MD.uv.pickgainperant2*MD.HIRELINGS_OWNED[0]}if(MD.hasUpgrade("Communal Effort")){e+=MD.uv.pickgainperhireling*(sumArray(MD.HIRELINGS_OWNED)-MD.HIRELINGS_OWNED[0])}if(MD.hasUpgrade("Putting in Work")){e+=MD.HIRELINGS_OWNED[1]*(MD.uv.pickgainperhireling*999999)}if(MD.hasMageUpgrade("HEART!")){var a=Math.min(Math.floor(MD.MAGES/MD.uv.numPerDouble),20);var d=Math.pow(2,a);e*=d}if(MD.hasUpgrade("Advanced Magick")){opt1=e+(MD.GOLD_PER_SECOND/50*(MD.MAGES/(MD.TICKS/1800))+MD.HIRELINGS_OWNED[11]*MD.HIRELINGS_OWNED[0]*987);opt2=e*3;e=Math.max(opt1,opt2)}if(MD.hasConstruct("Earth Shrine")){e*=Math.pow(MD.CONSTRUCT_LEVELS[19]+1,1.1)}return e};MD.updatePickDisplay=function(){var a=MD.getPickStrength();if(MD.PICK_LEVEL>0){get("tooltype").innerHTML="Tool: "+MD.getPickAdjective()+MD.PICKS[MD.PICK_LEVEL].name+" Pick ("+s(a)+")"}else{get("tooltype").innerHTML="Tool: "+MD.getPickAdjective()+MD.PICKS[MD.PICK_LEVEL].name+" ("+s(a)+")"}};MD.getPickAdjective=function(){var b=-1;for(var a=0;a<MD.PICK_SOCKETS.length;a++){if(MD.PICK_SOCKETS[a]!=null&&MD.PICK_SOCKETS[a]>b){b=MD.PICK_SOCKETS[a]}}if(MD.hasMageUpgrade("HEART!")){return"Captain Planet's "}else{if(b>7){return MD.GEM_OBJECTS[b].name+" "}else{if(MD.hasMageUpgrade("Elemental Pickaxe")){return"Elemental "}else{if(b>-1){return MD.GEM_OBJECTS[b].name+" "}else{return""}}}}};MD.setBuyPickMessage=function(c){if(c<MD.PICKS.length&&MD.PICKS[c].unlock_function()){if(get("newpickbutton").style.display=="none"){MDART.alertTab("shop")}get("newpickbutton").style.display="inline";get("newpickbutton").innerHTML=MD.PICKS[c].name+" Pick ("+MD.ResPrint(MD.PICKS[c].cost)+")";var a=MD.PICKS[c].description;var b=$("#newpickbutton");MDART.setTooltip(b,"",a);b.toggleClass("unaffordable",!MD.canAfford(MD.PICKS[c].cost))}else{get("newpickbutton").style.display="none"}if(c!=1&&MD.craftingAvailable()){get("rebuypickbutton").style.display="inline";get("rebuypickbutton").innerHTML="Buy New "+MD.PICKS[c-1].name+" Pick ("+MD.ResPrint(MD.PICKS[c-1].cost)+")";$("#rebuypickbutton").toggleClass("unaffordable",!MD.canAfford(MD.PICKS[c-1].cost))}else{get("rebuypickbutton").style.display="none"}};MD.buyWall=function(){if(MD.WALL_LEVEL+1<MD.WALLS.length){if(MD.GOLD>=MD.WALLS[MD.WALL_LEVEL+1].cost){MD.changeGold(-1*MD.WALLS[MD.WALL_LEVEL+1].cost);MD.setWall(MD.WALL_LEVEL+1,0)}}else{var a=MD.multibuyActive()?10:1;while(MD.GOLD>=Math.pow(MD.PRICE_MULTIPLIER,MD.FORTIFICATION_LEVEL)*MD.FORTIFICATION_COST&&a>0){MD.changeGold(-1*Math.pow(MD.PRICE_MULTIPLIER,MD.FORTIFICATION_LEVEL)*MD.FORTIFICATION_COST);MD.setWall(MD.WALL_LEVEL,MD.FORTIFICATION_LEVEL+1);MD.TIMES_FORTIFIED++;a--}}};MD.destroyWall=function(){if(MD.WALL_LEVEL>0){MD.setWall(MD.WALL_LEVEL-1,0)}MD.TIMES_FORTIFIED=0};MD.setWall=function(a,b){MD.WALL_LEVEL=a;MD.FORTIFICATION_LEVEL=b;MD.WALL_STRENGTH=MD.WALLS[MD.WALL_LEVEL].durability+MD.FORTIFICATION_VALUE*MD.FORTIFICATION_LEVEL;MD.MAX_WALL_STRENGTH=MD.WALL_STRENGTH;MD.updateWallMessage();MD.setBuildWallMessage(MD.WALL_LEVEL+1);MDART.updateBackground()};MD.setBuildWallMessage=function(a){if(a<MD.WALLS.length){get("buildwallbutton").innerHTML="Build "+MD.WALLS[a].name+" Wall ("+s(MD.WALLS[a].cost)+" gold)";$("#buildwallbutton").toggleClass("unaffordable",MD.WALLS[a].cost>MD.GOLD)}else{get("buildwallbutton").innerHTML="Fortify "+MD.WALLS[MD.WALLS.length-1].name+" Wall ("+s(Math.pow(MD.PRICE_MULTIPLIER,MD.FORTIFICATION_LEVEL)*MD.FORTIFICATION_COST)+" gold)";$("#buildwallbutton").toggleClass("unaffordable",Math.pow(MD.PRICE_MULTIPLIER,MD.FORTIFICATION_LEVEL)*MD.FORTIFICATION_COST>MD.GOLD)}};MD.updateWallMessage=function(){if(MD.WALL_LEVEL>0){get("walltype").innerHTML="Wall: "+MD.WALLS[MD.WALL_LEVEL].name+" Wall ("+s(MD.WALL_STRENGTH)+")"}else{get("walltype").innerHTML="Wall: None"}};MD.hireMason=function(){var a=MD.multibuyActive()?10:1;var b=MD.MASON_START_COST*Math.pow(MD.PRICE_MULTIPLIER,MD.MASONS);while(MD.GOLD>=b&&a>0){MD.changeGold(-1*b);MD.MASONS++;MD.setMasonButton();var b=MD.MASON_START_COST*Math.pow(MD.PRICE_MULTIPLIER,MD.MASONS);a--}};MD.setMasonButton=function(){if(MD.TOTAL_GOLD>=MD.MASON_UNLOCK_GOLD){if(get("hiremasonbutton").style.display=="none"){MDART.alertTab("defense")}get("hiremasonbutton").style.display="inline";var c=MD.MASON_START_COST*Math.pow(MD.PRICE_MULTIPLIER,MD.MASONS);get("hiremasonbutton").innerHTML="Hire Craftsman ("+s(c)+" gold)";var a=$("#hiremasonbutton");a.toggleClass("unaffordable",c>MD.GOLD);var b="Hire a craftsman to automatically repair your wall over time. ("+s(MD.MASONS)+" hired)";MDART.setTooltip(a,"",b)}else{get("hiremasonbutton").style.display="none"}};MD.getMasonRepairRate=function(){if(MD.INDUSTRY_WORKING){return 0}var b=MD.MASON_REPAIR_RATE*(MD.hasUpgrade("Elbow Grease")?MD.uv.level1mult:1)*(MD.hasUpgrade("Takin Care of Business")?MD.uv.level2mult:1)*(MD.hasUpgrade("Overall-Clad Blurs")?MD.uv.level3mult:1)*(MD.hasUpgrade("Alchemical Repair Rates")?MD.uv.level4mult:1);var a=0;a=(MD.hasUpgrade("Takin Care of Business")?MD.uv.masonPercent1:a);a=(MD.hasUpgrade("Overall-Clad Blurs")?MD.uv.masonPercent2:a);a=(MD.hasUpgrade("Alchemical Repair Rates")?MD.uv.masonPercent3:a);b+=(a/100)*MD.MAX_WALL_STRENGTH;return b};MD.processMasons=function(){if(MD.WALL_LEVEL>0){MD.WALL_STRENGTH=Math.min(MD.WALL_STRENGTH+MD.MASONS*MD.getMasonRepairRate(),MD.MAX_WALL_STRENGTH);MD.updateWallMessage()}};MD.craftingAvailable=function(){return(MD.TOTAL_GEMS>=4)};MD.updateCraftingButtons=function(){if(MD.craftingAvailable()){get("craftingButton").style.display="inline"}else{get("craftingButton").style.display="none"}};MD.updateCraftingPage=function(){var c;for(c=0;c<MD.GEM_OBJECTS.length;c++){get("gemcount"+c).innerHTML=MD.GEM_OBJECTS[c].name+": "+s(Math.floor(MD.GEMS[c]),true)}var j=get("socket0");var h=get("socket1");var g=get("socket2");if(MD.PICK_SOCKETS.length==0){j.style.display="inline";h.style.display="inline";j.innerHTML="Your pick has no sockets!";h.innerHTML="Try buying a new one.";g.style.display="none";for(c=0;c<3;c++){get("selectsocket"+c).style.display="none";get("socketbutton"+c).style.display="none"}}else{for(c=0;c<3;c++){if(c<MD.PICK_SOCKETS.length){get("socket"+c).style.display="inline";if(MD.PICK_SOCKETS[c]==null){get("socket"+c).innerHTML="Socket "+(c+1)+": ";get("selectsocket"+c).style.display="inline";get("socketbutton"+c).style.display="inline"}else{var f="Socket "+(c+1)+": "+MD.GEM_OBJECTS[MD.PICK_SOCKETS[c]].name;var a=MD.GEM_OBJECTS[MD.PICK_SOCKETS[c]].pick_increase;var d=MD.GEM_OBJECTS[MD.PICK_SOCKETS[c]].gps_increase;f+=" (Pick +"+s(a);if(d>0){f+=", GPS +"+s(d)+"%"}f+=")";get("socket"+c).innerHTML=f;get("selectsocket"+c).style.display="none";get("socketbutton"+c).style.display="none"}}else{get("socket"+c).style.display="inline";get("socket"+c).innerHTML="Socket "+(c+1)+": Unavailable";get("selectsocket"+c).style.display="none";get("socketbutton"+c).style.display="none"}}}var b=$("#prygemsbutton");var k=MD.getGemPryReturn();if(!MD.pickSocketed()||MD.ResPrint(k)===""){b.css("display","none")}else{var e="Pry Out Gems (Recover "+MD.ResPrint(k)+")";b.html(e);b.css("display","inline")}};MD.getGemPryReturn=function(){var c={};for(var a=0;a<3;a++){if(a<MD.PICK_SOCKETS.length){if(MD.PICK_SOCKETS[a]!=null&&MD.PICK_SOCKETS[a]!=0){var b=MD.GEM_OBJECTS[MD.PICK_SOCKETS[a]-1].name.toLowerCase();if(c[b]===undefined){c[b]=MD.GEM_OBJECTS[MD.PICK_SOCKETS[a]].combine_requirement-1}else{c[b]+=MD.GEM_OBJECTS[MD.PICK_SOCKETS[a]].combine_requirement-1}}}}return c};MD.pickSocketed=function(){for(var a=0;a<MD.PICK_SOCKETS.length;a++){if(MD.PICK_SOCKETS[a]!==null){return true}}return false};MD.pryGems=function(){var a=MD.getGemPryReturn();var b=confirm("Are you sure you want to pry out the gems from your pick? This cannot be reversed!.");if(b==true){MD.earn(a);for(i=0;i<MD.PICK_SOCKETS.length;i++){MD.PICK_SOCKETS[i]=null}MD.updateCraftingPage();MD.updateGems();MD.updateSocketDropDowns()}};MD.updateSocketDropDowns=function(){var f=[];var e;for(e=0;e<MD.GEM_OBJECTS.length;e++){if(MD.GEMS[e]>0){f.push(MD.GEM_OBJECTS[e].name)}}for(e=0;e<3;e++){var a=get("selectsocket"+e);var b=a.value;clearSelectBox(a);var d=document.createElement("option");d.innerHTML="None";d.value="None";a.appendChild(d);for(var c=0;c<f.length;c++){var g=document.createElement("option");g.innerHTML=f[c];g.value=f[c];a.appendChild(g)}if(MD.GEMS[MD.getGemByName(b)]>=1){a.value=b}}};MD.combineGem=function(b,d,c,a){var c=setDefault(c,true);var d=setDefault(d,1);var a=setDefault(a,0);if(b!=MD.GEM_OBJECTS.length-1){if(MD.multibuyActive()&&c){var e=Math.floor(MD.GEMS[b]/MD.GEM_OBJECTS[b+1].combine_requirement);if(get("gem-move-amt").value!=""){e=Math.floor(Math.max(0,Math.min(get("gem-move-amt").value,e)))}MD.GEMS[b]-=e*MD.GEM_OBJECTS[b+1].combine_requirement;MD.GEMS[b]=Math.max(MD.GEMS[b],0);MD.GEMS[b+1]+=e}else{var f=Math.max(MD.GEMS[b]-a,0);if(f>=MD.GEM_OBJECTS[b+1].combine_requirement){var e=Math.min(Math.floor(f/MD.GEM_OBJECTS[b+1].combine_requirement),d);MD.GEMS[b]-=e*MD.GEM_OBJECTS[b+1].combine_requirement;MD.GEMS[b+1]+=e}}MD.updateCraftingPage();MD.updateSocketDropDowns()}};MD.breakGem=function(a){if(a!=0){if(MD.GEMS[a]>=1){if(MD.multibuyActive()){var b=MD.GEMS[a];if(get("gem-move-amt").value!=""){b=Math.floor(Math.max(0,Math.min(get("gem-move-amt").value,b)))}MD.GEMS[a]-=b;MD.GEMS[a-1]+=(MD.GEM_OBJECTS[a].combine_requirement-1)*b}else{MD.GEMS[a]--;MD.GEMS[a-1]+=(MD.GEM_OBJECTS[a].combine_requirement-1)}MD.updateCraftingPage();MD.updateSocketDropDowns()}}};MD.combineGems=function(){MD.GEM_COMBINE_LIMIT=Number(get("gem-combine-limit").value);for(var a=MD.GEM_COMBINE_LIMIT;a>0;a--){var b=Math.floor(MD.GEMS[a-1]/MD.GEM_OBJECTS[a].combine_requirement);MD.GEMS[a-1]-=b*MD.GEM_OBJECTS[a].combine_requirement;MD.GEMS[a-1]=Math.max(MD.GEMS[a-1],0);MD.GEMS[a]+=b}MD.updateCraftingPage();MD.updateSocketDropDowns()};MD.getGemByName=function(a){for(var b=0;b<MD.GEM_OBJECTS.length;b++){if(MD.GEM_OBJECTS[b].name==a){return b}}return -1};MD.setSocket=function(b){var a=get("selectsocket"+b).value;if(a!="None"){var c=MD.getGemByName(a);MD.changeGems(c,-1);MD.PICK_SOCKETS[b]=c;MD.updateCraftingPage();MD.updateSocketDropDowns()}};MD.hireMage=function(){var b=MD.MAGE_START_COST*Math.pow(MD.PRICE_MULTIPLIER,MD.MAGES);var a=MD.multibuyActive()?10:1;while(MD.GOLD>=b&&a>0){MD.changeGold(-1*b);MD.MAGES++;MD.setMageButton();MD.updateAuraDisplay();if(MD.hasConstruct("Mage Tower")){MD.MAGE_TOWER_RESEARCH+=500}var b=MD.MAGE_START_COST*Math.pow(MD.PRICE_MULTIPLIER,MD.MAGES);a--}};MD.setMageButton=function(){if(MD.TOTAL_GOLD>=MD.MAGE_UNLOCK_GOLD){if(get("hiremagebutton").style.display=="none"){MDART.alertTab("defense")}get("hiremagebutton").style.display="inline";var c=MD.MAGE_START_COST*Math.pow(MD.PRICE_MULTIPLIER,MD.MAGES);get("hiremagebutton").innerHTML="Hire Mage ("+s(c)+" gold)";var a=$("#hiremagebutton");a.toggleClass("unaffordable",c>MD.GOLD);var b="Hire a mage to BRING THE PAIN!!! ("+s(MD.MAGES)+" hired)";MDART.setTooltip(a,"",b)}else{get("hiremagebutton").style.display="none"}};MD.updateMageButtons=function(){if(MD.MAGES>=5){get("magesButton").style.display="inline"}else{get("magesButton").style.display="none"}};MD.getMageDamage=function(){var a=MD.MAGE_DAMAGE;a*=(MD.hasUpgrade("Magic!")?MD.uv.level1mult:1)*(MD.hasUpgrade("Dumbledore's Finest")?MD.uv.level2mult:1)*(MD.hasUpgrade("Merlin")?MD.uv.level3mult:1)*(MD.hasUpgrade("Deity-ish")?MD.uv.level4mult:1);a*=(MD.hasMageUpgrade("Enhanced Fireballs")?MD.uv.level1mult:1)*(MD.hasMageUpgrade("Lightning Torrent")?MD.uv.level2mult:1)*(MD.hasMageUpgrade("Heaven's Fury")?MD.uv.level3mult:1)*(MD.hasMageUpgrade("Insecticide")?MD.uv.level4mult:1)*(MD.hasMageUpgrade("Supercharged")?MD.uv.level5mult:1)*(MD.hasMageUpgrade("FIRE!")?MD.uv.level5mult:1)*(MD.hasMageUpgrade("Secrets of Old")?MD.uv.level6mult:1)*(MD.hasMageUpgrade("Ancient Wisdom")?MD.uv.level7mult:1);a*=(1+MD.getMageAuraMult());a*=Math.pow(MD.CONSTRUCT_LEVELS[15]+1,1.6);a*=(MD.hasUpgrade("Amplificatory Armor")?Math.max(1,Math.pow(1.02,MD.TIMES_FORTIFIED)):1);a*=(MD.hasUpgrade("Volcanic Fury")?2:1)*(MD.hasUpgrade("Thunder of Death")?8:1);return a};MD.getMagesMeditating=function(){var a=0.005;if(MD.hasMageUpgrade("Magical Optimization")){a*=MD.uv.meditatelevel1}if(MD.hasMageUpgrade("Spell of Focus")){a*=MD.uv.meditatelevel2}if(MD.hasMageUpgrade("Current of Nature")){a*=MD.uv.meditatelevel3}if(MD.hasMageUpgrade("WIND!")){a*=MD.uv.meditatelevel4}a*=MD.getManaMultiplier();if(MD.hasMageUpgrade("Neurobacklash")){a+=(MD.uv.neuropercent2/100)*MD.getChrysalisProduction()}else{if(MD.hasMageUpgrade("Neurofeedback")){a+=(MD.uv.neuropercent1/100)*MD.getChrysalisProduction()}}a*=MD.getMageTowerMult();a*=(1+MD.getMageAuraMult());a*=Math.pow(MD.CONSTRUCT_LEVELS[15]+1,1.6);if(MD.hasUpgrade("Volcanic Fury")){a*=2}return MD.MAGES_MEDITATING*a};MD.getMagesDelving=function(){var a=0.5;a*=(MD.hasMageUpgrade("Delving Mastery")?MD.uv.level1mult:1)*(MD.hasMageUpgrade("Power Overwhelming")?MD.uv.level2mult:1)*(MD.hasMageUpgrade("Midas Reborn")?MD.uv.level3mult:1)*(MD.hasMageUpgrade("WATER!")?MD.uv.level4mult:1)*(MD.hasMageUpgrade("Delving Perfection")?MD.uv.level5mult:1)*(MD.hasMageUpgrade("Delving Transcendence")?MD.uv.level6mult:1);a*=(1+MD.getMageAuraMult());a*=Math.pow(MD.CONSTRUCT_LEVELS[15]+1,1.6);if(MD.hasUpgrade("Volcanic Fury")){a*=2}return MD.MAGES_DELVING*a};MD.getMageGemChance=function(){var a=(MD.hasMageUpgrade("Algorithmic Sparkle Isolation")?MD.uv.gemFindPerMage2:MD.uv.gemFindPerMage1);a=(MD.hasMageUpgrade("Glowing Mind's Eye")?MD.uv.gemFindPerMage3:a);a=(MD.hasMageUpgrade("Gems For Days!")?MD.uv.gemFindPerMage4:a);a=(MD.hasMageUpgrade("EARTH!")?MD.uv.gemFindPerMage5:a);if(MD.hasMageUpgrade("Ruby Affinity")){a*=2}if(MD.hasMageUpgrade("Sapphire Affinity")){a*=2}if(MD.hasMageUpgrade("Emerald Affinity")){a*=2}if(MD.hasMageUpgrade("Topaz Affinity")){a*=2}a=MD.MAGES_DELVING*a;return a};MD.checkMageGems=function(){if(MD.hasMageUpgrade("Advanced Delving Techniques")){var b=MD.getMageGemChance();var a=Math.floor(b/100);a+=(tryPercentChance(b%100));if(a>0){amt=MD.getMageGemAmount()*a;var d=0;if(MD.hasMageUpgrade("Old Pros")){d=7}else{if(MD.hasMageUpgrade("Bein' Awesome")){d=5}else{if(MD.hasMageUpgrade("Lookin' Hard")){d=4}else{if(MD.hasMageUpgrade("Gettin' Lucky")){d=2}}}}var c=MD.getGaussianGem(d,1.5,amt);if(c==false){MD.findGem(0,amt)}if(b<3){MDART.notify("Your mages have found a gem!")}}}};MD.getMageGemAmount=function(){var a=(MD.hasMageUpgrade("Crystal Underground")?MD.uv.gemMult1:1);a=(MD.hasMageUpgrade("Penticity")?MD.uv.gemMult2:a);if(MD.hasUpgrade("Learn from the Fallen")){a*=MD.convals.goblinSacrificedFormula(MD.GOBLINS_SACRIFIED)}if(MD.hasUpgrade("Volcanic Fury")){a*=2}if(MD.activeDragon("Eternal")){a*=2}if(MD.activeDragon("Imperial")){a*=4}return a};MD.processMages=function(){var a=[];var c;for(c=0;c<MD.GOBLIN_PRESENT.length;c++){if(MD.GOBLIN_PRESENT[c]==true){a.push(["G",c])}}for(c=0;c<MD.SPIDER_PRESENT.length;c++){if(MD.SPIDER_PRESENT[c]==true){a.push(["S",c])}}if(a.length!=0){var e=a.sort(function(){return 0.5-Math.random()});var b=MD.MAGES_FIGHTING*MD.getMageDamage();for(c=0;c<e.length&&b>0;c++){var d;if(e[c][0]=="G"){d=Math.min(b,MD.GOBLIN_OBJECT[e[c][1]].hp);MD.damageGoblin(e[c][1],d,"mage");b-=d}else{if(e[c][0]=="S"){d=Math.min(b,MD.SPIDER_OBJECT[e[c][1]].hp);MD.damageSpider(e[c][1],d,"mage");b-=d}}}}var f=MD.getMagesMeditating();MD.changeMana(f)};MD.clickMage=function(b){if(MD.hasUpgrade("Instant Power")){var a=MD.MAX_MAGE_AURA}else{var a=(MD.hasUpgrade("Mana Overcharge")?3:1)}MD.MAGE_AURA_LEVEL[b]=Math.min(MD.MAGE_AURA_LEVEL[b]+a,MD.MAX_MAGE_AURA);MD.updateAuraDisplay();MDART.updateUnits()};MD.getMageAuraMult=function(){if(MD.MAGES>0){var a=Math.min(Math.ceil(MD.MAGES/5),6);var b=(sumArray(MD.MAGE_AURA_LEVEL)/(a*MD.MAX_MAGE_AURA))*(MD.hasUpgrade("Dark Portents")?MD.MAX_AURA_MULT*2:MD.MAX_AURA_MULT);return b/100}else{return 0}};MD.updateAuraDisplay=function(){var a=Math.min(Math.ceil(MD.MAGES/5),6);var b=(sumArray(MD.MAGE_AURA_LEVEL)/(a*MD.MAX_MAGE_AURA))*100;get("auradisplay").innerHTML="Current Mage Power: "+Math.round(b)+"%."};MD.updateAuraTime=function(){if(MD.MAGES>0){var a=Math.min(Math.ceil(MD.MAGES/5),6);if(sumArray(MD.MAGE_AURA_LEVEL)>=(a*MD.MAX_MAGE_AURA*0.8)){MD.MAGE_MAX_TIME++}}};MD.decrementAuras=function(){for(var a=0;a<MD.MAGE_AURA_LEVEL.length;a++){MD.MAGE_AURA_LEVEL[a]=Math.max(0,MD.MAGE_AURA_LEVEL[a]-1)}MD.updateAuraDisplay()};MD.updateMagePage=function(){MD.MAGES_FIGHTING=MD.MAGES-(MD.MAGES_MEDITATING+MD.MAGES_DELVING);MD.checkMageAmounts();get("totalmages").innerHTML="Total Mages: "+s(MD.MAGES);get("magesfighting").innerHTML="Mages Fighting: "+s(MD.MAGES_FIGHTING);get("fightingdesc").innerHTML=s(MD.MAGES_FIGHTING)+((MD.MAGES_FIGHTING==1)?" mage":" mages")+" dealing "+s(MD.MAGES_FIGHTING*MD.getMageDamage())+" damage per second.";get("magesmeditating").innerHTML="Mages Meditating: "+s(MD.MAGES_MEDITATING);get("meditatingdesc").innerHTML=s(MD.MAGES_MEDITATING)+((MD.MAGES_MEDITATING==1)?" mage":" mages")+" meditating to produce "+s(MD.getMagesMeditating())+" mana per second.";get("magesdelving").innerHTML="Mages Delving: "+s(MD.MAGES_DELVING);get("delvingdesc").innerHTML=s(MD.MAGES_DELVING)+((MD.MAGES_DELVING==1)?" mage":" mages")+" finding "+s(MD.getMagesDelving())+"% more gold per second.";get("delvinggemfind").innerHTML="Your delving mages have a "+s(MD.getMageGemChance())+"% chance of finding "+s(MD.getMageGemAmount()*MD.getResMult("Gems"))+" "+(MD.getMageGemAmount()==1?"gem":"gems")+" each second.";get("mageexp").innerHTML="Mana: "+s(MD.MANA);MD.updateManaCounter();MD.updateMageUpgradeButtons();MD.updateImbueOptions()};MD.updateManaCounter=function(){if(MD.TOTAL_MANA>0){get("manadisplay").innerHTML="Mana: "+s(MD.MANA)}else{get("manadisplay").innerHTML=""}};MD.updateImbueOptions=function(){$("#imbue-div").toggle(MD.hasUpgrade("Dark Portents"));var e=MD.IMBUEMENT_BUY_MODES[MD.IMBUEMENT_BUY_MODE];var c=get("imbue-buy-number");c.innerHTML=" - "+e+" levels per click.";if(MD.hasUpgrade("Dark Portents")){for(var b=0;b<MD.HIRELINGS.length;b++){var a=get("imbue"+b);if(MD.HIRELINGS[b].unlock_function()&&MD.HIRELINGS[b].imbue_cost!==0){var f=MD.getImbueCost(b);var d="Imbue your "+MD.HIRELINGS[b].plural+" with a "+roundTenth(1+MD.IMBUEMENT_LEVEL[b]*0.2+0.2)+" times multiplier. ("+s(f)+" Mana)";a.innerHTML=d;$("#imbue"+b).toggleClass("unaffordable",f>MD.MANA);a.style.display="inline"}else{a.style.display="none"}}}};MD.getImbueCost=function(a){return Math.floor(MD.HIRELINGS[a].imbue_cost*Math.pow(MD.IMBUE_MULTIPLIER,MD.IMBUEMENT_LEVEL[a]))};MD.imbue=function(a){var c=MD.IMBUEMENT_BUY_MODES[MD.IMBUEMENT_BUY_MODE];c=(c=="Max"?Infinity:c);var b=0;while(b<c&&MD.MANA>=MD.getImbueCost(a)){MD.changeMana(-MD.getImbueCost(a));MD.IMBUEMENT_LEVEL[a]++;MD.updateImbueOptions();b++}};MD.changeImbueBuyMode=function(){MD.IMBUEMENT_BUY_MODE=(MD.IMBUEMENT_BUY_MODE+1)%MD.IMBUEMENT_BUY_MODES.length;MD.updateImbueOptions()};MD.addMage=function(a){var b=[MD.MAGES_FIGHTING,MD.MAGES_MEDITATING,MD.MAGES_DELVING];if(a=="fighting"){MD.increaseMageAmount(0,b)}else{if(a=="meditating"){MD.increaseMageAmount(1,b)}else{if(a=="delving"){MD.increaseMageAmount(2,b)}}}MD.MAGES_FIGHTING=b[0];MD.MAGES_MEDITATING=b[1];MD.MAGES_DELVING=b[2];MD.updateMagePage()};MD.removeMage=function(a){var b=[MD.MAGES_FIGHTING,MD.MAGES_MEDITATING,MD.MAGES_DELVING];if(a=="fighting"&&b[0]>0){MD.decreaseMageAmount(0,b)}else{if(a=="meditating"&&b[1]>0){MD.decreaseMageAmount(1,b)}else{if(a=="delving"&&b[2]>0){MD.decreaseMageAmount(2,b)}}}MD.MAGES_FIGHTING=b[0];MD.MAGES_MEDITATING=b[1];MD.MAGES_DELVING=b[2];MD.updateMagePage()};MD.resetMageMove=function(){get("mage-move-amt").value=""};MD.increaseMageAmount=function(c,d){var a=1;if(MD.multibuyActive()){a=10}if(get("mage-move-amt").value!=""){a=Math.floor(Math.max(1,Number(get("mage-move-amt").value)))}for(var b=0;b<d.length;b++){if(b!=c){if(d[b]>0){a=Math.min(a,d[b]);d[b]-=a;d[c]+=a;break}}}};MD.decreaseMageAmount=function(c,d){var a=1;if(MD.multibuyActive()){a=10}if(get("mage-move-amt").value!=""){a=Math.floor(Math.max(1,Number(get("mage-move-amt").value)))}for(var b=0;b<d.length;b++){if(b!=c){a=Math.min(a,d[c]);d[b]+=a;d[c]-=a;break}}};MD.checkMageAmounts=function(){if(MD.MAGES_FIGHTING<0){num=Math.min(-MD.MAGES_FIGHTING,MD.MAGES_MEDITATING);if(num){MD.MAGES_FIGHTING+=num;MD.MAGES_MEDITATING-=num}}if(MD.MAGES_FIGHTING<0){num=Math.min(-MD.MAGES_FIGHTING,MD.MAGES_DELVING);if(num){MD.MAGES_FIGHTING+=num;MD.MAGES_DELVING-=num}}};MD.getManaMultiplier=function(){var b=1;for(var a=70;a<81;a++){b*=(MD.hasUpgrade(MD.getUpgradeById(a).name)?MD.uv.manamult:1)}for(var a=82;a<93;a++){b*=(MD.hasUpgrade(MD.getUpgradeById(a).name)?MD.uv.manamult:1)}b*=(MD.hasUpgrade(MD.getUpgradeById(110).name)?MD.uv.manamult:1);b*=(MD.hasUpgrade(MD.getUpgradeById(111).name)?MD.uv.manamult:1);return b};MD.changeMana=function(a){a*=((a>0)?MD.getResMult("Basic"):1);MD.MANA+=a;if(a>0){MD.TOTAL_MANA+=a}MD.updateManaCounter()};MD.hasMana=function(a){return MD.MANA>=a};MD.getMana=function(){return MD.MANA};MD.hasMageUpgrade=function(a){for(var b=0;b<MD.ACTIVE_MAGE_UPGRADES.length;b++){var c=MD.getMageUpgradeById(MD.ACTIVE_MAGE_UPGRADES[b]);if(c.name==a){return true}}return false};MD.getMageUpgradeById=function(b){for(var a=0;a<MD.MAGE_UPGRADES.length;a++){if(MD.MAGE_UPGRADES[a].id==b){return MD.MAGE_UPGRADES[a]}}return null};MD.mageUpgradeSortFunction=function(e,d){var g=MD.getMageUpgradeById(e);var f=MD.getMageUpgradeById(d);var c=MD.ResCompare(g.cost,f.cost);if(c!=0){return c}else{return g.id-f.id}};MD.updateMageUpgradeButtons=function(){var d=MD.AVAILABLE_MAGE_UPGRADES;MD.AVAILABLE_MAGE_UPGRADES=[];var a;for(a=0;a<MD.MAGE_UPGRADES.length;a++){if(MD.MAGE_UPGRADES[a].unlock_function()&&MD.ACTIVE_MAGE_UPGRADES.indexOf(MD.MAGE_UPGRADES[a].id)==-1){MD.AVAILABLE_MAGE_UPGRADES.push(MD.MAGE_UPGRADES[a].id);if(d.indexOf(MD.MAGE_UPGRADES[a].id)==-1&&!MD.INITIALIZING_GAME){MDART.alertBtn("magesButton")}}}MD.AVAILABLE_MAGE_UPGRADES.sort(MD.mageUpgradeSortFunction);var b;for(a=0;a<20;a++){if(a<MD.AVAILABLE_MAGE_UPGRADES.length){b=MD.getMageUpgradeById(MD.AVAILABLE_MAGE_UPGRADES[a]);get("mageupgrade"+a).style.display="inline";get("mageupgrade"+a).innerHTML=b.name[0];var c=$("#mageupgrade"+a);c.toggleClass("unaffordable",!MD.canAfford(b.cost));tipText=b.name+"  -  "+b.effect+" ("+MD.ResPrint(b.cost)+")";MDART.setTooltip(c,"",tipText)}else{get("mageupgrade"+a).style.display="none";get("mageupgrade"+a).title=""}}};MD.buyMageUpgrade=function(a){var b=MD.getMageUpgradeById(MD.AVAILABLE_MAGE_UPGRADES[a]);if(MD.canAfford(b.cost)){MD.spend(b.cost);MD.ACTIVE_MAGE_UPGRADES.push(b.id);MD.updateMageUpgradeButtons();MD.updateUpgradeStats()}};MD.updateAlchButton=function(){if(MD.ALCHEMISTS>=1){get("alchButton").style.display="inline"}else{get("alchButton").style.display="none"}};MD.updateAlchPage=function(){get("alch-potential").innerHTML="Alchemical Speed: "+MD.getAlchemistPotential()+"%";get("total-alchemists").innerHTML="Total Alchemists: "+s(MD.ALCHEMISTS);if(MD.hasUpgrade("Mental Energies")){MD.ALCH_RECIPES[13].amount=15}var e=get("alch-table");for(var b=0;b<MD.ALCH_RECIPES.length;b++){var h=MD.ALCH_RECIPES[b];if(h.unlock_condition()&&$("#alch-row"+b).length==0){var d=e.insertRow($("#alch-table tr").length);d.id="alch-row"+b;var j=d.insertCell(0);j.innerHTML=MD.RESOURCES[h.base_res].print_name;j.id="base-res-text"+b;j=d.insertCell(1);j.innerHTML=MD.RESOURCES[h.final_res].print_name;j.id="final-res-text"+b;j=d.insertCell(2);j.innerHTML=s(h.cost*h.amount)+":"+s(h.yield_amt*h.amount);j.id="alch-ratio-text"+b;j=d.insertCell(3);var g=document.createElement("span");g.innerHTML="0";g.id="alch-row-counter"+b;j.appendChild(g);var a=document.createElement("button");a.innerHTML="-";a.id="alch-row-rem"+b;a.className="btn mage-button";$(a).css("float","right");a.onclick=(function(c){return function(){MD.remAlch(c)}})(b);j.appendChild(a);var f=document.createElement("button");f.innerHTML="+";f.id="alch-row-add"+b;f.className="btn mage-button";$(f).css("float","right");f.onclick=(function(c){return function(){MD.addAlch(c)}})(b);j.appendChild(f);if(!MD.INITIALIZING_GAME){MDART.alertBtn("alchButton")}}}MD.updateAlchCounts()};MD.resetAlchTable=function(){get("alch-table").innerHTML="<thead><tr><th>Reactant</th><th>Product</th><th>Ratio</th><th>Alchemists Working</th></tr>"};MD.getAdjustedRecipeAmount=function(a){var b=(MD.hasUpgrade("Increased Yields")?MD.uv.level1mult:1)*(MD.hasUpgrade("Unequivalent Exchange")?MD.uv.level2mult:1)*(MD.hasUpgrade("Desert Bloom")?MD.uv.level3mult:1);if(MD.hasUpgrade("Getting Hungry")&&MD.ANTS_EATEN>1){b*=MD.uv.alchemistyieldmult()*(MD.hasUpgrade("Hound's Best Friend")?2:1)}return MD.ALCH_RECIPES[a].amount*b*MD.ALCH_RECIPES[a].yield_amt*(MD.CONSTRUCT_LEVELS[17]+1)};MD.processAlchemists=function(){var a=MD.getAlchemistPotential()/100;for(var f=0;f<MD.ALCH_RECIPES.length;f++){var d=MD.ALCH_RECIPES[f];if(d.unlock_condition()&&$("#alch-row"+f).length!=0){var j=MD.ALCH_ARRAY[f]*d.amount*d.cost;var b=MD.ALCH_ARRAY[f]*MD.getAdjustedRecipeAmount(f);var e=MD.ALCH_ARRAY[f]*a*d.amount*d.cost;var h=MD.ALCH_ARRAY[f]*a*MD.getAdjustedRecipeAmount(f);var g=MD.RESOURCES[d.base_res];var c=MD.RESOURCES[d.final_res];if(MD.hasMageUpgrade("Crystallizing Influence")&&d.base_res=="large ant"&&d.final_res=="normal"){get("final-res-text1").innerHTML="Great Gems";c=MD.RESOURCES.great;MD.ALCH_RECIPES[f].final_res="great";MD.updateAlchRow(f)}if(MD.hasUpgrade("Mental Energies")&&d.base_res=="dirt"&&d.final_res=="mana"){e*=5;h*=5}if(g.check_function(e)){if(d.base_res=="dirt"&&d.final_res=="mana"){MD.DIRT_TO_MANA+=e}g.change_function(-e);c.change_function(h)}else{if(g.check_function(j)){g.change_function(-j);c.change_function(b);if(d.base_res=="dirt"&&d.final_res=="mana"){MD.DIRT_TO_MANA+=j}}}}}};MD.updateAlchCounts=function(a){get("total-alchemists").innerHTML="Total Alchemists: "+s(MD.ALCHEMISTS)+" ("+s(MD.alchemistsAvailable())+" available)";for(var a=0;a<MD.ALCH_RECIPES.length;a++){if($("#alch-row"+a).length!=0){MD.updateAlchRow(a)}}};MD.updateAlchRow=function(g){var f=MD.ALCH_RECIPES[g];var d=MD.RESOURCES[f.final_res];var b=MD.RESOURCE_MULT_LABELS[MD.RESOURCE_SECTION_NAMES.indexOf(d.type)];var c=MD.getResMult(b);var a=MD.ALCH_ARRAY[g]*(MD.getAlchemistPotential()/100)*MD.getAdjustedRecipeAmount(g)*c;var e=MD.ALCH_ARRAY[g]*(MD.getAlchemistPotential()/100)*f.amount*f.cost;var h=MD.RESOURCES[MD.ALCH_RECIPES[g].base_res];get("alch-ratio-text"+g).innerHTML=s(MD.ALCH_RECIPES[g].cost*MD.ALCH_RECIPES[g].amount)+":"+s(MD.getAdjustedRecipeAmount(g));get("alch-row-counter"+g).innerHTML=s(MD.ALCH_ARRAY[g])+" (Creating "+s(a)+" "+d.print_name+" per second from "+s(e)+" "+h.print_name+")"};MD.alchemistsAvailable=function(){return MD.ALCHEMISTS-sumArray(MD.ALCH_ARRAY)};MD.addAlch=function(b){var a=MD.multibuyActive()?Math.min(10,MD.alchemistsAvailable()):1;a=(get("alch-move-amt").value!=""?Math.floor(Math.min(Number(get("alch-move-amt").value),MD.alchemistsAvailable())):a);a=Math.max(1,a);if(MD.alchemistsAvailable()>0){MD.ALCH_ARRAY[b]+=a;MD.updateAlchRow(b);get("total-alchemists").innerHTML="Total Alchemists: "+s(MD.ALCHEMISTS)+" ("+s(MD.alchemistsAvailable())+" available)"}};MD.remAlch=function(b){var a=MD.multibuyActive()?Math.min(10,MD.ALCH_ARRAY[b]):1;a=(get("alch-move-amt").value!=""?Math.floor(Math.min(Number(get("alch-move-amt").value),MD.ALCH_ARRAY[b])):a);a=Math.max(1,a);if(MD.ALCH_ARRAY[b]>0){MD.ALCH_ARRAY[b]-=a;MD.updateAlchRow(b);get("total-alchemists").innerHTML="Total Alchemists: "+s(MD.ALCHEMISTS)+" ("+s(MD.alchemistsAvailable())+" available)"}};MD.resetAlchMove=function(){get("alch-move-amt").value=""};MD.setAlchemistButton=function(){if(MD.hasStructure("Alchemist's Lair")){if(get("hirealchemistbutton").style.display=="none"){MDART.alertTab("defense")}get("hirealchemistbutton").style.display="inline";var c=MD.ResMult(MD.ALCHEMIST_START_COST,Math.pow(MD.ALCH_MULTIPLIER,MD.ALCHEMISTS));get("hirealchemistbutton").innerHTML="Hire Alchemist ("+MD.ResPrint(c)+")";var a=$("#hirealchemistbutton");a.toggleClass("unaffordable",!MD.canAfford(c));var b="Hire an alchemist for all your conversion needs. ("+s(MD.ALCHEMISTS)+" hired)";MDART.setTooltip(a,"",b)}else{get("hirealchemistbutton").style.display="none"}};MD.hireAlchemist=function(){var a=MD.multibuyActive()?10:1;var b=MD.ResMult(MD.ALCHEMIST_START_COST,Math.pow(MD.ALCH_MULTIPLIER,MD.ALCHEMISTS));while(MD.canAfford(b)&&a>0){MD.spend(b);MD.ALCHEMISTS++;MD.setAlchemistButton();get("total-alchemists").innerHTML="Total Alchemists: "+s(MD.ALCHEMISTS)+" ("+s(MD.alchemistsAvailable())+" available)";var b=MD.ResMult(MD.ALCHEMIST_START_COST,Math.pow(MD.ALCH_MULTIPLIER,MD.ALCHEMISTS));a--}};MD.getAlchemistPotential=function(){var b=0;for(var a=118;a<130;a++){if(MD.hasUpgrade(MD.getUpgradeById(a).name)){b+=10}}b*=(MD.hasUpgrade("Alchemical Furor")?MD.uv.level1mult:1)*(MD.hasUpgrade("Philosopher's Stone")?MD.uv.level2mult:1)*(MD.hasUpgrade("The Elric Brothers")?MD.uv.level3mult:1)*(MD.hasUpgrade("Flying Sparks")?MD.uv.level4mult:1)*(MD.hasUpgrade("Higher Learning")?MD.uv.level5mult:1);b*=(MD.hasUpgrade("Eye of the Hurricane")?2:1);return b};MD.updateStructureButtons=function(){var a=false;for(var d=0;d<MD.STRUCTURES.length;d++){var b=MD.STRUCTURES[d];var c=get("structure"+d);var e=$("#structures-div");if(b.unlock_function()&&!MD.hasStructure(b.name)){a=true;if(c.style.display=="none"){MDART.alertTab("shop");c.style.display="inline";e.toggle(true)}c.innerHTML=b.name;MDART.setTooltip($(c),"",b.desc+" ("+MD.ResPrint(b.cost)+")");$(c).toggleClass("unaffordable",!MD.canAfford(b.cost))}else{c.style.display="none";e.toggle(false)}}get("structuresection").style.display=(a?"inline":"none")};MD.buyStructure=function(a){if(MD.canAfford(MD.STRUCTURES[a].cost)){MD.spend(MD.STRUCTURES[a].cost);MD.BUILDINGS_ACTIVE.push(a);MD.updateStructureButtons()}};MD.hasStructure=function(a){for(var b=0;b<MD.BUILDINGS_ACTIVE.length;b++){if(MD.STRUCTURES[MD.BUILDINGS_ACTIVE[b]].name==a){return true}}return false};MD.hasUpgrade=function(a){if(MD.UPGRADE_CACHE[a]===true){return true}for(var b=0;b<MD.ACTIVE_UPGRADES.length;b++){var c=MD.getUpgradeById(MD.ACTIVE_UPGRADES[b]);if(c.name==a){MD.UPGRADE_CACHE[a]=true;return true}}return false};MD.getUpgradeById=function(a){if(a in MD.UPGRADE_ID_LOOKUP){return MD.UPGRADES[MD.UPGRADE_ID_LOOKUP[a]]}else{return null}};MD.initializeUpgradeLookup=function(){for(var a=0;a<MD.UPGRADES.length;a++){MD.UPGRADE_ID_LOOKUP[MD.UPGRADES[a].id]=a}};MD.upgradeUnlocked=function(a){return MD.UNLOCKED_UPGRADES.indexOf(a)!=-1};MD.checkUpgradeAvailablility=function(){for(var a=0;a<MD.UPGRADES.length;a++){var b=MD.UPGRADES[a];if(!MD.upgradeUnlocked(b.id)&&b.unlock_function()){MDART.alertTab("upgrade");MD.UNLOCKED_UPGRADES.push(b.id);MD.AVAILABLE_UPGRADES.push(b.id)}}};MD.upgradeSortFunction=function(e,d){var g=MD.getUpgradeById(e);var f=MD.getUpgradeById(d);var c=MD.ResCompare(g.cost,f.cost);if(c!=0){return c}else{return g.id-f.id}};MD.updateUpgradeButtons=function(){MD.AVAILABLE_UPGRADES.sort(MD.upgradeSortFunction);for(var b=0;b<50;b++){if(b<MD.AVAILABLE_UPGRADES.length){var d=MD.getUpgradeById(MD.AVAILABLE_UPGRADES[b]);var c=MD.getUpgradeCost(MD.AVAILABLE_UPGRADES[b]);get("buyupgrade"+b).style.display="inline";var e=$("#buyupgrade"+b);e.toggleClass("special-upgrade-button",d.type=="nightmare");e.toggleClass("progress-upgrade-button",d.type=="progress");e.toggleClass("dragon-upgrade-button",d.type=="dragon");get("buyupgrade"+b).innerHTML=d.name[0];e.toggleClass("unaffordable",!MD.canAfford(c));var a=d.name+"  -  "+d.effect+" ("+MD.ResPrint(c)+")";MDART.setTooltip(e,"",a)}else{get("buyupgrade"+b).style.display="none";get("buyupgrade"+b).title=""}}};MD.updateUpgradeStats=function(){MD.ACTIVE_UPGRADES.sort(MD.upgradeSortFunction);var a=0;var c=Boolean(get("displayupgrade"+a));while(c||a<MD.ACTIVE_UPGRADES.length){if(!c){MDART.createButton("upgrade-display","displayupgrade"+a,"btn round-btn upgrade-button","",null)}if(a<MD.ACTIVE_UPGRADES.length){upgrade=MD.getUpgradeById(MD.ACTIVE_UPGRADES[a]);get("displayupgrade"+a).style.display="inline";get("displayupgrade"+a).innerHTML=upgrade.name[0];displayBtn=$("#displayupgrade"+a);displayBtn.toggleClass("special-upgrade-button",upgrade.type=="nightmare");displayBtn.toggleClass("progress-upgrade-button",upgrade.type=="progress");displayBtn.toggleClass("dragon-upgrade-button",upgrade.type=="dragon");tipText=upgrade.name+"  -  "+upgrade.description+" - "+upgrade.effect;MDART.setTooltip(displayBtn,"",tipText)}else{get("displayupgrade"+a).style.display="none";get("displayupgrade"+a).title=""}a++;c=Boolean(get("displayupgrade"+a))}var b=MD.getRemainingUpgrades();b.sort(MD.upgradeSortFunction);a=0;c=Boolean(get("upgraderemaining"+a));while(c||a<b.length){if(!c){MDART.createButton("upgrades-remaining","upgraderemaining"+a,"btn round-btn upgrade-button","",null)}if(a<b.length){upgrade=MD.getUpgradeById(b[a]);get("upgraderemaining"+a).style.display="inline";get("upgraderemaining"+a).innerHTML=upgrade.name[0];displayBtn=$("#upgraderemaining"+a);tipText=upgrade.name+"  -  "+upgrade.description;MDART.setTooltip(displayBtn,"",tipText)}else{get("upgraderemaining"+a).style.display="none";get("upgraderemaining"+a).title=""}a++;c=Boolean(get("upgraderemaining"+a))}a=0;c=Boolean(get("magepurchased"+a));while(c||a<MD.ACTIVE_MAGE_UPGRADES.length){if(!c){MDART.createButton("mageupgrade-display","magepurchased"+a,"btn round-btn spell-button","",null)}if(a<MD.ACTIVE_MAGE_UPGRADES.length){upgrade=MD.getMageUpgradeById(MD.ACTIVE_MAGE_UPGRADES[a]);get("magepurchased"+a).style.display="inline";get("magepurchased"+a).innerHTML=upgrade.name[0];displayBtn=$("#magepurchased"+a);tipText=upgrade.name+"  -  "+upgrade.effect;MDART.setTooltip(displayBtn,"",tipText)}else{get("magepurchased"+a).style.display="none";get("magepurchased"+a).title=""}a++;c=Boolean(get("magepurchased"+a))}};MD.getRemainingUpgrades=function(){MD.ACTIVE_UPGRADES.sort(function(e,d){return e-d});var b=[];var c=0;for(var a=0;a<MD.ACTIVE_UPGRADES.length;a++){while(c<MD.ACTIVE_UPGRADES[a]){b.push(c);c+=1}c+=1}while(c<MD.UPGRADES.length){b.push(c);c+=1}return b};MD.buyUpgrade=function(e){var f=MD.getUpgradeById(MD.AVAILABLE_UPGRADES[e]);var d=MD.getUpgradeCost(MD.AVAILABLE_UPGRADES[e]);if(MD.canAfford(d)){if(f.name=="Delve Greedily"){MDART.notify("You hear the distant sound of goblin drums.")}else{if(f.name=="Embrace The Swarm"){MDART.notify("Your skin begins to crawl.")}else{if(f.name=="Dark Portents"){MDART.notify("The air seems to grow thicker.")}else{if(f.name=="Oracle"){MD.ORACLE_CLICK_GUIDE=true;setTimeout(function(){MD.ORACLE_CLICK_GUIDE=false},20000)}else{if(f.name=="Agriculture"||f.name=="Irrigation"){var a=[8,12,13];for(var c=0;c<a.length;c++){get("farm-txt"+a[c]).innerHTML="Harvest Data: "+s(MD.getFarmProduction(a[c])*MD.getResMult("Raw Materials"))+" food every "+MD.convals.farmtime1+" seconds ("+s((MD.getFarmProduction(a[c])*MD.getResMult("Raw Materials"))/MD.convals.farmtime1)+" per second)"}MDART.drawConstructs()}else{if(f.name=="Auto-Rift 9000"){$("#auto-sacrifice-btn").toggle(true)}else{if(f.name=="Auto-Auto-Rift 9000"){$("#auto-auto-btn").toggle(true)}}}}}}}MD.spend(d);var b=MD.AVAILABLE_UPGRADES[e];MD.AVAILABLE_UPGRADES.splice(e,1);MD.ACTIVE_UPGRADES.push(b);MD.UPGRADES_BOUGHT+=1;MD.updateUpgradeButtons();MD.updateStats();MD.updateUpgradeStats()}};MD.getUpgradeCost=function(b){var a=MD.getUpgradeById(b).cost;if(MD.hasUpgrade("A Fan of Upgrades")){a=MD.ResMult(a,(100-MD.uv.upgradereduction)/100)}return a};MD.dig=function(b,g,d){var c=typeof d==="undefined";d=setDefault(d,1);var a=MD.getPickStrength();MD.changeGold(a*d);if(c){MDART.addClickEffect("gold",b,g,"+"+s(a)+" gold")}if(c){MD.MANUAL_CLICKS+=d}else{MD.AUTO_CLICKS+=d}MD.CLICKS_THIS_TICK+=d;if(tryPercentChance(0.1*MD.PICK_LEVEL*d)&&MD.TICKS>=600){var f=tryPercentChance(10)?1:0;MD.findGem(f);if(MD.TOTAL_GEMS<500){MDART.notify("You found a "+MD.GEM_OBJECTS[f].name.toLowerCase()+" gem!")}}var e=(MD.PICK_LEVEL>=16?10:1);e=(MD.PICK_LEVEL>=18?100:e);MD.getGaussianGem(MD.PICKS[MD.PICK_LEVEL].gem_mean,MD.PICKS[MD.PICK_LEVEL].gem_std,e*d);if(MD.PICK_LEVEL>=17){MD.changeSteel((MD.PICK_LEVEL-16)*10*d);if(tryPercentChance(10)){MD.changeAdamantium((MD.PICK_LEVEL-16)*100*(MD.CONSTRUCT_LEVELS[19]+1)*d)}}};MD.findGem=function(a,b){a=setDefault(a,0);b=setDefault(b,1);MD.changeGems(a,b);MD.updateGems();MD.updateSocketDropDowns()};MD.getGaussianGem=function(a,c,d){d=setDefault(d,1);var b=gaussianRandom(a,c);if(b<0){return false}else{b=Math.round(b);b=Math.max(Math.min(MD.GEM_OBJECTS.length-1,b),0);MD.findGem(b,d);return true}};MD.changeGems=function(a,c,b){c*=((c>0&&typeof(b)=="undefined")?MD.getResMult("Gems"):1);MD.GEMS[a]+=c;if(c>0){MD.TOTAL_GEMS+=c}};MD.hasGems=function(a,b){return MD.GEMS[a]>=b};MD.getGems=function(a){return MD.GEMS[a]};MD.updateGems=function(){if(MD.TOTAL_GEMS>0){get("gemscount").innerHTML="Gems: "+s(Math.round(sumArray(MD.GEMS)))}else{get("gemscount").innerHTML=""}var b=false;for(var a=0;a<MD.GEM_OBJECTS.length;a++){var c=get("sellgem"+a);if(MD.GEMS[a]>0||MD.TOTAL_GEMS>=n("1M")){b=true;c.style.display="inline";c.innerHTML="Sell "+MD.GEM_OBJECTS[a].name+" Gem ("+s(MD.GEM_OBJECTS[a].value)+" gold) <br>"+s(MD.GEMS[a])+" Owned";if(MD.TOTAL_GEMS>=n("1M")){$(c).toggleClass("unaffordable",MD.GEMS[a]===0)}}else{c.style.display="none"}}if(b){get("sellgemsection").style.display="inline"}else{get("sellgemsection").style.display="none"}};MD.sellGem=function(a){if(MD.GEMS[a]>=1){var b=MD.GEM_OBJECTS[a].value;MD.changeGold(b);MD.changeGems(a,-1);MD.GEMS_SOLD++;MD.updateGems();MD.updateSocketDropDowns()}};MD.Goblin=function(c,b){this.id=c;this.lvl=b;this.strength=b*9;this.hp=50+b*5;this.maxhp=this.hp;this.name=MD.getGoblinName();if(c<4){this.x=MD.GOBLIN_ROW_1_X}else{this.x=MD.GOBLIN_ROW_2_X}this.y=MD.GOBLIN_START_Y+(c%4)*MD.GOBLIN_INCREMENT_Y;var a=(MD.hasUpgrade("Teenage Rebellion")?10:1);this.rebel=(MD.hasUpgrade("Traitorous Goblins")&&tryPercentChance(a)&&MD.hasHirelings(4,1));if(this.rebel){MD.changeHirelings(4,-1);this.hp*=500;this.maxhp=this.hp;this.strength*=50;this.name+=" The Rebel"}};MD.Spider=function(b,a){this.id=b;this.lvl=a;this.strength=1000+a*15;this.hp=2000+a*10;this.maxhp=this.hp;this.name=MD.getSpiderName();if(this.name.indexOf("Nightmare")!=-1){this.hp*=10;this.maxhp*=10;this.strength*=10}if(b<3){this.y=MD.SPIDER_ROW_1_Y}else{this.y=MD.SPIDER_ROW_2_Y}this.x=MD.SPIDER_START_X+(b%3)*MD.SPIDER_INCREMENT_X};MD.getGoblinName=function(){var b=["Rot","Green","Slime","Filth","Grime","Putrid","Muck","Silt","Slop","Foul","Blight","Mold","Moist"];var a=["face","beard","eyes","heart","back"];return b[getRandom(0,b.length-1)]+a[getRandom(0,a.length-1)]};MD.getSpiderName=function(){var b=["Starbellied","Whitebanded","Whiteknee","Common","Desert","Lattice","Shamrock","Silver","Black","Dewdrop","Funnelweb","Yellowbanded","Pinktoe","Curlyhair","Longlegged","Robber","Tentweb","Burrowing","Marbled","Brown","Lined","Labyrinth","Northern","Filmy","Fringed","Hammock","Striped","Longjawed"];var a=["Spider","Recluse","Jumper","Tarantula","Orbweaver","Widow","Wolf Spider","Antmimic","Dolomedes","Nightmare"];return b[getRandom(0,b.length-1)]+" "+a[getRandom(0,a.length-1)]};MD.startGoblinTimer=function(){var a=getRandom(Math.max(1,MD.GOBLIN_TIME-MD.GOBLIN_TIME_VARIATION),MD.GOBLIN_TIME+MD.GOBLIN_TIME_VARIATION);if(MD.hasUpgrade("Looting Proficiency")){a/=MD.uv.lootingproficiencymult}if(MD.hasUpgrade("Goblin's Bane")){a/=MD.uv.goblinsbanemult}if(MD.hasUpgrade("Goblin's Scourge")){a/=MD.uv.goblinsscourgemult}if(MD.hasUpgrade("Goblin's Terror")){a/=MD.uv.goblinsterrormult}if(MD.GOBLIN_LURE_TIMER>-1){a/=MD.LURES[0].mult}a=Math.max(1,Math.round(a));MD.GOBLIN_TIMER=a;MD.MAX_GOBLIN_TIME=a};MD.startSpiderTimer=function(){var a=getRandom(Math.max(1,MD.SPIDER_TIME-MD.SPIDER_TIME_VARIATION),MD.SPIDER_TIME+MD.SPIDER_TIME_VARIATION);if(MD.hasUpgrade("Covered in Web")){a/=MD.uv.spidermult1}if(MD.hasUpgrade("Eww Eww Eww")){a/=MD.uv.spidermult2}if(MD.hasUpgrade("Arachnid Mangler")){a/=MD.uv.spidermult3}if(MD.hasUpgrade("Shelob Slasher")){a/=MD.uv.spidermult4}a=Math.max(1,Math.round(a));MD.SPIDER_TIMER=a;MD.MAX_SPIDER_TIME=a};MD.updateGoblinTimer=function(){if(MD.hasUpgrade("Delve Greedily")&&MD.GOBLIN_TIMER==-1){MD.startGoblinTimer()}else{if(MD.GOBLIN_TIMER>0){MD.GOBLIN_TIMER--;if(MD.GOBLIN_TIMER==0){MD.triggerGoblinTimer()}}}};MD.updateSpiderTimer=function(){if(MD.hasUpgrade("Embrace The Swarm")&&MD.SPIDER_TIMER==-1){MD.startSpiderTimer()}else{if(MD.SPIDER_TIMER>0){MD.SPIDER_TIMER--;if(MD.SPIDER_TIMER==0){MD.triggerSpiderTimer()}}}};MD.triggerGoblinTimer=function(){var b=[];for(var a=0;a<MD.GOBLIN_PRESENT.length;a++){if(MD.GOBLIN_PRESENT[a]==false){b.push(a)}}if(b.length!=0){a=b[Math.floor(Math.random()*b.length)];MD.GOBLIN_PRESENT[a]=true;var c=getRandom(Math.max(1,MD.GOBLIN_LEVEL-MD.GOBLIN_LEVEL_VARIATION),MD.GOBLIN_LEVEL+MD.GOBLIN_LEVEL_VARIATION);MD.GOBLIN_OBJECT[a]=new MD.Goblin(a,c);if(!MD.hasUpgrade("Goblin's Bane")||tryPercentChance(1)){MDART.notify("A level "+s(Math.ceil(c),true)+" goblin appears!")}}MD.startGoblinTimer()};MD.triggerSpiderTimer=function(){var b=[];for(var a=0;a<MD.SPIDER_PRESENT.length;a++){if(MD.SPIDER_PRESENT[a]==false){b.push(a)}}if(b.length!=0){a=b[Math.floor(Math.random()*b.length)];MD.SPIDER_PRESENT[a]=true;var c=getRandom(Math.max(1,MD.SPIDER_LEVEL-MD.SPIDER_LEVEL_VARIATION),MD.SPIDER_LEVEL+MD.SPIDER_LEVEL_VARIATION);MD.SPIDER_OBJECT[a]=new MD.Spider(a,c);if(!MD.hasUpgrade("Eww Eww Eww")||tryPercentChance(1)){MDART.notify("A level "+s(Math.ceil(c),true)+" spider appears!")}}MD.startSpiderTimer()};MD.respawnGoblins=function(){for(var a=0;a<MD.GOBLIN_PRESENT.length;a++){if(MD.GOBLIN_PRESENT[a]==true){var b=getRandom(Math.max(1,MD.GOBLIN_LEVEL-MD.GOBLIN_LEVEL_VARIATION),MD.GOBLIN_LEVEL+MD.GOBLIN_LEVEL_VARIATION);MD.GOBLIN_OBJECT[a]=new MD.Goblin(a,b)}}};MD.respawnSpiders=function(){for(var a=0;a<MD.SPIDER_PRESENT.length;a++){if(MD.SPIDER_PRESENT[a]==true){var b=getRandom(Math.max(1,MD.SPIDER_LEVEL-MD.SPIDER_LEVEL_VARIATION),MD.SPIDER_LEVEL+MD.SPIDER_LEVEL_VARIATION);MD.SPIDER_OBJECT[a]=new MD.Spider(a,b)}}};MD.processGoblinAttack=function(){for(var a=0;a<MD.GOBLIN_PRESENT.length;a++){if(MD.GOBLIN_PRESENT[a]){if(MD.WALL_LEVEL>0){var b=MD.GOBLIN_OBJECT[a].strength/(MD.activeDragon("Baby")?2:1);MD.WALL_STRENGTH-=b;MD.GOBLIN_DAMAGE+=b;if(MD.WALL_STRENGTH<=0){MD.destroyWall()}}}MD.updateWallMessage()}};MD.processSpiderAttack=function(){for(var a=0;a<MD.SPIDER_PRESENT.length;a++){if(MD.SPIDER_PRESENT[a]){if(MD.WALL_LEVEL>0){MD.WALL_STRENGTH-=MD.SPIDER_OBJECT[a].strength;if(MD.WALL_STRENGTH<=0){MD.destroyWall()}}if(tryPercentChance(Math.min(5,0.1*MD.SPIDER_OBJECT[a].lvl))&&MD.GEMS[0]>=1){MD.changeGems(0,-1);if(!MD.hasUpgrade("Eww Eww Eww")||tryPercentChance(1)){MDART.notify("A spider has destroyed a gem!")}MD.updateGems()}}MD.updateWallMessage()}};MD.clickGoblin=function(b){var a=MD.getPickStrength();MD.damageGoblin(b,a)};MD.clickSpider=function(b){var a=MD.getPickStrength();MD.damageSpider(b,a)};MD.damageGoblin=function(b,c,a){a=typeof a!=="undefined"?a:"click";MD.GOBLIN_OBJECT[b].hp-=c;if(MD.GOBLIN_OBJECT[b].hp<=0){MD.killGoblin(b);if(a=="mage"){var e=1*MD.getManaMultiplier();MD.changeMana(e);MD.GOBLINS_KILLED_BY_MAGES++;MD.updateMagePage()}}MDART.drawGoblin()};MD.damageSpider=function(b,c,a){a=typeof a!=="undefined"?a:"click";MD.SPIDER_OBJECT[b].hp-=c;if(MD.SPIDER_OBJECT[b].hp<=0){MD.killSpider(b);if(a=="mage"){var e=5*MD.getManaMultiplier();MD.changeMana(e);MD.SPIDERS_KILLED_BY_MAGES++;MD.updateMagePage()}}drawSpiders()};MD.killGoblin=function(h){var b=MD.GOBLIN_OBJECT[h].name;var a=MD.GOBLIN_OBJECT[h].lvl;var e=MD.GOBLIN_OBJECT[h].rebel;MD.GOBLIN_OBJECT[h]=null;MD.GOBLIN_PRESENT[h]=false;MD.GOBLINS_KILLED+=1;if(MD.GOBLINS_KILLED%MD.GOBLIN_KILLS_PER_LEVEL==0){MD.GOBLIN_LEVEL+=1}var g=MD.GOBLIN_REWARD*a+getRandom(0,MD.GOBLIN_REWARD*a*(MD.GOBLIN_REWARD_VARIATION/100));if(MD.hasUpgrade("Looting Proficiency")){g*=MD.uv.lootingproficiencymult}if(MD.hasUpgrade("Goblin's Bane")){g*=MD.uv.goblinsbanemult}if(MD.hasUpgrade("Goblin's Scourge")){g*=MD.uv.goblinsscourgemult}if(MD.hasUpgrade("Goblin's Terror")){g*=MD.uv.goblinsterrormult}if(MD.activeDragon("Youngling")||MD.activeDragon("Eternal")){g*=1000}if(e){g*=1000}g=Math.floor(g);MD.changeGold(g);var d="Killed "+b+" the level "+s(Math.ceil(a),true)+" goblin and received "+s(g,true)+" gold!";if(tryPercentChance(Math.min(0.1*MD.GOBLIN_LEVEL,25))){MD.findGem()}if(e){MD.changeDragonscale(getRandom(10,30));MD.changeHirelings(4,3);if(MD.hasUpgrade("Teenage Rebellion")){MD.changeDragonscale(getRandom(100,300));var j=["fire","earth","lightning","water"];var c=MD.activeDragon("Youngling")?5:2;c*=(MD.hasUpgrade("King of the Sky")?10:1);var f=MD.RESOURCES[j[getRandom(0,3)]];f.change_function(c);d+=" You have also absorbed "+s(c*MD.getResMult("Essence"),true)+" "+f.print_name+" from your fallen foe."}}if(!MD.hasUpgrade("Goblin's Bane")||tryPercentChance(1)||e){MDART.notify(d,true)}MD.updateGoblinsKilled();MDART.updateUnits()};MD.killSpider=function(c){var b=MD.SPIDER_OBJECT[c].name;var d=MD.SPIDER_OBJECT[c].lvl;MD.SPIDER_OBJECT[c]=null;MD.SPIDER_PRESENT[c]=false;MD.SPIDERS_KILLED+=1;if(MD.SPIDERS_KILLED%MD.SPIDER_KILLS_PER_LEVEL==0){MD.SPIDER_LEVEL+=1}var a=MD.SPIDER_REWARD*d+getRandom(0,MD.SPIDER_REWARD*d*(MD.SPIDER_REWARD_VARIATION/100));if(MD.hasUpgrade("Covered in Web")){a*=MD.uv.spidermult1}if(MD.hasUpgrade("Eww Eww Eww")){a*=MD.uv.spidermult2}if(MD.hasUpgrade("Arachnid Mangler")){a*=MD.uv.spidermult3}if(MD.hasUpgrade("Shelob Slasher")){a*=MD.uv.spidermult4}a=Math.floor(a);MD.changeGold(a);if(!MD.hasUpgrade("Eww Eww Eww")||tryPercentChance(1)){MDART.notify("Killed a level "+s(Math.ceil(d),true)+" "+b+" and received "+s(a,true)+" gold!")}if(tryPercentChance(Math.min(0.5*MD.SPIDER_LEVEL,50))){MD.findGem(3)}MDART.updateUnits()};MD.updateGoblinsKilled=function(){get("goblinkilledcount").innerHTML="Goblins Killed: "+MD.GOBLINS_KILLED};MD.countGoblins=function(){var b=0;for(var a=0;a<MD.GOBLIN_PRESENT.length;a++){if(MD.GOBLIN_PRESENT[a]){b+=1}}return b};MD.countSpiders=function(){var b=0;for(var a=0;a<MD.SPIDER_PRESENT.length;a++){if(MD.SPIDER_PRESENT[a]){b+=1}}return b};MD.updateOracle=function(){if(MD.hasUpgrade("Oracle")){$("#oracle-div").qtip("enable");var a="Next Goblin Attack: "+getTime(MD.GOBLIN_TIMER)+"<br>";if(MD.SPIDER_TIMER!=-1){a+="Next Spider Attack: "+getTime(MD.SPIDER_TIMER)+"<br>"}if(MD.GOBLIN_LURE_TIMER>0){a+="Remaining Lure Time: "+getTime(MD.GOBLIN_LURE_TIMER)+"<br>"}MDART.setTooltip($("#oracle-div"),"Oracle",a)}else{$("#oracle-div").qtip("disable")}};MD.updateOracleWisdom=function(){var b=0;for(b=0;b<MD.ORACLE_TEACHINGS.length;b++){var a=MD.ORACLE_TEACHINGS[b];if(!a.complete_function()){get("oracle-teaching").innerHTML=a.text;break}}if(b==MD.ORACLE_TEACHINGS.length){get("oracle-teaching").innerHTML="I have no more visions to share - do as you will."}};MD.updateTrapMenu=function(){var e=false;for(var d=0;d<MD.TRAPS.length;d++){var c=get("trap"+d);if(MD.TRAPS[d].unlock_function()){e=true;c.innerHTML="Buy "+MD.TRAPS[d].name+" ("+s(MD.TRAPS[d].base_cost*Math.pow(MD.TRAPS[d].exponent,MD.TRAPS_BOUGHT[d]))+")";var a=$("#trap"+d);a.toggleClass("unaffordable",MD.TRAPS[d].base_cost*Math.pow(MD.TRAPS[d].exponent,MD.TRAPS_BOUGHT[d])>MD.GOLD);var b=MD.TRAPS[d].description;MDART.setTooltip(a,"",b);if(c.style.display=="none"){MDART.alertTab("defense")}c.style.display="inline"}else{c.style.display="none"}}if(e){get("trapsection").style.display="inline";get("resettrap").style.display="inline"}else{get("trapsection").style.display="none";get("resettrap").style.display="none"}};MD.updateLures=function(){var e=false;for(var d=0;d<MD.LURES.length;d++){var c=get("lure"+d);if(MD.LURES[d].unlock_function()){e=true;c.innerHTML="Buy "+MD.LURES[d].name+" ("+s(MD.LURES[d].base_cost*Math.pow(MD.LURES[d].exponent,MD.LURES_BOUGHT[d]))+")";var a=$("#lure"+d);a.toggleClass("unaffordable",MD.LURES[d].base_cost*Math.pow(MD.LURES[d].exponent,MD.LURES_BOUGHT[d])>MD.GOLD);var b=MD.LURES[d].description;MDART.setTooltip(a,"",b);if(c.style.display=="none"){MDART.alertTab("defense")}c.style.display="inline"}else{c.style.display="none"}}if(e){get("luresection").style.display="inline";get("resetlure").style.display="inline"}else{get("luresection").style.display="none";get("resetlure").style.display="none"}};MD.buyTrap=function(b){var a=MD.multibuyActive()?10:1;var c=MD.TRAPS[b].base_cost*Math.pow(MD.TRAPS[b].exponent,MD.TRAPS_BOUGHT[b]);while(MD.GOLD>=c&&a>0){MD.changeGold(-1*c);MD.TRAPS_BOUGHT[b]++;if(b<3){MD.GOBLIN_TIMER+=MD.TRAPS[b].time}else{MD.SPIDER_TIMER+=MD.TRAPS[b].time}if(MD.GOBLIN_TIMER>MD.MAX_GOBLIN_TIME){MD.MAX_GOBLIN_TIME=MD.GOBLIN_TIMER}c=MD.TRAPS[b].base_cost*Math.pow(MD.TRAPS[b].exponent,MD.TRAPS_BOUGHT[b]);a--}MD.updateTrapMenu()};MD.buyLure=function(a){var b=MD.LURES[a].base_cost*Math.pow(MD.LURES[a].exponent,MD.LURES_BOUGHT[a]);if(MD.GOLD>=b){MD.changeGold(-1*b);MD.LURES_BOUGHT[a]++;MD.GOBLIN_LURE_TIMER+=MD.LURES[a].time;MD.GOBLIN_TIMER=-1;MD.updateLures()}};MD.updateLureTimer=function(){if(MD.GOBLIN_LURE_TIMER>=0){MD.GOBLIN_LURE_TIMER--}};MD.resetLures=function(){MD.GOBLIN_LURE_TIMER=-1};MD.resetTraps=function(){if(MD.GOBLIN_TIMER>60){MD.GOBLIN_TIMER=-1}if(MD.SPIDER_TIMER>200){MD.SPIDER_TIMER=-1}MD.updateTrapMenu()};MD.findBuriedTreasure=function(){var f=MD.GOLD/40;var c=MD.GOLD/50;var b=Math.floor(getRandom(f-c,f+c));var a=(MD.hasUpgrade("Gold Forever")?7200*MD.uv.goldforevermult:7200);b=Math.min(b,MD.GOLD_PER_SECOND*a)+72;var d=0;if(MD.hasUpgrade("Gleaming Treasure")){d=Math.floor(getRandom(20,50))}MD.changeGold(b);MD.changeGems(0,d);MD.TREASURES_FOUND++;var e="You found a buried treasure containing "+s(b,true)+" gold";if(d>0){e+=" and "+s(d)+" gems!"}else{e+="!"}MDART.notify(e)};MD.hardDrivePricing=function(){var c=MD.GOLD/10;var b=1;for(;b<6;b++){if(Math.pow(1000,b+1)>c){break}}var a=Math.pow(1000,b);var d=Math.pow(1024,b);MD.changeGold(d);MDART.notify("A confused hard drive vendor claims to give you "+s(a)+" gold but you receive "+s(d)+". It's about time.")};MD.showMenu=function(){MDART.restoreBtn("menuButton");MD.showScreen("menu-area")};MD.showStats=function(){MDART.restoreBtn("statsButton");MD.showScreen("stats-area")};MD.showMages=function(){MDART.restoreBtn("magesButton");MD.showScreen("mage-area")};MD.showCrafting=function(){MDART.restoreBtn("craftingButton");MD.showScreen("crafting-area")};MD.showAlch=function(){MDART.restoreBtn("alchButton");MD.showScreen("alch-area")};MD.showIndustry=function(){MDART.restoreBtn("indButton");MD.showScreen("industry-area")};MD.showMilitary=function(){MDART.restoreBtn("warButton");MD.showScreen("military-area");$("#construct-dialog-9").dialog("close")};MD.showMechanist=function(){MDART.restoreBtn("mechButton");MD.showScreen("mechanist-area");$("#construct-dialog-18").dialog("close")};MD.showDragons=function(){MDART.restoreBtn("dragonButton");MD.showScreen("dragon-area");$("#construct-dialog-22").dialog("close")};MD.showArch=function(){MDART.restoreBtn("libButton");MD.showScreen("arch-area");$("#construct-dialog-24").dialog("close")};MD.showOracleArea=function(){if(MD.hasUpgrade("Oracle")){MD.ORACLE_CLICK_GUIDE=false;MD.showScreen("oracle-area")}};MD.showScreen=function(a){if(MD.CURRENT_SCREEN==a){MD.showCanvas()}else{get(MD.CURRENT_SCREEN).style.zIndex="0";$("#"+MD.CURRENT_SCREEN).toggle(false);MD.CURRENT_SCREEN=a;get(MD.CURRENT_SCREEN).style.zIndex="1";$("#"+MD.CURRENT_SCREEN).toggle(true);get("screen-area").style.overflow="scroll"}};function showExport(b){if(MD.CURRENT_SCREEN=="export-area"){MD.showCanvas()}else{MD.showScreen("export-area");get("export-code").innerHTML=b;var a=$("#export-code");a.focus();a.select()}}MD.showCanvas=function(){if(MD.CURRENT_SCREEN!="canvas-container"){MD.showScreen("canvas-container")}get("screen-area").style.overflow="hidden"};MD.hideAllScreens=function(){$("#menu-area").toggle(false);$("#stats-area").toggle(false);$("#mage-area").toggle(false);$("#alch-area").toggle(false);$("#crafting-area").toggle(false);$("#export-area").toggle(false);$("#oracle-area").toggle(false);$("#industry-area").toggle(false);$("#military-area").toggle(false);$("#mechanist-area").toggle(false);$("#dragon-area").toggle(false);$("#arch-area").toggle(false)};MD.changeNumberSystem=function(){if(MD.NUMBER_SYSTEM=="SS"){MD.setNumberSystem("SI")}else{if(MD.NUMBER_SYSTEM=="SI"){MD.setNumberSystem("SN")}else{MD.setNumberSystem("SS")}}};MD.setNumberSystem=function(a){if(a=="SI"){MD.NUMBER_SYSTEM="SI";get("changeNumberSystem").innerHTML="Number Format: SI Suffixes"}else{if(a=="SS"){MD.NUMBER_SYSTEM="SS";get("changeNumberSystem").innerHTML="Number Format: Short Scale"}else{MD.NUMBER_SYSTEM="SN";get("changeNumberSystem").innerHTML="Number Format: Scientific Notation"}}};MD.bindEvents=function(){$("#pop-amt").on("input",MD.habitationInputChange)};MD.changePurchaseAmount=function(){MD.FORCE_CONTROL=!MD.FORCE_CONTROL;get("changePurchaseAmount").innerHTML="Force Control (Multibuy): "+(MD.FORCE_CONTROL?"Yes":"No")};MD.toggleNotifications=function(){MD.SHOW_NOTIFICATIONS=!MD.SHOW_NOTIFICATIONS;if(MD.SHOW_NOTIFICATIONS){get("disableNotificationButton").innerHTML="Disable Notifications"}else{get("disableNotificationButton").innerHTML="Enable Notifications"}};MD.toggleClickEffects=function(){MD.SHOW_CLICK_EFFECTS=!MD.SHOW_CLICK_EFFECTS;if(MD.SHOW_CLICK_EFFECTS){get("disableEffectsButton").innerHTML="Disable Click Effects"}else{get("disableEffectsButton").innerHTML="Enable Click Effects"}};MD.setupDialogs=function(){var b=500;$("#prep-land-dialog").dialog({title:"Prepare Land",minWidth:b});$("#prep-land-dialog").dialog("close");$("#busy-dialog").dialog({title:"Men At Work",minWidth:b});$("#busy-dialog").dialog("close");$("#start-construction-dialog").dialog({title:"Start Construction",minWidth:b});$("#start-construction-dialog").dialog("close");$("#move-construct-dialog").dialog({title:"Move Structures",minWidth:b});$("#move-construct-dialog").dialog("close");for(var a=0;a<MD.CONSTRUCTS.length;a++){$("#construct-dialog-"+a).dialog({title:MD.CONSTRUCTS[a].name+((MD.CONSTRUCT_LEVELS[a]>0&&a!=7)?(" - Level "+s(MD.CONSTRUCT_LEVELS[a],true)):""),minWidth:b,maxHeight:window.innerHeight});$("#construct-dialog-"+a).dialog("close")}$("#construct-dialog-6").on("dialogbeforeclose",function(c,d){MD.MARKET_DIALOG_OPEN=false})};MD.prepareDropdowns=function(){var a=get("gem-combine-limit");clearSelectBox(a);for(var c=0;c<MD.GEM_OBJECTS.length;c++){var b=document.createElement("option");b.innerHTML=MD.GEM_OBJECTS[c].name;b.value=c;a.appendChild(b)}a.value=MD.GEM_COMBINE_LIMIT};MD.prepareUI=function(){if(MD.SHOW_NOTIFICATIONS){get("disableNotificationButton").innerHTML="Disable Notifications"}else{get("disableNotificationButton").innerHTML="Enable Notifications"}if(MD.SHOW_CLICK_EFFECTS){get("disableEffectsButton").innerHTML="Disable Click Effects"}else{get("disableEffectsButton").innerHTML="Enable Click Effects"}};MD.tick=function(){MD.TICKS++;MD.FAST_TICK_COUNT=0;MD.updateResources();MD.updateUpgrades();MD.updateMages();MD.updateMasons();MD.updateAlchemists();MD.updateCrafting();MD.updateIndustry();MD.updateMilitary();MD.updateMachinist();MD.updateDragons();MD.updateArcaneum();MD.setHirelingButtons();MD.processMages();MD.processGoblinAttack();MD.processSpiderAttack();MD.processMasons();MD.processIndustry();MD.processBlindRevenge();MD.processAutoSacrifice();MD.updateGoblinTimer();MD.updateSpiderTimer();MD.updateLureTimer();MD.updateOracle();MD.updateOracleWisdom();MD.testRandomEvents();MD.updateStats();MD.updateDisplay();MD.updateVisuals();if(MD.TICKS%30==0){MD.autoSave();MDART.updateBackground()}MD.CLICKS_THIS_TICK=0};MD.fast_tick=function(){MDART.drawOracle(MD.GOBLIN_TIMER,MD.SPIDER_TIMER);MD.FAST_TICK_COUNT++};MD.updateResources=function(){MD.processQueens();MD.processChrysalis();MD.processHunters();MD.processWyvernAdamantium();MD.updateGoldPerSecond();MD.processDirtProduction();MD.processSpecialHirelings();MD.delayGold(MD.GOLD_PER_SECOND,10,MD.TICKS)};MD.updateDisplay=function(){MD.updatePickDisplay();MD.updateWallMessage();MD.setBuildWallMessage(MD.WALL_LEVEL+1);MD.setBuyPickMessage(MD.PICK_LEVEL+1);MD.updateStructureButtons();MD.updateTrapMenu();MD.updateLures();MD.updateGems();MD.updateDirtDisplay()};MD.updateUpgrades=function(){MD.checkUpgradeAvailablility();MD.updateUpgradeButtons()};MD.updateStats=function(){get("timeelapsed").innerHTML="Time: "+getTime(MD.TICKS);get("totalgold").innerHTML="Total Gold: "+s(MD.TOTAL_GOLD);get("totalmana").innerHTML=(MD.TOTAL_MANA>0)?"Total Mana: "+s(MD.TOTAL_MANA):"";get("totalimbue").innerHTML=(sumArray(MD.IMBUEMENT_LEVEL)>0)?"Total Imbuements: "+s(sumArray(MD.IMBUEMENT_LEVEL)):"";get("totalgems").innerHTML=(MD.TOTAL_GEMS>0)?"Total Gems: "+s(MD.TOTAL_GEMS):"";get("goblinkilledcount").innerHTML=(MD.GOBLINS_KILLED>0)?"Goblins Killed: "+s(MD.GOBLINS_KILLED):"";get("spiderkilledcount").innerHTML=(MD.SPIDERS_KILLED>0)?"Spiders Killed: "+s(MD.SPIDERS_KILLED):"";get("manualclickcount").innerHTML="Manual Clicks: "+s(MD.MANUAL_CLICKS);get("autoclickcount").innerHTML=(MD.AUTO_CLICKS>0)?"Automatic Clicks: "+s(MD.AUTO_CLICKS):"";get("treasuresfound").innerHTML=(MD.TREASURES_FOUND>0)?"Treasures Found: "+s(MD.TREASURES_FOUND):"";get("markettrades").innerHTML=(MD.MARKET_TRADES>0)?"Market Trades: "+s(MD.MARKET_TRADES):"";get("goblinsacrificed").innerHTML=(MD.GOBLINS_SACRIFIED>0)?"Goblins Sacrificed: "+s(MD.GOBLINS_SACRIFIED):"";get("campaignswon").innerHTML=(MD.CAMPAIGNS_WON>0)?"Campaigns Won: "+s(MD.CAMPAIGNS_WON):"";get("soldierslost").innerHTML=(MD.SOLDIERS_LOST>0)?"Soldiers Lost: "+s(MD.SOLDIERS_LOST):"";get("maxdraglevel").innerHTML=(MD.MAX_DRAGON_LEVEL>0)?"Highest Dragon Level: "+s(MD.MAX_DRAGON_LEVEL):"";get("dragonssacrificed").innerHTML=(MD.DRAGONS_SACRIFICED>0)?"Dragons Sacrificed: "+s(MD.DRAGONS_SACRIFICED):"";get("totaltraps").innerHTML=(sumArray(MD.TRAPS_BOUGHT)>0)?"Traps Bought: "+s(sumArray(MD.TRAPS_BOUGHT)):"";get("totallures").innerHTML=(MD.LURES_BOUGHT[0]>0)?"Lures Bought: "+s(MD.LURES_BOUGHT[0]):"";get("totalfort").innerHTML=(MD.TIMES_FORTIFIED>0)?"Wall Fortifications: "+s(MD.TIMES_FORTIFIED):"";get("upgradecount").innerHTML="Upgrades Bought: "+MD.UPGRADES_BOUGHT+" out of "+MD.UPGRADES.length;get("upgraderemainingcount").innerHTML="Upgrades Remaining: "+(MD.UPGRADES.length-MD.UPGRADES_BOUGHT)+" out of "+MD.UPGRADES.length;get("mageupgradecount").innerHTML="Upgrades Bought: "+MD.ACTIVE_MAGE_UPGRADES.length+" out of "+MD.MAGE_UPGRADES.length;get("totalfood").innerHTML=(MD.TOTAL_FOOD>0)?"Total Food: "+s(MD.TOTAL_FOOD):"";get("totaldirt").innerHTML=(MD.TOTAL_DIRT>0)?"Total Dirt: "+s(MD.TOTAL_DIRT):"";get("totalstone").innerHTML=(MD.TOTAL_STONE>0)?"Total Stone: "+s(MD.TOTAL_STONE):"";get("totalcoal").innerHTML=(MD.TOTAL_COAL>0)?"Total Coal: "+s(MD.TOTAL_COAL):"";get("totaliron").innerHTML=(MD.TOTAL_IRON>0)?"Total Iron: "+s(MD.TOTAL_IRON):"";get("totalsteel").innerHTML=(MD.TOTAL_STEEL>0)?"Total Steel: "+s(MD.TOTAL_STEEL):"";get("totaladam").innerHTML=(MD.TOTAL_ADAMANTIUM>0)?"Total Adamantium: "+s(MD.TOTAL_ADAMANTIUM):"";get("totalfire").innerHTML=(MD.TOTAL_FIRE_ESSENCE>0)?"Total Fire Essence: "+s(MD.TOTAL_FIRE_ESSENCE):"";get("totalwater").innerHTML=(MD.TOTAL_WATER_ESSENCE>0)?"Total Water Essence: "+s(MD.TOTAL_WATER_ESSENCE):"";get("totalearth").innerHTML=(MD.TOTAL_EARTH_ESSENCE>0)?"Total Earth Essence: "+s(MD.TOTAL_EARTH_ESSENCE):"";get("totallightning").innerHTML=(MD.TOTAL_LIGHTNING_ESSENCE>0)?"Total Lightning Essence: "+s(MD.TOTAL_LIGHTNING_ESSENCE):"";get("totalspirit").innerHTML=(MD.TOTAL_SPIRIT_ESSENCE>0)?"Total Spirit Essence: "+s(MD.TOTAL_SPIRIT_ESSENCE):"";get("totalhirelings").innerHTML=(MD.totalHirelings()>0)?"Total Non-Ant Hirelings: "+s(MD.totalHirelings()):"";get("totalconstruct").innerHTML=(MD.totalConstructLevel()>0)?"Total Industry Level: "+s(MD.totalConstructLevel()):""};MD.updateMages=function(){MD.updateMageButtons();MD.updateMagePage();MD.setMageButton();MD.checkMageGems();MD.updateAuraTime();var a=(MD.hasUpgrade("Durable Mana Channels")?MD.AURA_DURATION*2:MD.AURA_DURATION);if(MD.hasUpgrade("Eternal Energy")){a*=2}if(MD.hasUpgrade("Instant Power")){a*=2}if(MD.TICKS%a==0){MD.decrementAuras()}};MD.updateMasons=function(){MD.setMasonButton()};MD.updateAlchemists=function(){MD.updateAlchButton();MD.setAlchemistButton();MD.updateAlchPage();MD.processAlchemists()};MD.updateCrafting=function(){MD.updateCraftingButtons();MD.updateCraftingPage()};MD.updateIndustry=function(){MD.updateIndustryButton();MD.checkConstructs()};MD.updateMachinist=function(){MD.updateMechPage();MD.updateMechButton()};MD.updateDragons=function(){MD.updateDragonButton();MD.updateDragonPage()};MD.updateArcaneum=function(){MD.updateArchButton();MD.updateArchPage()};MD.updateMilitary=function(){MD.updateMilitaryButton();MD.updateMilitaryPage()};MD.testRandomEvents=function(){var a=(MD.hasUpgrade("Pirate's Luck")?0.4:0.2);a+=(MD.hasUpgrade("Ten Thousand Foot View")?1:0);if(tryPercentChance(a)){MD.findBuriedTreasure()}else{if(tryPercentChance(0.02)){MD.hardDrivePricing()}}};MD.updateVisuals=function(){MDART.updateUnits()};function getTime(d){var f=Math.floor(d/86400);d%=86400;var a=Math.floor(d/3600);d%=3600;var c=Math.floor(d/60);d%=60;var e=d;var b="";if(f!=0){b+=s(f)+(f==1?" day, ":" days, ")}if(f!=0||a!=0){b+=a+(a==1?" hour, ":" hours, ")}if(f!=0||a!=0||c!=0){b+=c+(c==1?" minute, ":" minutes, ")}if(f!=0||a!=0||c!=0||e!=0){b+=e+(e==1?" second":" seconds")}return b}MD.changeGold=function(a){a*=((a>0)?MD.getResMult("Basic"):1);MD.GOLD+=a;if(a>0){MD.TOTAL_GOLD+=a}get("goldcount").innerHTML="Gold: "+s(Math.floor(MD.GOLD))};MD.hasGold=function(a){return MD.GOLD>=a};MD.getGold=function(){return MD.GOLD};MD.spend=function(f){for(var d in f){var b=d.toLowerCase();var e=f[d];var a=MD.RESOURCES[b];if(a!=null){a.change_function(-e)}else{console.log("Error - Unknown Resource - "+b)}}};MD.earn=function(f){for(var d in f){var b=d.toLowerCase();var e=f[d];var a=MD.RESOURCES[b];if(a!=null){a.change_function(e)}else{console.log("Error - Unknown Resource - "+b)}}};MD.canAfford=function(f){for(var d in f){var b=d.toLowerCase();var e=f[d];var a=MD.RESOURCES[b];if(a!=null){if(!a.check_function(e)){return false}}else{console.log("Error - Unknown Resource - "+b)}}return true};MD.updateGoldPerSecond=function(){MD.GOLD_PER_SECOND=0;var c;for(c=0;c<MD.HIRELINGS.length;c++){MD.GOLD_PER_SECOND+=MD.HIRELINGS_OWNED[c]*MD.getProduction(c)}if(MD.hasUpgrade("Delve Greedily")){MD.GOLD_PER_SECOND*=MD.uv.delvegreedilymult}if(MD.hasUpgrade("Embrace The Swarm")){MD.GOLD_PER_SECOND*=MD.uv.embranceswarmmult}if(MD.hasUpgrade("The First Steps")){MD.GOLD_PER_SECOND*=MD.uv.timeupgrade1}if(MD.hasUpgrade("Tick Tock Time")){MD.GOLD_PER_SECOND*=MD.uv.timeupgrade2}if(MD.hasUpgrade("Flowing Like A River")){MD.GOLD_PER_SECOND*=MD.uv.timeupgrade3}if(MD.hasUpgrade("Chronological Torrent")){MD.GOLD_PER_SECOND*=MD.uv.timeupgrade4}if(MD.hasUpgrade("Encouraging Achievements")){MD.GOLD_PER_SECOND*=(1+(MD.uv.gpsperupgrade*MD.UPGRADES_BOUGHT)/100)}MD.GOLD_PER_SECOND*=1+(MD.getMagesDelving()/100);for(c=0;c<MD.PICK_SOCKETS.length;c++){if(MD.PICK_SOCKETS[c]!=null){MD.GOLD_PER_SECOND*=(1+(MD.GEM_OBJECTS[MD.PICK_SOCKETS[c]].gps_increase/100))}}if(MD.hasConstruct("Lightning Shrine")){MD.GOLD_PER_SECOND*=Math.pow(MD.CONSTRUCT_LEVELS[21]+1,1.1)}if(MD.hasUpgrade("Electric Current")){MD.GOLD_PER_SECOND*=4}var d=MD.countGoblins();var b;if(MD.WALL_LEVEL==0&&d>0){b=((80/MD.GOBLIN_PRESENT.length)*d);MD.GOLD_PER_SECOND*=(1-(b/100))}var a="Gold Per Second: "+s(roundTenth(MD.GOLD_PER_SECOND*MD.getResMult("Basic")));if(MD.WALL_LEVEL==0&&d>0){b=((80/MD.GOBLIN_PRESENT.length)*d);a+=" ("+s(Math.round(b))+"% stolen by goblins)"}get("gpscount").innerHTML=a};MD.delayGold=function(a,c,b){if(c!=0&&MD.TICKS>=b){MD.changeGold(a/10);setTimeout(function(){MD.delayGold(a,--c,b)},100)}};MD.autoSave=function(){MD.saveToLocalStorage()};MD.saveToLocalStorage=function(){var a=getSaveObject();localStorage.setItem(MD.HTML5_LOCAL_STORAGE_NAME,a);MDART.notify("Save Successful")};MD.loadLocalStorage=function(){var a=localStorage.getItem(MD.HTML5_LOCAL_STORAGE_NAME);if(a!=null){MD.loadSaveObject(a)}};MD.resetGame=function(){var a=confirm("Are you sure you want to reset your game?");if(a==true){a=confirm("Are you REALLY sure? This game has no prestige system - you will go back to the beginning!");if(a==true){clearLocalStorage();MD.resetVariables();MD.resetAlchTable();MDART.oracle_ctx.clearRect(0,0,MDART.oracle_canvas.width,MDART.oracle_canvas.height);MDART.update();MD.tick();MDART.notify("Game reset!");MD.showCanvas()}}};function clearLocalStorage(){localStorage.removeItem(MD.HTML5_LOCAL_STORAGE_NAME)}MD.exportGame=function(){var a=getSaveObject();showExport(a)};MD.importGame=function(){var b=prompt("Please enter your save object:","");if(b!=null){try{MD.loadSaveObject(b);MD.UPGRADE_CACHE={};MD.resetAlchTable();MD.setupDialogs();MDART.notify("Game Imported!")}catch(a){window.alert("The save file failed to import. This is likely caused by not including all the characters.")}}};function getSaveObject(){var a={};a.version=MD.VERSION;var b={};b.gold=MD.GOLD;b.totalgold=MD.TOTAL_GOLD;b.picklevel=MD.PICK_LEVEL;b.picksock=MD.PICK_SOCKETS;b.walllevel=MD.WALL_LEVEL;b.wallstrength=MD.WALL_STRENGTH;b.fortlevel=MD.FORTIFICATION_LEVEL;b.masons=MD.MASONS;b.hireowned=MD.HIRELINGS_OWNED;b.unlocked=MD.UNLOCKED_UPGRADES;b.available=MD.AVAILABLE_UPGRADES;b.active=MD.ACTIVE_UPGRADES;b.gobpresent=MD.GOBLIN_PRESENT;b.goblevel=MD.GOBLIN_LEVEL;b.gps=MD.GOLD_PER_SECOND;b.bought=MD.UPGRADES_BOUGHT;b.gobkilled=MD.GOBLINS_KILLED;b.gobtime=MD.GOBLIN_TIMER;b.goblure=MD.GOBLIN_LURE_TIMER;b.gobkilledm=MD.GOBLINS_KILLED_BY_MAGES;b.traps=MD.TRAPS_BOUGHT;b.lures=MD.LURES_BOUGHT;b.dirt=MD.DIRT;b.totdirt=MD.TOTAL_DIRT;b.stone=MD.STONE;b.totstone=MD.TOTAL_STONE;b.coal=MD.COAL;b.totcoal=MD.TOTAL_COAL;b.iron=MD.IRON;b.totiron=MD.TOTAL_IRON;b.steel=MD.STEEL;b.totsteel=MD.TOTAL_STEEL;b.adam=MD.ADAMANTIUM;b.totadam=MD.TOTAL_ADAMANTIUM;b.drasca=MD.DRAGONSCALE;b.totdrasca=MD.TOTAL_DRAGONSCALE;b.flax=MD.FLAX;b.totflax=MD.TOTAL_FLAX;b.food=MD.FOOD;b.totfood=MD.FOOD;b.pop=MD.POPULATION;b.totpop=MD.TOTAL_POPULATION;b.sollost=MD.SOLDIERS_LOST;b.fireess=MD.FIRE_ESSENCE;b.totfireess=MD.TOTAL_FIRE_ESSENCE;b.wateress=MD.WATER_ESSENCE;b.totwateress=MD.TOTAL_WATER_ESSENCE;b.earthess=MD.EARTH_ESSENCE;b.totearthess=MD.TOTAL_EARTH_ESSENCE;b.lightningess=MD.LIGHTNING_ESSENCE;b.totlightningess=MD.TOTAL_LIGHTNING_ESSENCE;b.spiritess=MD.SPIRIT_ESSENCE;b.totspiritess=MD.TOTAL_SPIRIT_ESSENCE;b.spipres=MD.SPIDER_PRESENT;b.spitime=MD.SPIDER_TIMER;b.spilevel=MD.SPIDER_LEVEL;b.spikilled=MD.SPIDERS_KILLED;b.spikilledm=MD.SPIDERS_KILLED_BY_MAGES;b.manclicks=MD.MANUAL_CLICKS;b.autclicks=MD.AUTO_CLICKS;b.ticks=MD.TICKS;b.treasuresfound=MD.TREASURES_FOUND;b.camwon=MD.CAMPAIGNS_WON;b.totgem=MD.TOTAL_GEMS;b.mfight=MD.MAGES_FIGHTING;b.mconc=MD.MAGES_MEDITATING;b.mdelv=MD.MAGES_DELVING;b.mexp=MD.MANA;b.tmexp=MD.TOTAL_MANA;b.magemaxtime=MD.MAGE_MAX_TIME;b.imbuelvl=MD.IMBUEMENT_LEVEL;b.wood=MD.WOOD;b.buildunlocked=MD.BUILDINGS_UNLOCKED;b.buildavailable=MD.BUILDINGS_AVAILABLE;b.buildactive=MD.BUILDINGS_ACTIVE;b.mages=MD.MAGES;b.gems=MD.GEMS;b.gsold=MD.GEMS_SOLD;b.spellunlocked=MD.ACTIVE_MAGE_UPGRADES;b.alchim=MD.ALCHEMISTS;b.alcharr=MD.ALCH_ARRAY;b.conlocs=MD.CONSTRUCT_LOCATIONS;b.constat=MD.CONSTRUCTION_STATUS;b.conlevs=MD.CONSTRUCT_LEVELS;b.asgem=MD.AUTO_SMITH_GEM;b.aslim=MD.AUTO_SMITH_LIMIT;b.mtres=MD.MAGE_TOWER_RESEARCH;b.comblim=MD.GEM_COMBINE_LIMIT;b.shownot=MD.SHOW_NOTIFICATIONS;b.showeff=MD.SHOW_CLICK_EFFECTS;b.pitsmelt=MD.PIT_SMELTING;b.blinrev=MD.BLIND_REVENGE;b.autrift=MD.AUTO_RIFT;b.currate=MD.CURRENT_RATES;b.gobsac=MD.GOBLINS_SACRIFIED;b.macauto=MD.MACHINIST_AUTO;b.adran=MD.ADMIN_RANGE;b.distim=MD.DISPLAYED_TIME;b.anteat=MD.ANTS_EATEN;b.timefort=MD.TIMES_FORTIFIED;b.gobdam=MD.GOBLIN_DAMAGE;b.dirtman=MD.DIRT_TO_MANA;b.martrade=MD.MARKET_TRADES;b.curdrag=MD.CURRENT_DRAGON;b.draglev=MD.DRAGON_LEVEL;b.maxdrag=MD.MAX_DRAGON_LEVEL;b.dragown=MD.DRAGONS_OWNED;b.mdragprice=MD.MASTER_DRAGON_PRICE;b.dragsac=MD.DRAGONS_SACRIFICED;b.archarr=MD.ARCH_ARRAY;b.numsystem=MD.NUMBER_SYSTEM;a.saveObject=Base64.encode(JSON.stringify(b));return Base64.encode(JSON.stringify(a))}MD.loadSaveObject=function(b){MD.setVariablesToDefault();extracted=JSON.parse(Base64.decode(b));var a=Number(extracted.version);if(a<0.82){MD.extractSaveObject(b);if(MD.PICK_LEVEL==12){MD.PICK_LEVEL++}}else{MD.extractSaveObject(extracted.saveObject)}};MD.extractSaveObject=function(a){a=JSON.parse(Base64.decode(a));MD.GOLD=a.gold;MD.TOTAL_GOLD=a.totalgold;MD.setWall(a.walllevel,a.fortlevel);MD.WALL_STRENGTH=a.wallstrength;MD.MASONS=a.masons;MD.HIRELINGS_OWNED=a.hireowned;if(MD.HIRELINGS_OWNED.length==9){MD.HIRELINGS_OWNED.push(0)}if(MD.HIRELINGS_OWNED.length==10){MD.HIRELINGS_OWNED.push(0)}if(MD.HIRELINGS_OWNED.length==11){MD.HIRELINGS_OWNED.push(0)}if(MD.HIRELINGS_OWNED.length==12){MD.HIRELINGS_OWNED.push(0)}if(MD.HIRELINGS_OWNED.length==13){MD.HIRELINGS_OWNED.push(0)}MD.UNLOCKED_UPGRADES=a.unlocked;MD.AVAILABLE_UPGRADES=a.available;MD.ACTIVE_UPGRADES=a.active;MD.GOBLIN_PRESENT=a.gobpresent;MD.GOBLIN_LEVEL=a.goblevel;MD.GOLD_PER_SECOND=a.gps;MD.UPGRADES_BOUGHT=a.bought;MD.GOBLINS_KILLED=a.gobkilled;MD.MANUAL_CLICKS=a.manclicks;MD.AUTO_CLICKS=(a.autclicks==undefined)?0:a.autclicks;MD.TICKS=a.ticks;MD.WOOD=a.wood;MD.BUILDINGS_UNLOCKED=a.buildunlocked;MD.BUILDINGS_AVAILABLE=a.buildavailable;MD.BUILDINGS_ACTIVE=a.buildactive;MD.MAGES=a.mages;MD.GEMS=a.gems;if(typeof(MD.GEMS)=="number"){MD.GEMS=[MD.GEMS,0,0,0,0,0,0,0,0,0]}MD.ACTIVE_MAGE_UPGRADES=a.spellunlocked;MD.setNumberSystem((a.numsystem==undefined)?"SS":a.numsystem);MD.TREASURES_FOUND=(a.treasuresfound==undefined)?0:a.treasuresfound;MD.CAMPAIGNS_WON=(a.camwon==undefined)?0:a.camwon;MD.TOTAL_GEMS=(a.totgem==undefined)?0:a.totgem;MD.GEMS_SOLD=(a.gsold==undefined)?0:a.gsold;MD.MAGES_FIGHTING=(a.mfight==undefined)?MD.MAGES:a.mfight;MD.MAGES_MEDITATING=(a.mconc==undefined)?0:a.mconc;MD.MAGES_DELVING=(a.mdelv==undefined)?0:a.mdelv;MD.MANA=(a.mexp==undefined)?0:a.mexp;MD.TOTAL_MANA=(a.tmexp==undefined)?0:a.tmexp;MD.GOBLINS_KILLED_BY_MAGES=(a.gobkilledm==undefined)?0:a.gobkilledm;MD.GOBLIN_TIMER=(a.gobtime==undefined)?-1:a.gobtime;MD.GOBLIN_LURE_TIMER=(a.goblure==undefined)?-1:a.goblure;MD.MAGE_MAX_TIME=(a.magemaxtime==undefined)?0:a.magemaxtime;MD.DIRT=(a.dirt==undefined)?0:a.dirt;MD.TOTAL_DIRT=(a.totdirt==undefined)?0:a.totdirt;MD.STONE=(a.stone==undefined)?0:a.stone;MD.TOTAL_STONE=(a.totstone==undefined)?0:a.totstone;MD.COAL=a.coal;MD.TOTAL_COAL=(a.totcoal==undefined)?0:a.totcoal;MD.IRON=(a.iron==undefined)?0:a.iron;MD.TOTAL_IRON=(a.totiron==undefined)?0:a.totiron;MD.STEEL=a.steel;MD.TOTAL_STEEL=(a.totsteel==undefined)?0:a.totsteel;MD.ADAMANTIUM=(a.adam==undefined)?0:a.adam;MD.TOTAL_ADAMANTIUM=(a.totadam==undefined)?0:a.totadam;MD.DRAGONSCALE=(a.drasca==undefined)?0:a.drasca;MD.TOTAL_DRAGONSCALE=(a.totdrasca==undefined)?0:a.totdrasca;MD.FLAX=(a.flax==undefined)?0:a.flax;MD.TOTAL_FLAX=(a.totflax==undefined)?0:a.totflax;MD.FOOD=(a.food==undefined)?0:a.food;MD.TOTAL_FOOD=(a.totfood==undefined)?0:a.totfood;MD.FIRE_ESSENCE=(a.fireess==undefined)?0:a.fireess;MD.TOTAL_FIRE_ESSENCE=(a.totfireess==undefined)?0:a.totfireess;MD.WATER_ESSENCE=(a.wateress==undefined)?0:a.wateress;MD.TOTAL_WATER_ESSENCE=(a.totwateress==undefined)?0:a.totwateress;MD.EARTH_ESSENCE=(a.earthess==undefined)?0:a.earthess;MD.TOTAL_EARTH_ESSENCE=(a.totearthess==undefined)?0:a.totearthess;MD.LIGHTNING_ESSENCE=(a.lightningess==undefined)?0:a.lightningess;MD.TOTAL_LIGHTNING_ESSENCE=(a.totlightningess==undefined)?0:a.totlightningess;MD.SPIRIT_ESSENCE=(a.spiritess==undefined)?0:a.spiritess;MD.TOTAL_SPIRIT_ESSENCE=(a.totspiritess==undefined)?0:a.totspiritess;MD.IMBUEMENT_LEVEL=(a.imbuelvl==undefined)?[0,0,0,0,0,0,0,0,0,0,0]:a.imbuelvl;if(MD.IMBUEMENT_LEVEL.length==11){MD.IMBUEMENT_LEVEL.push(0)}if(MD.IMBUEMENT_LEVEL.length==12){MD.IMBUEMENT_LEVEL.push(0)}if(MD.IMBUEMENT_LEVEL.length==13){MD.IMBUEMENT_LEVEL.push(0)}MD.TRAPS_BOUGHT=(a.traps==undefined)?[0,0,0]:a.traps;if(MD.TRAPS_BOUGHT.length==3){MD.TRAPS_BOUGHT.push(0)}if(MD.TRAPS_BOUGHT.length==4){MD.TRAPS_BOUGHT.push(0)}MD.LURES_BOUGHT=(a.lures==undefined)?[0]:a.lures;MD.PICK_SOCKETS=(a.picksock==undefined)?[]:a.picksock;MD.SPIDER_PRESENT=(a.spipres==undefined)?[false,false,false,false,false,false]:a.spipres;MD.SPIDER_LEVEL=(a.spilevel==undefined)?1:a.spilevel;MD.SPIDER_TIMER=(a.spitime==undefined)?-1:a.spitime;MD.SPIDERS_KILLED=(a.spikilled==undefined)?0:a.spikilled;MD.SPIDERS_KILLED_BY_MAGES=(a.spikilledm==undefined)?0:a.spikilledm;MD.ALCHEMISTS=(a.alchim==undefined)?0:a.alchim;MD.ALCH_ARRAY=(a.alcharr==undefined)?[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]:a.alcharr;MD.CONSTRUCT_LOCATIONS=(a.conlocs==undefined)?new Array(25):a.conlocs;MD.CONSTRUCTION_STATUS=(a.constat==undefined)?new Array(25):a.constat;MD.CONSTRUCT_LEVELS=(a.conlevs==undefined)?[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]:a.conlevs;MD.AUTO_SMITH_GEM=(a.asgem==undefined)?0:a.asgem;MD.AUTO_SMITH_LIMIT=(a.aslim==undefined)?null:a.aslim;MD.MAGE_TOWER_RESEARCH=(a.mtres==undefined)?0:a.mtres;MD.GEM_COMBINE_LIMIT=(a.comblim==undefined)?9:a.comblim;MD.SHOW_NOTIFICATIONS=(a.shownot==undefined)?true:a.shownot;MD.SHOW_CLICK_EFFECTS=(a.showeff==undefined)?true:a.showeff;MD.PIT_SMELTING=(a.pitsmelt==undefined)?true:a.pitsmelt;MD.CURRENT_RATES=(a.currate==undefined)?[]:a.currate;while(MD.CURRENT_RATES.length<MD.EXCHANGE_RATES.length){MD.CURRENT_RATES.push(MD.getMarketRate())}MD.ANTS_EATEN=(a.anteat==undefined)?0:a.anteat;MD.TIMES_FORTIFIED=(a.timefort==undefined)?0:a.timefort;MD.GOBLIN_DAMAGE=(a.gobdam==undefined)?0:a.gobdam;MD.DIRT_TO_MANA=(a.dirtman==undefined)?0:a.dirtman;MD.MARKET_TRADES=(a.martrade==undefined)?0:a.martrade;MD.GOBLINS_SACRIFIED=(a.gobsac==undefined)?0:a.gobsac;MD.MACHINIST_AUTO=(a.macauto==undefined)?[false,false,false]:a.macauto;MD.ADMIN_RANGE=(a.adran==undefined)?10:a.adran;MD.DISPLAYED_TIME=(a.distim==undefined)?10:a.distim;MD.CURRENT_DRAGON=(a.curdrag==undefined)?-1:a.curdrag;MD.DRAGON_LEVEL=(a.draglev==undefined)?0:a.draglev;MD.MAX_DRAGON_LEVEL=(a.maxdrag==undefined)?0:a.maxdrag;MD.DRAGONS_OWNED=(a.dragown==undefined)?[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]:a.dragown;MD.MASTER_DRAGON_PRICE=(a.mdragprice==undefined)?null:a.mdragprice;MD.DRAGONS_SACRIFICED=(a.dragsac==undefined)?0:a.dragsac;MD.toggleAutoSacrifice((a.autrift==undefined)?false:a.autrift);MD.toggleBlindRevenge((a.blinrev==undefined)?false:a.blinrev);MD.ARCH_ARRAY=(a.archarr==undefined)?[0,0,0,0,0,0]:a.archarr;MD.POPULATION=(a.pop==undefined)?MD.getPopulationMax():a.pop;MD.TOTAL_POPULATION=(a.totpop==undefined)?MD.getPopulationMax():a.totpop;MD.SOLDIERS_LOST=(a.sollost==undefined)?0:a.sollost;if(MD.CURRENT_RATES.length==5){MD.CURRENT_RATES.push(100)}MD.setPickLevel(a.picklevel);MD.updateGoblinsKilled();MD.respawnGoblins();MD.respawnSpiders();MD.setHirelingButtons();MD.setMasonButton();MD.setMageButton();MD.setAlchemistButton();MD.updateUpgradeStats();MDART.update()};MD.resetVariables=function(){MD.UPGRADE_CACHE={};MD.setVariablesToDefault();MD.updateGoblinsKilled();MD.respawnGoblins();MD.respawnSpiders();MD.setHirelingButtons();MD.setMasonButton();MD.setMageButton();MD.setAlchemistButton();MD.updateGems();MD.updateUpgradeStats();MD.updateTrapMenu();MD.updateLures();MD.updatePopulationDisplay();MD.initializeConstructUnlocked();MD.updateButtons()};MD.updateButtons=function(){MD.updateCraftingButtons();MD.updateAlchButton();MD.updateStructureButtons();MD.updateIndustryButton();MD.updateMilitaryButton();MD.updateMechButton();MD.updateDragonButton();MD.updateArchButton()};MDART={};MDART.initializeCanvas=function(){var b=$("#screen-area");var c=$(".canvas-container");var a=b.height()/c.height();if(494*a>b.width()){a=b.width()/c.width()}MDART.canvas_ratio=a;c.width(544*a).height(494*a);MDART.bg_canvas=get("background-canvas");MDART.bg_canvas.width=544;MDART.bg_canvas.height=494;$("#background-canvas").width(544*a).height(494*a);MDART.bg_ctx=MDART.bg_canvas.getContext("2d");MDART.units_canvas=get("units-canvas");MDART.units_canvas.width=544;MDART.units_canvas.height=494;$("#units-canvas").width(544*a).height(494*a);MDART.units_ctx=MDART.units_canvas.getContext("2d");MDART.animation_canvas=get("animation-canvas");MDART.animation_canvas.width=544;MDART.animation_canvas.height=494;$("#animation-canvas").width(544*a).height(494*a);MDART.animation_ctx=MDART.animation_canvas.getContext("2d");MDART.oracle_div=get("oracle-div");MDART.oracle_canvas=get("oracle-canvas");MDART.oracle_canvas.width=MDART.oracle_div.clientWidth;MDART.oracle_canvas.height=MDART.oracle_div.clientHeight;MDART.oracle_ctx=MDART.oracle_canvas.getContext("2d");MDART.animation_canvas.addEventListener("mousedown",MDART.mouseDownEvent,false);MDART.oracle_canvas.addEventListener("mousedown",MD.oracleClicked,false);window.onresize=MDART.adjustGameSize};MDART.adjustGameSize=function(){MDART.resizeCanvas();MDART.resizeIndustryCanvas()};MDART.resizeCanvas=function(){var d=$("#screen-area");var e=$(".canvas-container");var c=d.height()/e.height();if(494*c>d.width()){c=d.width()/e.width()}var a=e.width();var b=e.height();if(isFinite(c)&&c>0){e.width(a*c).height(b*c);$("#background-canvas").width(a*c).height(b*c);$("#units-canvas").width(a*c).height(b*c);$("#animation-canvas").width(a*c).height(b*c)}MDART.canvas_ratio=e.width()/544};MDART.update=function(){MDART.updateBackground();MDART.updateUnits();MDART.updateIndustryCanvas()};MDART.updateBackground=function(){MDART.bg_ctx.clearRect(0,0,MDART.bg_canvas.width,MDART.bg_canvas.height);if(MDART.bg_loaded){MDART.bg_ctx.drawImage(MDART.background,0,0);drawWall()}};MDART.updateUnits=function(){MDART.units_ctx.clearRect(0,0,MDART.units_canvas.width,MDART.units_canvas.height);MDART.drawGoblin();drawSpiders();MDART.drawMages();if(MD.MANUAL_CLICKS==0&&MD.TICKS<=30){var b=MDART.units_canvas.width/2;var a=MDART.units_canvas.height/2;MDART.drawClickGuide(b-77,a-77,154,154,"Click Here!")}};MDART.ClickEffect=function(b,a,e,d,c){this.type;this.x=a;this.y=e;this.text=d;this.life=c};MDART.addClickEffect=function(b,a,d,c){if(MD.SHOW_CLICK_EFFECTS){MD.CLICK_EFFECTS[MD.CLICK_EFFECT_POSITION]=new MDART.ClickEffect(b,a,d,c,0);MD.CLICK_EFFECT_POSITION=(MD.CLICK_EFFECT_POSITION+1)%MD.CLICK_EFFECTS.length}};MDART.drawClickEffects=function(){MDART.animation_ctx.font="12px Arial";MDART.animation_ctx.fillStyle="gold";for(var a=0;a<MD.CLICK_EFFECTS.length;a++){var b=MD.CLICK_EFFECTS[a];if(b!=null){MDART.animation_ctx.fillText(b.text,b.x,b.y)}}};MDART.updateClickEffects=function(){for(var a=0;a<MD.CLICK_EFFECTS.length;a++){var b=MD.CLICK_EFFECTS[a];if(b!=null){b.life++;if(b.life>MD.CLICK_EFFECT_LIFE){MD.CLICK_EFFECTS[a]=null}b.y-=MD.CLICK_EFFECT_Y;b.x+=(Math.floor(b.life/4)%2==0)?-1:1}}};MDART.startAnimation=function(b,a){MDART.ANIMATION_CLOCK=setInterval(function(){MDART.updateAnimation(b)},a/(2*b))};MDART.updateAnimation=function(a){if(MD.MOVE_SPRITE){MD.SPRITE_POS=(MD.SPRITE_POS+1)%a}MD.MOVE_SPRITE=!MD.MOVE_SPRITE;MDART.animation_ctx.clearRect(0,0,MDART.animation_canvas.width,MDART.animation_canvas.height);MDART.drawMiner();if(MD.SHOW_CLICK_EFFECTS){MDART.drawClickEffects();MDART.updateClickEffects()}};function drawWall(){if(MD.WALL_LEVEL>0){MDART.bg_ctx.beginPath();MDART.bg_ctx.lineWidth="15";MDART.bg_ctx.strokeStyle=MD.WALLS[MD.WALL_LEVEL].color;MDART.bg_ctx.rect(75,75,394,344);MDART.bg_ctx.stroke()}}MDART.drawMiner=function(){MDART.animation_ctx.drawImage(MDART.MINER_SPRITE_SHEET,100*MD.PICK_LEVEL,100*MD.SPRITE_POS,100,100,250,210,100,100)};MDART.drawGoblin=function(){var b;for(b=0;b<4;b++){if(MD.GOBLIN_PRESENT[b]){MDART.drawHealthBar(MD.GOBLIN_OBJECT[b].x,MD.GOBLIN_OBJECT[b].y,MD.GOBLIN_OBJECT[b].hp,MD.GOBLIN_OBJECT[b].maxhp);var a=(MD.GOBLIN_OBJECT[b].rebel?MDART.REBEL_SPRITE_1:MDART.GOBLIN_SPRITE_1);MDART.units_ctx.drawImage(a,MD.GOBLIN_OBJECT[b].x,MD.GOBLIN_OBJECT[b].y);if(MD.GOBLINS_KILLED==0){MDART.drawClickGuide(MD.GOBLIN_OBJECT[b].x,MD.GOBLIN_OBJECT[b].y+10,MDART.GOBLIN_SPRITE_1.width,MDART.GOBLIN_SPRITE_1.height-10,"Click!")}}}for(b=0;b<4;b++){if(MD.GOBLIN_PRESENT[b+4]){MDART.drawHealthBar(MD.GOBLIN_OBJECT[b+4].x,MD.GOBLIN_OBJECT[b+4].y,MD.GOBLIN_OBJECT[b+4].hp,MD.GOBLIN_OBJECT[b+4].maxhp);var a=(MD.GOBLIN_OBJECT[b+4].rebel?MDART.REBEL_SPRITE_2:MDART.GOBLIN_SPRITE_2);MDART.units_ctx.drawImage(a,MD.GOBLIN_OBJECT[b+4].x,MD.GOBLIN_OBJECT[b+4].y);if(MD.GOBLINS_KILLED==0){MDART.drawClickGuide(MD.GOBLIN_OBJECT[b+4].x,MD.GOBLIN_OBJECT[b+4].y+10,MDART.GOBLIN_SPRITE_2.width,MDART.GOBLIN_SPRITE_2.height-10,"Click!")}}}};function drawSpiders(){var a;for(a=0;a<3;a++){if(MD.SPIDER_PRESENT[a]){MDART.units_ctx.drawImage(MDART.SPIDER_SPRITE_1,MD.SPIDER_OBJECT[a].x,MD.SPIDER_OBJECT[a].y);MDART.drawHealthBar(MD.SPIDER_OBJECT[a].x,MD.SPIDER_OBJECT[a].y,MD.SPIDER_OBJECT[a].hp,MD.SPIDER_OBJECT[a].maxhp)}}for(a=0;a<3;a++){if(MD.SPIDER_PRESENT[a+3]){MDART.units_ctx.drawImage(MDART.SPIDER_SPRITE_2,MD.SPIDER_OBJECT[a+3].x,MD.SPIDER_OBJECT[a+3].y);MDART.drawHealthBar(MD.SPIDER_OBJECT[a+3].x,MD.SPIDER_OBJECT[a+3].y,MD.SPIDER_OBJECT[a+3].hp,MD.SPIDER_OBJECT[a+3].maxhp)}}}MDART.drawHealthBar=function(b,e,d,a){if(d!=a){var c=Math.ceil((d/a)*60);MDART.units_ctx.strokeStyle="red";MDART.units_ctx.fillStyle="black";roundRect(MDART.units_ctx,b,e,60,8,5,true);MDART.units_ctx.fillStyle="red";roundRect(MDART.units_ctx,b,e,c,8,5,true,true)}};MDART.drawOracle=function(d,c){MDART.oracle_ctx.clearRect(0,0,MDART.oracle_canvas.width,MDART.oracle_canvas.height);if(MD.hasUpgrade("Oracle")){var b=MDART.oracle_canvas.width/2;var a=MDART.oracle_canvas.height/2;var f=MDART.ORACLE_BALL.width/2;var e=MDART.ORACLE_BALL.height/2;MDART.oracle_ctx.drawImage(MDART.ORACLE_BALL,b-f,a-e);if(MD.ORACLE_CLICK_GUIDE){MDART.oracle_ctx.beginPath();MDART.oracle_ctx.lineWidth="5";MDART.oracle_ctx.strokeStyle="red";MDART.oracle_ctx.rect(b-f,a-e,f*2,e*2);MDART.oracle_ctx.stroke();MDART.oracle_ctx.font=Math.floor((e*2)/5)+"px Arial";MDART.oracle_ctx.fillStyle="red";MDART.oracle_ctx.fillText("Click Here",(b-f)+5,(a-e)+30,(f*2)-10)}var g=3*Math.PI/2;var j=((d-0.1*MD.FAST_TICK_COUNT)/MD.MAX_GOBLIN_TIME)*Math.PI*2;var h=((c-0.1*MD.FAST_TICK_COUNT)/MD.MAX_SPIDER_TIME)*Math.PI*2}if(MD.hasUpgrade("Delve Greedily")){MDART.oracle_ctx.beginPath();if(MD.GOBLIN_LURE_TIMER>0){MDART.oracle_ctx.strokeStyle="maroon"}else{MDART.oracle_ctx.strokeStyle="green"}MDART.oracle_ctx.lineWidth="6";MDART.oracle_ctx.arc(b,a-3,30,g,g+j);MDART.oracle_ctx.stroke()}if(MD.hasUpgrade("Embrace The Swarm")){MDART.oracle_ctx.beginPath();MDART.oracle_ctx.strokeStyle="purple";MDART.oracle_ctx.arc(b,a-3,36,g,g+h);MDART.oracle_ctx.stroke()}};MDART.drawMages=function(){if(MD.MAGES>0){var d=Math.ceil(MD.MAGES/5);var b=0;var c=MD.hasUpgrade("Dark Portents");for(var a=0;a<3;a++){MDART.units_ctx.drawImage(MDART.WIZARD_SPRITE_SHEET,60*Number(c),0,60,100,MD.MAGE_ROW_1_X,MD.MAGE_START_Y+a*MD.MAGE_INCREMENT_Y,60,100);MDART.drawMageAura(MD.MAGE_ROW_1_X,MD.MAGE_START_Y+a*MD.MAGE_INCREMENT_Y,MD.MAGE_AURA_LEVEL[a*2]);if(MD.MAGE_MAX_TIME<1){MDART.drawClickGuide(MD.MAGE_ROW_1_X,MD.MAGE_START_Y+a*MD.MAGE_INCREMENT_Y,60,100,"Click!")}if(++b>=d){break}MDART.units_ctx.drawImage(MDART.WIZARD_SPRITE_SHEET,60*Number(c),0,60,100,MD.MAGE_ROW_2_X,MD.MAGE_START_Y+a*MD.MAGE_INCREMENT_Y,60,100);MDART.drawMageAura(MD.MAGE_ROW_2_X,MD.MAGE_START_Y+a*MD.MAGE_INCREMENT_Y,MD.MAGE_AURA_LEVEL[a*2+1]);if(MD.MAGE_MAX_TIME<1){MDART.drawClickGuide(MD.MAGE_ROW_2_X,MD.MAGE_START_Y+a*MD.MAGE_INCREMENT_Y,60,100,"Click!")}if(++b>=d){break}}}};MDART.drawMageAura=function(a,d,b){var c=b/MD.MAX_MAGE_AURA;MDART.units_ctx.globalAlpha=c;MDART.units_ctx.drawImage(MDART.WIZARD_SPRITE_SHEET,120,0,60,100,a,d,60,100);MDART.units_ctx.globalAlpha=1};MDART.getMagePosition=function(c){var a=(c%2==0?MD.MAGE_ROW_1_X:MD.MAGE_ROW_2_X);var b=(MD.MAGE_START_Y+MD.MAGE_INCREMENT_Y*Math.floor(c/2));return[a,b,a+60,b+100]};MDART.drawClickGuide=function(a,e,b,c,d){MDART.units_ctx.beginPath();MDART.units_ctx.lineWidth="5";MDART.units_ctx.strokeStyle="red";MDART.units_ctx.rect(a,e,b,c);MDART.units_ctx.stroke();MDART.units_ctx.font=Math.floor(c/5)+"px Arial";MDART.units_ctx.fillStyle="red";MDART.units_ctx.fillText(d,a+5,e+30,b-10)};MDART.SPRITES_LOADED=0;MDART.SPRITES_TO_LOAD=48;MDART.loadSprite=function(){MDART.SPRITES_LOADED++;if(MDART.SPRITES_LOADED==MDART.SPRITES_TO_LOAD){MD.tick();MDART.update();get("loading-text").style.zIndex="-1"}};MDART.preloadSprites=function(){MDART.bg_loaded=false;MDART.background=new Image();MDART.background.onload=function(){MDART.bg_loaded=true;MDART.loadSprite()};MDART.background.src="./resources/minedefense/background.jpg";MDART.MINER_SPRITE_SHEET=new Image();MDART.MINER_SPRITE_SHEET.onload=function(){MDART.loadSprite()};MDART.MINER_SPRITE_SHEET.src="./resources/minedefense/minersheet.png";MDART.GOBLIN_SPRITE_1=new Image();MDART.GOBLIN_SPRITE_1.onload=function(){MDART.loadSprite()};MDART.GOBLIN_SPRITE_1.src="./resources/minedefense/Goblin1.png";MDART.GOBLIN_SPRITE_2=new Image();MDART.GOBLIN_SPRITE_2.onload=function(){MDART.loadSprite()};MDART.GOBLIN_SPRITE_2.src="./resources/minedefense/Goblin2.png";MDART.REBEL_SPRITE_1=new Image();MDART.REBEL_SPRITE_1.onload=function(){MDART.loadSprite()};MDART.REBEL_SPRITE_1.src="./resources/minedefense/Rebel1.png";MDART.REBEL_SPRITE_2=new Image();MDART.REBEL_SPRITE_2.onload=function(){MDART.loadSprite()};MDART.REBEL_SPRITE_2.src="./resources/minedefense/Rebel2.png";MDART.SPIDER_SPRITE_1=new Image();MDART.SPIDER_SPRITE_1.onload=function(){MDART.loadSprite()};MDART.SPIDER_SPRITE_1.src="./resources/minedefense/spider1.png";MDART.SPIDER_SPRITE_2=new Image();MDART.SPIDER_SPRITE_2.onload=function(){MDART.loadSprite()};MDART.SPIDER_SPRITE_2.src="./resources/minedefense/spider2.png";MDART.WIZARD_SPRITE_SHEET=new Image();MDART.WIZARD_SPRITE_SHEET.onload=function(){MDART.loadSprite()};MDART.WIZARD_SPRITE_SHEET.src="./resources/minedefense/wizardsheet.png";MDART.ORACLE_BALL=new Image();MDART.ORACLE_BALL.onload=function(){MDART.loadSprite()};MDART.ORACLE_BALL.src="./resources/minedefense/oracle.png";MDART.EMPTY_GRASS=new Image();MDART.EMPTY_GRASS.onload=function(){MDART.updateIndustryCanvas();MDART.loadSprite()};MDART.EMPTY_GRASS.src="./resources/minedefense/emptyfield.png";MDART.CONSTRUCT_SPRITES=[];for(var b=0;b<MD.CONSTRUCTS.length;b++){MDART.CONSTRUCT_SPRITES[b]=[];for(var a=0;a<MD.CONSTRUCTS[b].image.length;a++){MDART.CONSTRUCT_SPRITES[b][a]=new Image();MDART.CONSTRUCT_SPRITES[b][a].onload=function(){MDART.loadSprite()};MDART.CONSTRUCT_SPRITES[b][a].src=MD.CONSTRUCTS[b].image[a]}}};MDART.setTooltips=function(){for(var b=0;b<MD.GEM_OBJECTS.length;b++){var a="";if(b!=0){a+="Consists of "+MD.GEM_OBJECTS[b].combine_requirement+" "+MD.GEM_OBJECTS[b-1].name.toLowerCase()+" gems. "}a+="Increases pick efficiency by "+s(MD.GEM_OBJECTS[b].pick_increase)+". ";if(MD.GEM_OBJECTS[b].gps_increase>0){a+="Increases gold per second by "+MD.GEM_OBJECTS[b].gps_increase+"%."}MDART.setTooltip($("#gempic"+b),MD.GEM_OBJECTS[b].name+" Gem",a)}for(b=0;b<MD.GEM_OBJECTS.length;b++){a="";if(b!=MD.GEM_OBJECTS.length-1){a+="Combine "+MD.GEM_OBJECTS[b].name.toLowerCase()+" gems into a single "+MD.GEM_OBJECTS[b+1].name.toLowerCase()+" gem. Hold Ctrl to combine all gems.";MDART.setTooltip($("#combine-gem-"+b),"",a)}a="";if(b!=0){a+="Break a single "+MD.GEM_OBJECTS[b].name.toLowerCase()+" gems into "+(MD.GEM_OBJECTS[b].combine_requirement-1)+" "+MD.GEM_OBJECTS[b-1].name.toLowerCase()+" gems. Hold Ctrl to break all the gems.";MDART.setTooltip($("#break-gem-"+b),"",a)}}};MDART.mouseDownEvent=function(f){var j=$(this).offset();var k=Math.round((f.pageX||0)-j.left);var h=Math.round((f.pageY||0)-j.top);k/=MDART.canvas_ratio;h/=MDART.canvas_ratio;var b=MDART.bg_canvas.width/2;var a=MDART.bg_canvas.height/2;if(k>b-77&&k<b+77&&h>a-77&&h<a+77){MD.dig(k,h)}var c;for(c=0;c<MD.GOBLIN_PRESENT.length;c++){if(MD.GOBLIN_PRESENT[c]){if(k>MD.GOBLIN_OBJECT[c].x&&k<MD.GOBLIN_OBJECT[c].x+MDART.GOBLIN_SPRITE_1.width&&h>MD.GOBLIN_OBJECT[c].y&&h<MD.GOBLIN_OBJECT[c].y+MDART.GOBLIN_SPRITE_1.height){MD.clickGoblin(c)}}}for(c=0;c<MD.SPIDER_PRESENT.length;c++){if(MD.SPIDER_PRESENT[c]){if(k>MD.SPIDER_OBJECT[c].x&&k<MD.SPIDER_OBJECT[c].x+MDART.SPIDER_SPRITE_1.width&&h>MD.SPIDER_OBJECT[c].y&&h<MD.SPIDER_OBJECT[c].y+MDART.SPIDER_SPRITE_1.height){MD.clickSpider(c)}}}var d=Math.ceil(MD.MAGES/5);for(c=0;c<6&&c<d;c++){var g=MDART.getMagePosition(c);if(k>g[0]&&k<g[2]&&h>g[1]&&h<g[3]){MD.clickMage(c)}}};MD.oracleClicked=function(a){MD.showOracleArea()};$.notify.addStyle("info",{html:"<div><span data-notify-text></div>",classes:{base:{"background-color":"lightblue",padding:"3px","border-radius":"10px",width:"300px","margin-top":"5px","text-align":"center"}}});$.notify.defaults({arrowShow:false,elementPosition:"bottom",gap:5});MDART.notify=function(a){if(MD.SHOW_NOTIFICATIONS){$("#info-column2").notify(a,{style:"info"})}};MDART.initializeIndustryCanvas=function(){var b=$("#industry-area");var c=$("#industry-container");var a=(b.width())/c.width();if(320*a>b.height()*0.9){a=(b.height()*0.9)/c.height()}a=Math.max(Math.floor(a),1);MDART.industry_canvas_ratio=a;c.width(320*a).height(210*a);MDART.industry_canvas=get("industry-canvas");MDART.industry_canvas.width=320;MDART.industry_canvas.height=210;$("#industry-canvas").width(320*a).height(210*a);MDART.industry_context=MDART.industry_canvas.getContext("2d");MDART.industry_construct_canvas=get("industry-constructs");MDART.industry_construct_canvas.width=320*a;MDART.industry_construct_canvas.height=210*a;$("#industry-constructs").width(320*a).height(210*a);MDART.industry_construct_context=MDART.industry_construct_canvas.getContext("2d");MDART.industry_bg_canvas=get("industry-background");MDART.industry_bg_canvas.width=320*a;MDART.industry_bg_canvas.height=210*a;$("#industry-background").width(320*a).height(210*a);MDART.industry_bg_context=MDART.industry_bg_canvas.getContext("2d");MDART.industry_bg_context.imageSmoothingEnabled=false;MDART.industry_bg_context.mozImageSmoothingEnabled=false;MDART.industry_bg_context.webkitImageSmoothingEnabled=false;MDART.industry_construct_context.imageSmoothingEnabled=false;MDART.industry_construct_context.mozImageSmoothingEnabled=false;MDART.industry_construct_context.webkitImageSmoothingEnabled=false;MDART.industry_construct_canvas.addEventListener("mousedown",MDART.industryMouseDownEvent,false);MDART.createPlotObjects()};MDART.resizeIndustryCanvas=function(){var d=$("#industry-area");var e=$("#industry-container");var c=(d.width())/e.width();if(320*c>d.height()*0.9){c=(d.height()*0.9)/e.height()}c=Math.max(Math.floor(c),1);var a=e.width();var b=e.height();if(isFinite(c)&&c>0){e.width(a*c).height(b*c);$("#industry-constructs").width(a*c).height(b*c);$("#industry-canvas").width(a*c).height(b*c);$("#industry-background").width(a*c).height(b*c)}MDART.industry_canvas_ratio=e.width()/320;MDART.updateIndustryCanvas()};MDART.updateIndustryCanvas=function(){MDART.industry_context.clearRect(0,0,MDART.industry_canvas.width,MDART.industry_canvas.height);MDART.industry_bg_context.clearRect(0,0,MDART.industry_bg_canvas.width,MDART.industry_bg_canvas.height);MDART.industry_construct_context.clearRect(0,0,MDART.industry_construct_canvas.width,MDART.industry_construct_canvas.height);MDART.industry_bg_context.drawImage(MDART.EMPTY_GRASS,0,0,MDART.industry_bg_canvas.width,MDART.industry_bg_canvas.height);MD.fillExistingIndustry()};MDART.industryMouseDownEvent=function(g){var b=$(this).offset();var a=Math.round((g.pageX||0)-b.left);var h=Math.round((g.pageY||0)-b.top);a/=MDART.industry_canvas_ratio;h/=MDART.industry_canvas_ratio;for(var d=0;d<MDART.PLOT_OBJECTS.length;d++){var f=MDART.PLOT_OBJECTS[d];if(pointInQuad([a,h],[f.top,f.top_left,f.bot,f.top_right])){if(!MD.MOVE_DIALOG_OPEN){MD.clickPlot(d)}else{var c=MD.CONSTRUCT_LOCATIONS[d];if(MD.MOVE_BUILDING_1===null){MD.MOVE_BUILDING_1=d;if(MD.CONSTRUCT_LOCATIONS[d]!==null&&MD.CONSTRUCT_LEVELS[d]!==MDART.PIXELS_PER_PLOT*2+1){get("swap-building-1").innerHTML="Building 1: "+MD.CONSTRUCTS[c].name}else{get("swap-building-1").innerHTML="Building 1: Empty Land"}}else{MD.MOVE_BUILDING_2=d;if(MD.CONSTRUCT_LOCATIONS[d]!==null&&MD.CONSTRUCT_LEVELS[d]!==MDART.PIXELS_PER_PLOT*2+1){get("swap-building-2").innerHTML="Building 2: "+MD.CONSTRUCTS[c].name}else{get("swap-building-2").innerHTML="Building 2: Empty Land"}}}break}}return};MDART.PLOT_ROWS=[0,2,5,9,14,18,21,23,24];MDART.PIXELS_PER_PLOT=962;MDART.CANVAS_OFFSET=49;MDART.Plot=function(a){this.index=a;for(var b=0;b<MDART.PLOT_ROWS.length;b++){if(a<=MDART.PLOT_ROWS[b]){this.row=b;break}}var d=(this.row==0)?1:MDART.PLOT_ROWS[this.row]-MDART.PLOT_ROWS[this.row-1];this.col=d-(MDART.PLOT_ROWS[this.row]-a)-1;var c=(this.row<5)?this.row:MDART.PLOT_ROWS.length-1-this.row;this.top_left=[1+(32*(4-c))+64*this.col,16+(this.row*16)+MDART.CANVAS_OFFSET];this.top=[31+(32*(4-c))+64*this.col,1+(this.row*16)+MDART.CANVAS_OFFSET];this.top_right=[62+(32*(4-c))+64*this.col,16+(this.row*16)+MDART.CANVAS_OFFSET];this.bot=[31+(32*(4-c))+64*this.col,31+(this.row*16)+MDART.CANVAS_OFFSET]};MDART.createPlotObjects=function(){MDART.PLOT_OBJECTS=new Array(25);for(var a=0;a<25;a++){MDART.PLOT_OBJECTS[a]=new MDART.Plot(a)}};MDART.drawDirtOnPlot=function(c,a,t,l){var k=MDART.PLOT_OBJECTS[c];var g=MDART.industry_context.getImageData(0,0,MDART.industry_canvas.width,MDART.industry_canvas.height);var d=0;var o=a;var h=k.top_left[1];var j=k.top[0];var f=0;var b=0;var q=k.top_left[0];var m=k.top_left[1];for(var e=0;e<MDART.PIXELS_PER_PLOT;e++){if(t||d==o-1){if(l==0){MDART.setPixel(g,q,m,139,69,19,255)}else{MDART.setPixel(g,q,m,105,105,105,255)}}d++;if(d>=o){break}if(q==k.top_right[0]-f&&m==k.top_right[1]){q=k.top_right[0]-2-f;m=k.top_right[1]+1;continue}else{if(q==k.top_left[0]+2+f&&m==k.top_left[1]+1){q=k.top_left[0]+2+f;m=k.top_left[1];b+=1;f+=2;continue}}if(m<=h){if(q<=j&&(q-k.top_left[0])%2==1){m--}else{if((q-k.top_left[0])%2==1){m++}}q++}else{if(q<=j&&(q-k.top_left[0])%2==0){m--}else{if((q-k.top_left[0])%2==0){m++}}q--}}MDART.industry_context.putImageData(g,0,0)};MDART.drawConstructs=function(){for(var b=0;b<MD.CONSTRUCT_LOCATIONS.length;b++){if(MD.CONSTRUCT_LOCATIONS[b]!=null&&MD.CONSTRUCTION_STATUS[b]==MDART.PIXELS_PER_PLOT*2+1){var d=MDART.PLOT_OBJECTS[b];var a=MD.CONSTRUCT_LOCATIONS[b];if(MDART.CONSTRUCT_SPRITES[a].length==1){var c=MDART.CONSTRUCT_SPRITES[a][0]}else{switch(a){case 2:var c=MDART.CONSTRUCT_SPRITES[a][MD.getDragonmountStage()];break;case 7:var c=MDART.CONSTRUCT_SPRITES[a][MD.getHabitationStage()];break;case 8:case 12:case 13:var c=MDART.CONSTRUCT_SPRITES[a][MD.getFarmStage()];break}}MDART.industry_construct_context.drawImage(c,d.top_left[0]*MDART.industry_canvas_ratio,(d.bot[1]-c.height+1)*MDART.industry_canvas_ratio,c.width*MDART.industry_canvas_ratio,c.height*MDART.industry_canvas_ratio)}}};MDART.setPixel=function(l,d,k,j,h,c,e){var f=(d+k*l.width)*4;l.data[f+0]=j;l.data[f+1]=h;l.data[f+2]=c;l.data[f+3]=e};$(document).on("keydown",function(a){if(a.which==17||a.which==18){MD.CTRL_DOWN=true}});$(document).on("keyup",function(a){MD.CTRL_DOWN=false});MD.multibuyActive=function(){return MD.CTRL_DOWN||MD.FORCE_CONTROL};ALERT_COLOUR="yellow";MDART.prepareMenuIcons=function(){$("#menuButton").click(MD.showMenu);$("#statsButton").click(MD.showStats);$("#craftingButton").click(MD.showCrafting);$("#magesButton").click(MD.showMages);$("#alchButton").click(MD.showAlch);$("#indButton").click(MD.showIndustry);$("#warButton").click(MD.showMilitary);$("#mechButton").click(MD.showMechanist);$("#dragonButton").click(MD.showDragons);$("#libButton").click(MD.showArch)};MDART.prepareTabs=function(){var b=document.getElementById("tabContainer");var e=b.querySelector(".tabs ul li");var f=e.id.split("_")[1];e.parentNode.setAttribute("data-current",f);e.setAttribute("class","tabActiveHeader");var a=b.querySelectorAll(".tabpage");var d;for(d=1;d<a.length;d++){a[d].style.display="none"}var c=b.querySelectorAll(".tabs ul li");for(d=0;d<c.length;d++){c[d].onclick=MDART.displayPage}};MDART.displayPage=function(){var b=this.parentNode.getAttribute("data-current");document.getElementById("tabHeader_"+b).removeAttribute("class");document.getElementById("tabpage_"+b).style.display="none";var a=this.id.split("_")[1];this.setAttribute("class","tabActiveHeader");document.getElementById("tabpage_"+a).style.display="block";this.parentNode.setAttribute("data-current",a);MDART.restoreTab(a)};MDART.alertTab=function(a){if(a=="shop"&&!$("#tabHeader_1").hasClass("tabActiveHeader")){get("tabHeader_1").style.background=ALERT_COLOUR}else{if(a=="hire"&&!$("#tabHeader_2").hasClass("tabActiveHeader")){get("tabHeader_2").style.background=ALERT_COLOUR}else{if(a=="defense"&&!$("#tabHeader_3").hasClass("tabActiveHeader")){get("tabHeader_3").style.background=ALERT_COLOUR}else{if(a=="upgrade"&&!$("#tabHeader_4").hasClass("tabActiveHeader")){get("tabHeader_4").style.background=ALERT_COLOUR}}}}};MDART.restoreTab=function(a){get("tabHeader_"+a).style.background=""};MDART.alertBtn=function(a){get(a).style.background=ALERT_COLOUR};MDART.restoreBtn=function(a){get(a).style.background=""};MDART.setTooltip=function(a,c,b){if(a.data("qtip")!=undefined){if(c!=""&&a.qtip("option","content.title")!=c){a.qtip("option","content.title",c)}if(a.qtip("option","content.text")!=b){a.qtip("option","content.text",b)}}else{a.qtip({content:{title:c,text:b},position:{my:"right center",at:"left center",target:a,viewport:$(".game-window")},show:{delay:0,solo:true},style:{classes:"qtip-jtools"}})}};MDART.createButton=function(f,e,b,d,c){var a=document.createElement("button");a.id=e;a.innerHTML=d;a.className=b;if(c!=null){a.setAttribute("onclick",c)}get(f).appendChild(a)};DEBUG={};DEBUG.debugMode=function(){MD.GOLD=n("1X");MD.TOTAL_GOLD=n("1X");MD.MANUAL_CLICKS=n("1T");MD.GOBLIN_TIME=2;MD.GOBLIN_TIME_VARIATION=1;MD.GOBLINS_KILLED=n("1T");MD.GEMS[0]=n("1T");MD.TOTAL_GEMS=n("1Z");MD.MAGE_MAX_TIME=1800;MD.MANA=n("1X");MD.TOTAL_MANA=n("1Z");for(var a=0;a<MD.HIRELINGS_OWNED.length;a++){MD.HIRELINGS_OWNED[a]=200}MD.HIRELINGS_OWNED[0]=n("25M");MD.MAGE_MAX_TIME=1800};DEBUG.superHighSpeed=function(){MD.DEBUG_CLOCK=setInterval(function(){MD.tick()},20)};DEBUG.clearIndustry=function(){for(var a=0;a<MD.CONSTRUCT_LOCATIONS.length;a++){MD.CONSTRUCT_LOCATIONS[a]=null;MD.CONSTRUCTION_STATUS[a]=null;MD.CONSTRUCT_LEVELS[a]=0}MDART.initializeIndustryCanvas();MDART.updateIndustryCanvas()};DEBUG.clearGems=function(){for(var a=0;a<MD.GEMS.length;a++){MD.GEMS[a]=0}};DEBUG.maxAura=function(){for(var a=0;a<MD.MAGE_AURA_LEVEL.length;a++){MD.MAGE_AURA_LEVEL[a]=10}};DEBUG.crazyResources=function(){for(r in MD.RESOURCES){MD.RESOURCES[r].change_function(n("1Q"))}};DEBUG.pause=function(){clearInterval(MD.GAME_CLOCK)};DEBUG.resume=function(){MD.GAME_CLOCK=setInterval(function(){MD.tick()},1000)};$(document).ready(function(){MDART.prepareTabs()});MD.start=function(){get("versionheader").innerHTML="Version "+MD.VERSION;MD.bindEvents();MDART.initializeCanvas();MDART.initializeIndustryCanvas();MDART.preloadSprites();MDART.setTooltips();MDART.prepareMenuIcons();MD.hideAllScreens();MD.initializeUpgradeLookup();MD.createResourceObjects();MD.setVariablesToDefault();MD.setBuyPickMessage(1);MD.setBuildWallMessage(1);MD.loadLocalStorage();MD.prepareDropdowns();MD.setupDialogs();MD.prepareUI();MD.startMarketTimer();MD.updateSteelDisplay();MD.updateFoodDisplay();MD.updateAdamantiumDisplay();MD.updateFlaxDisplay();MD.updatePopulationDisplay();MD.initializeConstructUnlocked();MD.initializeMarketButtons();MD.setDragonLevelMessage();MD.setHirelingButtons();MD.setMasonButton();MD.updateCrafting();MD.updateSocketDropDowns();MD.setMageButton();MD.updateMageButtons();MD.updateAlchPage();MD.updateUpgradeButtons();MD.updateUpgradeStats();MD.updateMageUpgradeButtons();MD.updateGems();MD.updateCoalDisplay();MDART.update();MD.GAME_CLOCK=setInterval(function(){MD.tick()},1000);MD.FAST_CLOCK=setInterval(function(){MD.fast_tick()},100);MD.MAX_GOBLIN_TIME=MD.GOBLIN_TIMER;MD.MAX_SPIDER_TIME=MD.SPIDER_TIMER;MDART.startAnimation(MD.SPRITE_N,1000);MD.showCanvas();MD.INITIALIZING_GAME=false};MD.start();